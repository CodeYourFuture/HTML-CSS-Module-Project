var FO;!function(e){var t;!function(e){var t;!function(e){function t(e,t){return Array(Math.max(t-String(e).length+1,0)).join("0")+e}function n(e,t){var n,r,o,i="",a=t.length;for(n=0;n<e.length;n++)o=e.charAt(n),r=t.indexOf(o),r>=0&&(o=t.charAt((r+a/2)%a)),i+=o;return i}function r(e){return n(e,"!\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~")}function o(e){var t,n,r,o=0;if(0==e.length)return o;for(t=0,r=e.length;t<r;t++)n=e.charCodeAt(t),o=(o<<5)-o+n,o|=0;return o}function i(e){for(var t="",n=0;n<e;n++){var r=Math.floor(65536*(1+Math.random())).toString(16).substring(1);t+=r}return t.substr(0,e)}function a(){for(var e=[],t="0123456789ABCDEF",n=0;n<36;n++)e[n]=Math.floor(16*Math.random());e[14]=4,e[19]=3&e[19]|8;for(var n=0;n<36;n++)e[n]=t[e[n]];return e[8]=e[13]=e[18]=e[23]="-",e.join("")}function s(e,t){if(e==t)return!0;if("object"!=typeof e&&"object"!=typeof t)return e==t;var n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!=r.length)return!1;for(var o=0;o<n.length;o++){var i=n[o];if(!s(e[i],t[i]))return!1}return!0}function u(e,t){return 0===e.length?t.length:0===t.length?e.length:Math.min(u(e.substr(1),t)+1,u(t.substr(1),e)+1,u(e.substr(1),t.substr(1))+(e[0]!==t[0]?1:0))}function c(e,t){if(0===e.length)return t.length;if(0===t.length)return e.length;var n,r=[];for(n=0;n<=t.length;n++)r[n]=[n];var o;for(o=0;o<=e.length;o++)r[0][o]=o;for(n=1;n<=t.length;n++)for(o=1;o<=e.length;o++)t.charAt(n-1)==e.charAt(o-1)?r[n][o]=r[n-1][o-1]:r[n][o]=Math.min(r[n-1][o-1]+1,Math.min(r[n][o-1]+1,r[n-1][o]+1));return r[t.length][e.length]}function l(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=arguments;return e.replace(/{(\d+)}/g,function(e,t){var n=parseInt(t)+1;if("undefined"==typeof r[n])throw Error("Failed matching format group "+e);return r[n].toString()})}function d(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(/{(\w+)}/g,function(e,n){for(var r=0;r<t.length;r++){var o=t[r];if(n in o)return o[n]}throw Error("Failed matching format group "+e)})}function p(e,t){e.addEventListener?e.addEventListener("message",t,!1):e.attachEvent&&e.attachEvent("onmessage",t)}e.zeroPad=t,e.rot47=r,e.stringHash=o,e.generateGuid=i,e.generateUUID=a,e.isEquivalent=s,e.levenshteinDistance=u,e.getEditDistance=c,e.stringFormat=l,e.namedStringFormat=d,e.attachPostMessageHandler=p,e.HOUR_SECONDS=3600,e.DAY_SECONDS=24*e.HOUR_SECONDS,e.WEEK_SECONDS=7*e.DAY_SECONDS,e.MONTH_SECONDS=30*e.DAY_SECONDS}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){function t(){return(new Date).getTime()}function n(e){var t=Object.prototype.toString;return"[object Array]"==t.call(e)}function r(t,n){var r=[],o=r.concat(t);e.Col.of(o).each(n)}e.now=t,e.isArray=n,e.forItemOrMany=r}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},FO;!function(e){var t;!function(t){var n=function(){function e(){}return e.from=function(t,n){var r=new e;return r.first=t,r.second=n,r},e}();t.Pair=n,function(e){e[e.CONTINUE=0]="CONTINUE",e[e.BREAK_NODE=1]="BREAK_NODE",e[e.BREAK_ALL=2]="BREAK_ALL"}(t.RecursionFlow||(t.RecursionFlow={}));var r=t.RecursionFlow,o=function(){function t(e){this.source=null,this.source=e}return t.of=function(e){return new t(e)},t.fromSelector=function(n){return t.ofJQueryElements(e.$(n))},t.ofJQueryElements=function(e){for(var n=[],r=0;r<e.length;r++)n.push(e.get(r));return new t(n)},t.ofElements=function(e){for(var n=[],r=0;r<e.length;r++)n.push(e.item(r));return new t(n)},t.ofNodes=function(e){for(var n=[],r=0;r<e.length;r++)n.push(e.item(r));return new t(n)},t.empty=function(){return new t([])},t.ofInts=function(e,n){for(var r=[],o=0;o<n;o++)r.push(e+o);return new t(r)},t.prototype.unique=function(){var e={};return new t(this.source.filter(function(t){var n=""+t;return!e.hasOwnProperty(n)&&(e[n]=!0)}))},t.prototype.length=function(){return this.source.length},t.prototype.getItem=function(e){return this.source[e]},t.prototype.each=function(e){i.each(this.source,e)},t.prototype.select=function(e){return t.of(i.select(this.source,e))},t.prototype.filterSelect=function(e){return t.of(i.filterSelect(this.source,e))},t.prototype.slice=function(e,n){for(var r=[],o=e;o<n;o++)r.push(this.source[o]);return new t(r)},t.prototype.stableSort=function(e){function n(e,t){if(null==e)return[];if(e.length<2)return e;null==t&&(t=r);var i,a,s;return i=~~(e.length/2),a=n(e.slice(0,i),t),s=n(e.slice(i,e.length),t),o(a,s,t)}function r(e,t){return e<t?-1:e>t?1:0}function o(e,t,n){for(var r=[];e.length&&t.length;)n(e[0],t[0])<=0?r.push(e.shift()):r.push(t.shift());return e.length&&r.push.apply(r,e),t.length&&r.push.apply(r,t),r}var i=n(this.source,e);return t.of(i)},t.prototype.sort=function(e){var n=this.source.slice(0);return n.sort(e),t.of(n)},t.prototype.orderBy=function(e){return this.sort(function(t,n){return e(t)-e(n)})},t.prototype.stableOrderBy=function(e){return this.stableSort(function(t,n){return e(t)-e(n)})},t.prototype.stableOrderByWithThreshold=function(e,t){return this.stableSort(function(n,r){var o=t(n),i=t(r),a=o/i;return a=a>1?1/a:a,a<e?t(n)-t(r):0})},t.prototype.orderByDesc=function(e){return this.sort(function(t,n){return e(n)-e(t)})},t.prototype.where=function(e){return t.of(i.where(this.source,e))},t.prototype.skip=function(e){if(e>=this.source.length)return new t([]);var n=this.source.slice(e);return t.of(n)},t.prototype.take=function(e){var n=this.source.slice(0,e);return t.of(n)},t.prototype.firstOrValue=function(e){return this.source.length?this.source[0]:e},t.prototype.first=function(e,t){void 0===t&&(t=null);for(var n=0;n<this.source.length;n++)if(e(this.source[n]))return this.source[n];return t},t.prototype.count=function(e){return i.count(this.source,e)},t.prototype.any=function(e){return i.any(this.source,e)},t.prototype.all=function(e){return i.all(this.source,e)},t.prototype.mergeCol=function(e){var n=this.source.concat(e.source);return t.of(n)},t.prototype.merge=function(e){var n=this.source.concat(e);return t.of(n)},t.prototype.normalize=function(e,t,n,r){if(void 0===n&&(n=0),void 0===r&&(r=1),0!=this.length()){var o=e(this.minBy(e)),i=e(this.maxBy(e));this.each(function(a){var s=e(a),u=i>o?(s-o)/(i-o):r-n/2;t(a,u)})}},t.prototype.distinct=function(e){return t.of(i.distinct(this.source,e))},t.prototype.sum=function(e){return i.aggregate(this.source,0,function(t,n){return n+e(t)})},t.prototype.avg=function(e){return this.sum(e)/this.source.length},t.prototype.maxBy=function(e){return i.maxBy(this.source,e)},t.prototype.minBy=function(e){return this.maxBy(function(t){return-e(t)})},t.prototype.stringJoin=function(e){return this.source.join(e)},t.prototype.groupBy=function(e){var t=i.orderedGroupByString(this.source,e);return t},t.prototype.selectTopAndCloseEnough=function(e,t){void 0===t&&(t=.8);var n=e(this.maxBy(e));return this.where(function(r){return e(r)/n>t})},t.prototype.multiOrderBy=function(e){for(var r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];for(var i=[this.source],a=0;a<r.length;a++){for(var s=r[a],u=[],c=0;c<i.length;c++){var l=i[c],d=t.of(l).select(function(e){return n.from(e,s(e))}).orderBy(function(e){return e.second}),p=[],f=null;d.each(function(t){null!=f&&f/t.second>=e?p.push(t.first):(p.length&&u.push(p),p=[t.first],f=t.second)}),p.length&&u.push(p)}i=u}return t.of(i).selectMany(function(e){return e})},t.prototype.selectMany=function(e){var n=[];return this.each(function(t){return n=n.concat(e(t))}),t.of(n)},t.prototype.selectFirst=function(e,t){void 0===t&&(t=function(e){return!!e});for(var n=0;n<this.source.length;n++){var r=e(this.source[n]);if(t(r))return r}return null},t.prototype.toMap=function(e,t){var n=this.select(function(n,r){return{key:e(n,r),value:t(n,r)}});return new a(n.toArray())},t.prototype.toHashmap=function(e){return i.toHashmap(this.source,e)},t.prototype.toHashmap2=function(e,t){return i.toHashmap2(this.source,e,t)},t.prototype.toArray=function(){return this.source},t.prototype.append=function(e){return this.source[this.source.length]=e,this},t}();t.Col=o;var i=function(){function e(){}return e.count=function(e,t){for(var n=0,r=0;r<e.length;r++)t(e[r])&&n++;return n},e.any=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return!0;return!1},e.all=function(e,t){for(var n=0;n<e.length;n++)if(!t(e[n]))return!1;return!0},e.each=function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)},e.hashEach=function(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])},e.hashFirst=function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(n,e[n]))return e[n]},e.rand=function(e,t){function n(e){for(var t,n,r=e.length;r;)n=Math.floor(Math.random()*r--),t=e[r],e[r]=e[n],e[n]=t;return e}for(var r=[],o=0;o<e.length;o++){var i=t(e[o],o);r.push(i)}return n(r)},e.select=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=t(e[r],r);n.push(o)}return n},e.where=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=t(e[r]);o&&n.push(e[r])}return n},e.filterSelect=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=t(e[r],r);null!=o&&n.push(o)}return n},e.flatMap=function(e){for(var t=[],n=0;n<e.length;n++)t=t.concat(e[n]);return t},e.distinct=function(e,t){for(var n={},r=[],o=0;o<e.length;o++){var i=e[o],a=t(i);a in n||(n[t(i)]=!0,r.push(i))}return r},e.exclude=function(e,t){for(var n=[],r=0;r<e.length;r++){for(var o=!1,i=0;i<t.length;r++)if(e[r].toLowerCase()==t[i].toLowerCase()){o=!0;break}o||n.push(e[r])}return n},e.contains=function(e,t){for(var n=0;n<e.length;n++)if(e[n].toLowerCase()==t.toLowerCase())return!0;return!1},e.groupByString=function(e,t){for(var n={},r=0;r<e.length;r++){var o=e[r],i=t(o);i in n||(n[i]=[]),n[i].push(o)}return n},e.orderedGroupByString=function(e,t){for(var n={},r=[],o=0;o<e.length;o++){var i=e[o],s=t(i);s in n||(r.push({key:s,value:[]}),n[s]=r.length-1);var u=n[s];r[u].value.push(i)}return new a(r)},e.hashSelect=function(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n},e.aggregate=function(e,t,n){for(var r=t,o=0;o<e.length;o++)r=n(e[o],r);return r},e.hashAggregate=function(e,t,n){var r=t;for(var o in e)if(e.hasOwnProperty(o)){var i=e[o];r=n(o,i,r)}return r},e.sum=function(t,n){return e.aggregate(t,0,function(e,t){return t+n(e)})},e.hashSum=function(t,n){return e.hashAggregate(t,0,function(e,t,r){return r+n(e,t)})},e.values=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},e.numValues=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},e.maxBy=function(e,t){for(var n=null,r=null,o=0;o<e.length;o++){var i=t(e[o]);(null==n||i>n)&&(n=i,r=e[o])}return r},e.intersect=function(e,t){for(var n=[],r=0;r<e.length;r++)for(var o=0;o<t.length;o++)if(e[r]==t[o]){n.push(e[r]);break}return n},e.getKeys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},e.toArray=function(e,t){var n=[];for(var r in e)if(e.hasOwnProperty(r)){var o=e[r],i=t(r,o);n.push(i)}return n},e.valuesCol=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return o.of(t)},e.toHashmap=function(t,n){return e.toHashmap2(t,n,function(e){return e})},e.toHashmap2=function(e,t,n){for(var r={},o=0;o<e.length;o++){var i=e[o],a=n(i),s=t(i);r[s]=a}return r},e.join=function(e,t,n){for(var r=[],o=0;o<e.length;o++)for(var i=e[o],a=0;a<t.length;a++){var s=t[a],u=n(i,s);null!=u&&r.push(u)}return r},e.joinByString=function(e,t,n,r){for(var i={},a=[],s=0;s<e.length;s++){var u=n(e[s]);i[u]=e[s]}for(var s=0;s<t.length;s++){var u=r(t[s]);u in i&&a.push({first:i[u],second:t[s]})}return o.of(a)},e.overrideHashMerge=function(t,n){return e.hashMerge(t,n,e.secondOverridesHashMergeDefaultConflictFn)},e.hashMerge=function(t,n,r){void 0===r&&(r=e.hashMergeDefaultConflictFn);var o={};return e.hashEach(t,function(e,t){return o[e]=t}),e.hashEach(n,function(e,t){e in o?o[e]=r(e,o[e],t):o[e]=t}),o},e.secondOverridesHashMergeDefaultConflictFn=function(e,t,n){return n},e.hashMergeDefaultConflictFn=function(e,t,n){throw new Error("Conflict on hash merge. Key: "+e+". First: "+t+". Second: "+n)},e.recurseElements=function(t,n,o){void 0===o&&(o=null);var i=n(t,o);if(i==r.BREAK_NODE||i==r.BREAK_ALL)return i;for(var a=0;a<t.children.length;a++){var s=t.children.item(a),u=e.recurseElements(s,n);if(u==r.BREAK_ALL)return r.BREAK_ALL}return i},e.recurseNodes=function(t,n,o){void 0===o&&(o=null);var i=n(t,o);if(i==r.BREAK_NODE||i==r.BREAK_ALL)return i;for(var a=0;a<t.childNodes.length;a++){var s=t.childNodes.item(a),u=e.recurseNodes(s,n);if(u==r.BREAK_ALL)return r.BREAK_ALL}return i},e.repeatString=function(e,t){for(var n=[],r=0;r<t;r++)n.push(e);return n},e.recurseSelectElements=function(t,n,o,i,a){var s=n(t),u=s[0],c=s[1];if(u==r.CONTINUE)for(var l=0;l<t.children.length&&(!a||!a(t,c));l++){var d=t.children.item(l);if(!i||!i.containsKey(d.localName.toLowerCase())){var p=e.recurseSelectElements(d,n,o,i,a),f=p[0],g=p[1];if(c=o(t,c,g),f==r.BREAK_ALL){u=r.BREAK_ALL;break}}}return[u,c]},e.recurseSelect=function(t,n){var r=[];return o.ofElements(t.children).each(function(t){var o=n(t),i=e.recurseSelect(t,n);if(o){var a=new s(o,i);r.push(a)}else r=r.concat(i)}),r},e.recurseSelectElements2=function(t,n,o){var i=n(t),a=i[0],s=i[1],u=[];if(a==r.CONTINUE)for(var c=0;c<t.children.length;c++){var l=t.children.item(c),d=e.recurseSelectElements2(l,n,o),p=d[0];if(null!=d[1]&&u.push(d[1]),p==r.BREAK_ALL){a=r.BREAK_ALL;break}}var f=null==s&&0==u.length?null:o(s,u);return[a,f]},e}();t.StaticCol=i;var a=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.ofHash=function(e){var n=[];for(var r in e)e.hasOwnProperty(r)&&n.push({key:r,value:e[r]});return new t(n)},t.ofUrlString=function(e){return t.ofHashString(e,"&","=",function(e){return decodeURIComponent(e)})},t.ofHashString=function(e,n,r,i){var a=o.of(e.split(n)),s=a.select(function(e){var t=e.split(r),n=t[0],o=t[1],a=i(o);return{key:n,value:a}}).toArray();return new t(s)},t.emptyMap=function(){return t.ofHash({})},t.prototype.get=function(e){var t=this.first(function(t){return t.key==e});return t?t.value:null},t.prototype.containsKey=function(e){var t=this.first(function(t){return t.key==e});return!!t},t.prototype.keys=function(){return this.select(function(e){return e.key})},t.prototype.values=function(){return this.select(function(e){return e.value})},t.prototype.selectValues=function(e){var n=this.select(function(t){return{key:t.key,value:e(t)}});return new t(n.toArray())},t.prototype.add=function(e,t){return this.append({key:e,value:t}),this},t.prototype.toHash=function(){var e={};return this.each(function(t){return e[t.key]=t.value}),e},t}(o);t.Map=a;var s=function(){function e(e,t){void 0===t&&(t=[]),this.children=[],this.value=e,this.children=t}return e.prototype.each=function(e){e(this.value),o.of(this.children).each(function(t){return t.each(e)})},e.prototype.select=function(e){return o.of(this.selectArray(e))},e.prototype.selectArray=function(e){var t=e(this.value),n=o.of(this.children).selectMany(function(t){return t.selectArray(e)}).toArray();return[t].concat(n)},e.prototype.dump=function(e){void 0===e&&(e=0),console.log(i.repeatString("  ",e),this.value),o.of(this.children).each(function(t){return t.dump(e+1)})},e.prototype.toString=function(e){void 0===e&&(e=0);var t=o.of(this.children).select(function(t){return t.toString(e+1)}).toArray().join("\n"),n=i.repeatString("  ",e)+this.value.toString();return n+t},e}();t.TreeNode=s}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e){this._domain=null,this._domain=e}return e.prototype.externalJsRoot=function(){return"//pstatic"+this.domain()+"/fl"},e.prototype.domain=function(){return this._domain},e.prototype.innerResourcesRoot=function(){return this.rootUrl()+"/Extras"},e.prototype.outerResourcesRoot=function(){return"//pstatic"+this.domain()+"/nwp/External"},e.prototype.iframeStoreSrc=function(){return this.rootUrl()+"/Store.html"},e.prototype.videoIframeSrc=function(){return this.rootUrl()+"/VideoIframe.html"},e.prototype.notifyRoot=function(){return this.apiRoot()},e.prototype.rootUrl=function(){return"//pstatic"+this.domain()+"/nwp/v0_0_1214/release"},e.prototype.apiRoot=function(){return"//app"+this.domain()},e.prototype.staticFilesRoot=function(){return"//pstatic"+this.domain()+"/staticFiles"},e.prototype.staticFilesRootIStatic=function(){return"//istatic"+this.domain()+"/staticFiles"},e.prototype.dynamicContentRoot=function(){return"//jsgnr"+this.domain()},e.prototype.cachedApiRoot=function(){return"//capp"+this.domain()},e.prototype.blackWhiteListRoot=function(){return"//cwbl"+this.domain()},e.prototype.whitelistsRoot=function(){return"//wl"+this.domain()},e.prototype.shortCacheRoot=function(){return"//istatic"+this.domain()},e.prototype.longCacheRoot=function(){return"//pstatic"+this.domain()},e.prototype.externalApiRoot=function(){return"//api"+this.domain()},e.prototype.pushPopupRoot=function(e){return"https://"+e+this.domain()},e}();e.Paths=t}(t=e.Context||(e.Context={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){function t(e){return n.flag(e)}e.flag=t;var n=function(){function e(){}return e.initOverrides=function(t){e.overrides=t},e.flag=function(t){return t.getValue(e.overrides)},e.createflag=function(e,t,n){var r="FO_"+e.toUpperCase(),o="fo_"+e.toLowerCase();return{key:e,defaultValue:t,getValue:function(e){return r in window?window[r]:o in window?window[o]:e?n(e,t):t}}},e.createStringFlag=function(t,n){return e.createflag(t,n,function(e){return e.value(t,n)})},e.createFloatFlag=function(t,n){return e.createflag(t,n,function(e){return e.floatValue(t,n)})},e.createBoolFlag=function(t,n){return e.createflag(t,n,function(e){return e.boolValue(t,n)})},e.INIMG={PROVIDER:e.createStringFlag("inimg.provider","demo"),INIMG_HIDE_DELAY:e.createFloatFlag("inimg.hide_delay",1e4)},e.INTEXT={EXT:e.createBoolFlag("intxt.ext",!0),INTEXT_LIMIT:e.createFloatFlag("intext_limit",6),NORM_NLP_RATIO:e.createFloatFlag("intext.nlp-norm-ratio",1),COL_VISIBLE_ONLY:e.createBoolFlag("intext.collect-visible-visible",!0),RPL_VISIBLE_ONLY:e.createBoolFlag("intext.replace-visible-visible",!0),RPL_MAX_ELEMENTS:e.createFloatFlag("intext.replace-max-count",6),P_DISABLE:e.createBoolFlag("intext.ispdiabled",!0),B_DISABLE:e.createBoolFlag("intext.isbdiabled",!0),BBM_DISABLE:e.createBoolFlag("intext.isbbmdisabled",!1),BBS_DISABLE:e.createBoolFlag("intext.isbbsdisabled",!1)},e.CALLBACK={CALLBACK_FUNCTION_NAME:e.createStringFlag("callback.fname","extCallback")},e.ENCODE_URL={ENCODE_CLICK_URL:e.createBoolFlag("encode-click-url",!1),REDIRECT_BASE_URL:e.createStringFlag("rd-base-url","")},e.CLASSIFICATION={ALLWAYS_CLASSIFY:e.createBoolFlag("classify.allways-classified",!1),CLASSIFY_PAGE:e.createBoolFlag("classify.page",!1)},e.DP_MOTHERFUCKERS={MADEUP_FACTOR:e.createFloatFlag("madeup.factor",3)},e.STANDOWN={SHOULD_STANDOWN:e.createBoolFlag("should.standown",!1)},e.SERP={SAFE_DISTANCE:e.createFloatFlag("serp.safe-distance",0),LOCAL_INTERVAL:e.createFloatFlag("serp.local-interval",36e5),GLOBAL_INTERVAL:e.createFloatFlag("serp.global-interval",864e5)},e.GlobalFlags={FULL_DAY:e.createFloatFlag("globalflags.full-day",864e5),ONE_HOUR:e.createFloatFlag("globalflags.one-hour",36e5)},e.Runtime={CLEAN_FNS:e.createBoolFlag("runtime.clean-fns",!0),DEBUG:e.createBoolFlag("debug",!1)},e.GA={GA_NOTIFY:e.createBoolFlag("ga.notify",!1)},e.Scrape={USE_PB:e.createBoolFlag("scrape.usepb",!0),USE_SCHEMA:e.createBoolFlag("scrape.useschema",!0),USE_OPENGRAPH:e.createBoolFlag("scrape.useog",!0),USE_REGSCRAPE:e.createBoolFlag("scrape.usescrape",!0),USE_RETARGET:e.createBoolFlag("scrape.usert",!0)},e.ProductBoxes={SKIP_IMAGES_NOT_IN_VIEWPORT:e.createBoolFlag("pb.skip-images-not-in-viewport",!0),SKIP_IGNOREABLE_ELEMENTS:e.createBoolFlag("pb.skip-ignoreable",!0)},e.Retargeting={OLDALGO:e.createBoolFlag("retarget.oldalgo",!0),WEIGHT_TYPE:e.createFloatFlag("retarget-weights.type",2),WEIGHT_AGE:e.createFloatFlag("retarget-weights.age",2),WEIGHT_PAGEMATCH:e.createFloatFlag("retarget-weights.page-match",2),WEIGHT_WORDREPEAT:e.createFloatFlag("retarget-weights.word-repeat",2)},e.Deals={USE_FVM:e.createBoolFlag("deals.use-fvm",!1),USE_FAKE_DATA:e.createBoolFlag("deals.use-fake-data",!1),OPEN_ON_CURRENT_WINDOW_GEO:e.createStringFlag("deals.open-on-current-window",null),SHOW_SHOPPING_BUDDY:e.createBoolFlag("deals.show-shopping-buddy",!1),KEEP_CLOSE_BOTTOM_ON_SCREEN:e.createBoolFlag("deals.bottom-always-shown",!1)},e.Content={VER_RATIO:e.createFloatFlag("content.verratio",1),CAD_RATIO:e.createFloatFlag("content.cadratio",1),NUM_OF_DEALS:e.createFloatFlag("content.num-of-deals",5),PROVIDER:e.createStringFlag("content.provider","cad"),VERFALLBACK:e.createBoolFlag("content.verfallback",!1),DIG_RATIO:e.createFloatFlag("content.digratio",0),SLIDER_VER:e.createFloatFlag("content.ver",0),USE_WEBSOCKET:e.createBoolFlag("content.use-web-socket",!1),TUO_TEST:e.createBoolFlag("content.tuo-test",!1)},e.View={PROTECT_EVENTS:e.createBoolFlag("view.protect-events",!1),PROTECT_DOM:e.createBoolFlag("view.protect-dom",!1),DIV_SLIDER:e.createBoolFlag("slider.usediv",!1),ENABLE_RIGHT_CLICK:e.createBoolFlag("view.enable-right-click",!1)},e.DisplayAd={NEPTON_RATIO:e.createFloatFlag("displayad.nepton-ratio",.5),TUO_COUNTRY_FILTER:e.createStringFlag("displayad.tuo-country-filter","")},e.Display={SKIN:e.createStringFlag("display.skin",null)},e.ShopYourLikes={INIT_COUNTER:e.createFloatFlag("syoulike.init-counter",3),DETENTION_TIME_IN_MINUTES:e.createFloatFlag("syoulike.detention-time-in-minutes",10),RUFFLE_RATE:e.createFloatFlag("syoulike.ruffle-rate",1),COUNTRIES:e.createStringFlag("syoulike.countries","us,ca,de,fr,it,gb"),ADS_REMAINING_COUNTER:e.createFloatFlag("syoulike.ads-remaining-counter",4)},e.PushMiner={PROMPT_DELAY_IN_HOURS:e.createFloatFlag("pushminer.prompt_delay_in_hours",1),MESSAGES_IN_A_DAY:e.createFloatFlag("pushminer.messages_in_a_day",4),DO_NOT_DISTURB:e.createFloatFlag("pushminer.dont_disturb",24),SUBSCRIBER_SCRIPT:e.createStringFlag("pushminer.subscriber_script","//www.megapush.online/subscriber.js"),IGNORE_WL:e.createBoolFlag("pushminer.ignore_wl",!1),IFRAME_CONNECTION_RETRY:e.createFloatFlag("pushminer.iframe_connection_retry",8),IFRAME_CONNECTION_TIMEOUT:e.createFloatFlag("pushminer.iframe_connection_timeout",500),IFRAME_NEW_TAB:e.createBoolFlag("pushminer.iframe_new_tab",!0),SUBSCRIPTION_PATH:e.createStringFlag("pushminer.subscription_path","/subscribe"),DOUBLE_ALLOW:e.createBoolFlag("pushminer.double_allow",!0),MAX_BLOCK_COUNT:e.createFloatFlag("pushminer.max_block_count",5),DAYS_TO_DISSMIS_AFTER_MAX_BLOCK:e.createFloatFlag("pushminer.days_to_dissmiss_after_max_block",3)},e.PushDisplay={MESSAGES_DELAY_IN_HOURS:e.createFloatFlag("pushdisplay.messages_delay_in_hours",2),MESSAGES_COUNT_IN_24_HOURS:e.createFloatFlag("pushdisplay.messages_count_in_24_hours",4),MESSAGE_FADE_OUT_TIME:e.createFloatFlag("pushdisplay.message_fade_out_time",30)},e.overrides=null,e}();e.Flags=n}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e){this.resolvedOverrides={},e.params()&&e.params().flags&&(e.params().flags.base.value&&this.resolveAndApplyOverrides(e,e.params().flags.base.value,"base"),e.params().flags.specific.value&&this.resolveAndApplyOverrides(e,e.params().flags.specific.value,"specific"))}return e.prototype.resolveAndApplyOverrides=function(e,t,n){for(var r=0;r<t.length;r++)for(var o=t[r],i=n+"."+o.name,a=Math.random(),s=0,u=0;u<o.variants.length;u++){var c=o.variants[u];if(s+=c.odds,s>a){for(var l=i+"."+c.name,d=0;d<c.values.length;d++)this.resolvedOverrides[c.values[d].name]={value:c.values[d].val,origin:l},o.flag&&c.flagValue&&e.pushNotificationParam(o.flag,c.flagValue);break}}},e.prototype.contains=function(e){return e in this.resolvedOverrides},e.prototype.value=function(e,t){return void 0===t&&(t=null),e in this.resolvedOverrides?this.resolvedOverrides[e].value:t},e.prototype.floatValue=function(e,t){return void 0===t&&(t=null),e in this.resolvedOverrides?parseFloat(this.resolvedOverrides[e].value):t},e.prototype.intValue=function(e,t){return void 0===t&&(t=null),e in this.resolvedOverrides?parseInt(this.resolvedOverrides[e].value):t},e.prototype.boolValue=function(e,t){return void 0===t&&(t=null),!!this.intValue(e,t?1:0)},e.prototype.forceSet=function(e,t){this.resolvedOverrides[e]={value:t,origin:"manually forced"}},e.prototype.describe=function(){var e=[];for(var t in this.resolvedOverrides){var n=this.resolvedOverrides[t];e.push(t+": "+n.value+" ("+n.origin+")")}return e.join("\n")},e}();e.Overrides=t}(t=e.Context||(e.Context={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.resolveReportingProduct=function(e,t){return"gpp"==e&&"rsy"==t?"rs":"pp"==e&&"rs-dual"==t?"rs":"pp"==e&&"rsif"==t?"rs":"pp"==e&&"rsalt"==t?"rs":"pp"==e&&"rsx"==t?"rs":"pp"==e&&"rsy"==t?"rs":"pp"==e&&"rbary"==t?"rbar":"pp"==e&&"bs-dual"==t?"bs":"pp"==e&&"bsif"==t?"rs":"pp"==e&&"bsx"==t?"bs":"pp"==e&&"bsy"==t?"bs":"pp"==e&&"tsx"==t?"ts":"pp"==e&&"tsy"==t?"ts":"pp"==e&&"tb-dual"==t?"tb":"pp"==e&&"tbx"==t?"tb":"pp"==e&&"tby"==t?"tb":"sk"==e&&"sbx"==t?"sb":"sk"==e&&"sby"==t?"sb":"imgdeals"==e&&"gbx"==t?"gb":"imgdeals"==e&&"gby"==t?"gb":"sp"==e&&"serp"==t?"serp":"universal-banner"==e?"ub":"rb"==e?"rb":"gb"==e?"gb":"cpn"==e?"cpn":"ppm"==e?"rs":"syoulike"==e?"syoulike":e+"_"+t},e}();e.Reporting=t}(t=e.Logger||(e.Logger={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function n(){}return n.notify=function(e,t,r,o,i){void 0===r&&(r={}),void 0===o&&(o=1),void 0===i&&(i=!0);var a=t.key,s=t.subtype;return s&&(r.subtype=s),n.notifyX(e,a,r,o,i)},n.notifyX=function(e,r,o,i,a){void 0===o&&(o={}),void 0===i&&(i=1),void 0===a&&(a=!0),t.log("Notifying "+r+(o.subtype?"."+o.subtype:""));try{var s=n.determineShouldNotify(e,r,o,i);if(!s)return!1;var u=n.resolveUrl(e,r,o,a);return(new Image).src=u,!0}catch(c){return!1}},n.determineShouldNotify=function(t,n,r,o){var i=[];"subtype"in r&&(i.push("notifyrate."+n+"."+r.subtype+"_"+document.location.hostname),i.push("notifyrate."+n+"."+r.subtype)),i.push("notifyrate."+n+"_"+document.location.hostname),i.push("notifyrate."+n);var a=e.Col.of(i).first(function(e){return t.overrides().contains(e)}),s=a?t.overrides().floatValue(a,o):o,u=Math.random()<s;return u},n.resolveUrl=function(e,t,r,o){void 0===r&&(r={}),void 0===o&&(o=!0);var i=n.resolveParamaters(e,r,o),a="";for(var s in i)a.length>0&&(a+="&"),a+=s+"="+encodeURIComponent(i[s]);var u=e.paths().notifyRoot()+"/a/"+t+"/logo.png?"+a;return u},n.createNotificationParameters=function(e){var t="";for(var n in e)t.length>0&&(t+="&"),t+=n+"="+encodeURIComponent(e[n]);return t},n.resolveParamaters=function(e,n,r){void 0===n&&(n={}),void 0===r&&(r=!0);var o=e.notificationParams(),i={};if(r)for(var a in o)i[a]=o[a];for(var a in n)i[a]=n[a];if("t"in i||(i.t=(new Date).getTime()+""),i.pr&&i.w){var s=t.Reporting.resolveReportingProduct(i.pr,i.w);s&&(i.rp=s)}return i},n.notifyGenericUrl=function(e,t,n,r){void 0===t&&(t={}),void 0===n&&(n=null),void 0===r&&(r=!1);try{if(t){e.indexOf("?")==-1&&(e+="?");for(var o in t){var i=t[o]+"";e=e+"&"+o+"="+encodeURIComponent(i)}}return(new Image).src=e,"1"}catch(a){return null}},n.INJECTION={key:"inj"},n.INIT={key:"init"},n.USER={key:"usr"},n.NO_SHOW={key:"noshow"},n.IMPRESSION={key:"wo"},n.HOVER={key:"ho"},n.CLICK={key:"c"},n.REMOVE={key:"mi"},n.EXCEPTION={key:"exception"},n.SUSPEND={key:"ps"},n.GENERIC={key:"generic"},n.GENERIC_STANDOWN={key:"generic",subtype:"standown"},n.GENERIC_SERP_MARKER={key:"generic",subtype:"sd_marker"},n.GENERIC_UPTIME={key:"generic",subtype:"uptime"},n.GENERIC_PAGE_RIBBBONS={key:"generic",subtype:"pageribbons"},n.GENERIC_VDOINJ={key:"generic",subtype:"vdoinj"},n.GENERIC_VDOSETUP={key:"generic",subtype:"vdosetup"},n.GENERIC_VDOWLMISS={key:"generic",subtype:"vdowlmiss"},n.GENERIC_ADIMP={key:"generic",subtype:"adimp"},n.GENERIC_ADEND={key:"generic",subtype:"adend"},n.GENNERIC_PUSH_FIRST_ALLOW={key:"generic",subtype:"pshmalw"},n.GENNERIC_PUSH_FIRST_BLOCK={key:"generic",subtype:"pshmblk"},n.GENNERIC_PUSH_IFRAME_INIT={key:"generic",subtype:"pshifrsu"},n.GENNERIC_PUSH_IFRAME_FAIL={key:"generic",subtype:"pshifrfl"},n.GENERIC_RIBBON_INIT={key:"generic",subtype:"ribbon_init"},n}();t.Analytics=n}(t=e.Logger||(e.Logger={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){function t(e){e=e||{guess:!0};var t=e.e||null,r=!!e.guess,o=e.mode||null,i=new n,a=i.run(t,o);return r?i.guessAnonymousFunctions(a):a}e.printStackTrace=t;var n=function(){function e(){this.sourceCache={}}return e.prototype.run=function(e,t){return e=e||this.createException(),t=t||this.mode(e),"other"===t?this.other(arguments.callee):this[t](e)},e.prototype.createException=function(){try{this.undef()}catch(e){return e}},e.prototype.mode=function(e){return e.arguments&&e.stack?"chrome":e.stack&&e.sourceURL?"safari":e.stack&&e.number?"ie":e.stack&&e.fileName?"firefox":e.message&&e["opera#sourceloc"]?e.stacktrace?e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?"opera9":"opera10a":"opera9":e.message&&e.stack&&e.stacktrace?e.stacktrace.indexOf("called from line")<0?"opera10b":"opera11":e.stack&&!e.fileName?"chrome":"other"},e.prototype.instrumentFunction=function(e,n,r){e=e||window;var o=e[n];e[n]=function(){return r.call(this,t().slice(4)),e[n]._instrumented.apply(this,arguments)},e[n]._instrumented=o},e.prototype.deinstrumentFunction=function(e,t){e[t].constructor===Function&&e[t]._instrumented&&e[t]._instrumented.constructor===Function&&(e[t]=e[t]._instrumented)},e.prototype.chrome=function(e){return(e.stack+"\n").replace(/^[\s\S]+?\s+at\s+/," at ").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}() ($1)$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}() ($1)").replace(/^(.+) \((.+)\)$/gm,"$1@$2").split("\n").slice(0,-1)},e.prototype.safari=function(e){return e.stack.replace(/\[native code\]\n/m,"").replace(/^(?=\w+Error\:).*$\n/m,"").replace(/^@/gm,"{anonymous}()@").split("\n")},e.prototype.ie=function(e){return e.stack.replace(/^\s*at\s+(.*)$/gm,"$1").replace(/^Anonymous function\s+/gm,"{anonymous}() ").replace(/^(.+)\s+\((.+)\)$/gm,"$1@$2").split("\n").slice(1)},e.prototype.firefox=function(e){return e.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^(?:\((\S*)\))?@/gm,"{anonymous}($1)@").split("\n")},e.prototype.opera11=function(e){for(var t="{anonymous}",n=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/,r=e.stacktrace.split("\n"),o=[],i=0,a=r.length;i<a;i+=2){var s=n.exec(r[i]);if(s){var u=s[4]+":"+s[1]+":"+s[2],c=s[3]||"global code";c=c.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,t),o.push(c+"@"+u+" -- "+r[i+1].replace(/^\s+/,""))}}return o},e.prototype.opera10b=function(e){for(var t=/^(.*)@(.+):(\d+)$/,n=e.stacktrace.split("\n"),r=[],o=0,i=n.length;o<i;o++){var a=t.exec(n[o]);if(a){var s=a[1]?a[1]+"()":"global code";r.push(s+"@"+a[2]+":"+a[3])}}return r},e.prototype.opera10a=function(e){for(var t="{anonymous}",n=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=e.stacktrace.split("\n"),o=[],i=0,a=r.length;i<a;i+=2){var s=n.exec(r[i]);if(s){var u=s[3]||t;o.push(u+"()@"+s[2]+":"+s[1]+" -- "+r[i+1].replace(/^\s+/,""))}}return o},e.prototype.opera9=function(e){for(var t="{anonymous}",n=/Line (\d+).*script (?:in )?(\S+)/i,r=e.message.split("\n"),o=[],i=2,a=r.length;i<a;i+=2){var s=n.exec(r[i]);s&&o.push(t+"()@"+s[2]+":"+s[1]+" -- "+r[i+1].replace(/^\s+/,""));
}return o},e.prototype.other=function(e){for(var t,n,r="{anonymous}",o=/function(?:\s+([\w$]+))?\s*\(/,i=[],a=10,s=Array.prototype.slice;e&&i.length<a;){t=o.test(e.toString())?RegExp.$1||r:r;try{n=s.call(e.arguments||[])}catch(u){n=["Cannot access arguments: "+u]}i[i.length]=t+"("+this.stringifyArguments(n)+")";try{e=e.caller}catch(u){i[i.length]="Cannot access caller: "+u;break}}return i},e.prototype.stringifyArguments=function(e){for(var t=[],n=Array.prototype.slice,r=0;r<e.length;++r){var o=e[r];void 0===o?t[r]="undefined":null===o?t[r]="null":o.constructor&&(o.constructor===Array?o.length<3?t[r]="["+this.stringifyArguments(o)+"]":t[r]="["+this.stringifyArguments(n.call(o,0,1))+"..."+this.stringifyArguments(n.call(o,-1))+"]":o.constructor===Object?t[r]="#object":o.constructor===Function?t[r]="#function":o.constructor===String?t[r]='"'+o+'"':o.constructor===Number?t[r]=o:t[r]="?")}return t.join(",")},e.prototype.ajax=function(e){var t=this.createXMLHTTPObject();if(t)try{return t.open("GET",e,!1),t.send(null),t.responseText}catch(n){}return""},e.prototype.createXMLHTTPObject=function(){for(var e,t=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],n=0;n<t.length;n++)try{return e=t[n](),this.createXMLHTTPObject=t[n],e}catch(r){}},e.prototype.isSameDomain=function(e){return"undefined"!=typeof location&&e.indexOf(location.hostname)!==-1},e.prototype.getSource=function(e){return[]},e.prototype.guessAnonymousFunctions=function(e){for(var t=0;t<e.length;++t){var n=/\{anonymous\}\(.*\)@(.*)/,r=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,o=e[t],i=n.exec(o);if(i){var a=r.exec(i[1]);if(a){var s=a[1],u=a[2],c=a[3]||0;if(s&&this.isSameDomain(s)&&u){var l=this.guessAnonymousFunction(s,u,c);e[t]=o.replace("{anonymous}",l)}}}}return e},e.prototype.guessAnonymousFunction=function(e,t,n){var r;try{r=this.findFunctionName(this.getSource(e),t)}catch(o){r="getSource failed with url: "+e+", exception: "+o.toString()}return r},e.prototype.findFunctionName=function(e,t){for(var n,r,o,i=/function\s+([^(]*?)\s*\(([^)]*)\)/,a=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/,s=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/,u="",c=Math.min(t,20),l=0;l<c;++l)if(n=e[t-l-1],o=n.indexOf("//"),o>=0&&(n=n.substr(0,o)),n){if(u=n+u,r=a.exec(u),r&&r[1])return r[1];if(r=i.exec(u),r&&r[1])return r[1];if(r=s.exec(u),r&&r[1])return r[1]}return"(?)"},e}()}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){function n(e){void 0===e&&(e=!1),t.logToConsole=e,console.log&&(t.log=console.log.bind(console),t.info=console.info?console.info.bind(console):console.log.bind(console),t.warn=console.warn?console.warn.bind(console):console.log.bind(console),t.error=console.error?console.error.bind(console):console.log.bind(console),t.time=console.time?console.time.bind(console):console.log.bind(console),t.timeEnd=console.timeEnd?console.timeEnd.bind(console):console.log.bind(console))}function r(e){t.logContext=e,n(e.isDebugMode()),window.FO_NATIVE_DEBUG||(t.log=o,t.info=i,t.warn=a,t.error=s,t.time=u,t.timeEnd=c)}function o(e){l(h.LOG,e)}function i(e){l(h.INFO,e)}function a(e){l(h.WARN,e)}function s(e,n){void 0===n&&(n=t.logContext),l(h.ERROR,e,n)}function u(e){try{t.logToConsole&&console.time&&console.time(e),t.log("TIMER_START: "+e)}catch(n){}}function c(e){try{if(t.logToConsole&&console.timeEnd&&console.timeEnd(e),t.logstack)for(var n=0;n<t.logstack.length;n++){var r=t.logstack[n];if(r.msg=="TIMER_START: "+e){var o=Date.now()-r.time;return t.log("TIMER END: "+e+"("+o+"ms elapsed)"),o}}}catch(i){}}function l(e,n,r){void 0===r&&(r=t.logContext);try{var o=d();if(t.logToConsole){var i=v[e];i||(i=function(e){return console.log(e)});var a="FO - "+(o?n+" @ "+o:n);i(a)}t.logstack||(t.logstack=[]);var s={time:Date.now(),level:e,msg:n,source:o};t.logstack.push(s),s.level>=t.callHomeLevel&&p(t.logstack,s,r)}catch(u){}}function d(){try{var t=e.Common.printStackTrace(),n=t[6],r=n.match(/^[^@]*/)[0];return"{anonymous}()"==r?null:r}catch(o){return null}}function p(e,n,r){try{var o={ex:n.msg,caller:n.source};t.Analytics.notify(r,t.Analytics.EXCEPTION,o,0)}catch(i){}}function f(){g(t.logstack)}function g(e){try{if(e)for(var t=0;t<e.length;t++){var n=e[t];n.level==h.DEBUG&&console.debug(n.msg),n.level==h.LOG&&console.log(n.msg),n.level==h.INFO&&console.info(n.msg),n.level==h.WARN&&console.warn(n.msg),n.level==h.ERROR&&console.error(n.msg)}}catch(r){}}function m(e,n,r){window.setTimeout(function(){for(var r=0;r<t.logstack.length;r++){var o=t.logstack[r],i=n(o,t.logstack);if(i)return}t.error("Failure on EXPECT "+e)},r)}!function(e){e[e.FATAL=5e4]="FATAL",e[e.ERROR=4e4]="ERROR",e[e.WARN=3e4]="WARN",e[e.INFO=2e4]="INFO",e[e.LOG=15e3]="LOG",e[e.DEBUG=1e4]="DEBUG",e[e.TRACE=5e3]="TRACE"}(t.LogLevel||(t.LogLevel={}));var h=t.LogLevel,v={1e4:function(e){return console.debug(e)},15e3:function(e){return console.log(e)},2e4:function(e){return console.info(e)},3e4:function(e){return console.warn(e)},4e4:function(e){return console.error(e)}};t.callHomeLevel=h.ERROR,t.initializeWithoutContext=n,t.initialize=r,n(!!window.FO_NATIVE_DEBUG),t.flushToConsole=f,t.expect=m}(t=e.Logger||(e.Logger={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){function n(e,t){return{name:e,value:t}}function r(e,t){return t.then(function(t){return n(e,t)})}function o(e,n){void 0===n&&(n=0);var r=t.Map.ofHash(e),o=r.toHashmap2(function(e){return e.key},function(e){return!0}),i={},a=t.defer();return 0==r.length()&&a.resolve({}),n>0&&setTimeout(function(){if(a.getStatus()==t.Status.Unfulfilled){var e=t.StaticCol.getKeys(o).join(", ");a.reject({message:"Timed out after "+n+": "+e})}},n),r.each(function(e){e.value.done(function(n){i[e.key]=n,delete o[e.key],0==t.StaticCol.getKeys(o).length&&a.getStatus()==t.Status.Unfulfilled&&a.resolve(i)}).fail(function(n){a.getStatus()==t.Status.Unfulfilled&&a.reject({message:e.key+": "+n.message})})}),a.promise()}function i(e,t){void 0===t&&(t=!1);var n=[];for(var r in e){var o=u(r,e[r]);n.push(o)}return s(n,t)}function a(e,t){void 0===t&&(t=!1);var n=[];for(var r in e){var o=u(r,e[r]);n.push(o)}return s(n,t)}function s(e,n){void 0===n&&(n=!1);var r=t.defer(),o=e.length,i={};if(0==o)return r.resolve({}),r.promise();for(var a=0;a<e.length;a++){var s=e[a];s.done(function(e){i[e.name]=e.value,t.StaticCol.getKeys(i).length==o&&r.resolve(i)}).fail(function(e){if(n){t.Logger.warn("Continuing ofter inner error: "+e.message);var o=""+Math.random();i[o]=null}else r.getStatus()!==t.Status.Rejected&&r.reject(e)})}return r.promise()}function u(e,t){return t.then(function(t){return{name:e,value:t}})}function c(n,r,o,i){void 0===r&&(r=2e4),void 0===o&&(o=!1),void 0===i&&(i="text");var a=t.defer(),s={dataType:i,timeout:r};return o&&(s.xhrFields={withCredentials:!0}),e.$.ajax(n,s).done(function(e){a.resolve(e)}).fail(function(e,r,o){var i=o&&o.message||"error"!=r&&r||e.status||e.responseText||"generic error";t.Logger.warn("First level error on jqGet '"+n+"': "+i),a.reject({message:i})}),a.promise()}function l(e,n,r){void 0===r&&(r=2e4);var o=t.defer();if("WebSocket"in window){var i=new WebSocket(n);i.onmessage=function(e){o.resolve(e.data)},i.onopen=function(){0==e.indexOf("//")&&(e="http:"+e),i.send(e)},setTimeout(function(){o.getStatus()==t.Status.Unfulfilled&&o.reject({message:"WebSocket request "+e+" timed out after "+r+"ms"})},r)}else o.reject({message:"no WebSockets"});return o.promise()}t.toNamed=n,t.toNamedPromise=r,t.namedWhenX=o,t.namedWhen3=i,t.namedWhen2=a,t.namedWhen=s,t.namePromise=u,t.jqGetPromise=c,t.webSocketPromise=l}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){function t(){return new x}function n(e){return t().resolve(e).promise()}function r(e){return t().reject(e).promise()}function o(e,n){var r=t(),o=new Array;return i(o,r,e,n),r.promise()}function i(e,t,n,r){var o=n(r);if(!o)return void t.resolve(e);for(;o.next&&o.promise.getStatus()==A.Resolved;)if(e.push(o.promise.getResult()),o=n(o.next),!o)return void t.resolve(e);o.promise.done(function(r){e.push(r),o.next?i(e,t,n,o.next):t.resolve(e)}).fail(function(e){t.reject(e)})}function a(e){return u(function(){return!0},Number.MAX_VALUE,e,!1)}function s(e,n){void 0===n&&(n=Number.MAX_VALUE);var r=t(),o=!1;return window.setTimeout(function(){o||(o=!0,r.reject({message:"Timed out after "+n}))}),e(function(e){o||(o=!0,r.resolve(e))}),r.promise()}function u(e,n,r,o){void 0===n&&(n=0),void 0===r&&(r=500),void 0===o&&(o=!0);var i=t(),a=Date.now(),s=function(){var t=Date.now()-a;if(n>0&&t>=n)clearInterval(u),i.reject(Error("Timed out after "+t));else{var r=e();"undefined"!=typeof r&&null!=r&&(clearInterval(u),i.resolve(r))}},u=setInterval(s,r);return o&&s(),i.promise()}function c(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];var r=t();if(!e.length)return r.resolve([]),r.promise();for(var o=0,i=[],a=0;a<e.length;a++){var s=e[a];s.done(function(t){i.push(t),++o,o===e.length&&r.getStatus()!==A.Rejected&&r.resolve(i)}).fail(function(e){r.getStatus()!==A.Rejected&&r.reject(e)})}return r.promise()}function l(n,r){void 0===r&&(r=!1);var o=t();if(!n.length)return o.resolve([]),o.promise();for(var i=0,a=[],s=0;s<n.length;s++){var u=n[s];u.done(function(e){a.push(e),++i,i===n.length&&o.getStatus()!==A.Rejected&&o.resolve(a)}).fail(function(t){r?(e.Logger.warn("Continuing after inner error: "+t.message),++i):o.getStatus()!==A.Rejected&&o.reject(t)})}return o.promise()}function d(e,n,r,o,i,a){void 0===a&&(a=6e4);var s=t(),u=(new Date).getTime(),c=null,l=0,d=setInterval(function(){var t=(new Date).getTime();if(t-u>=a)clearInterval(d),s.reject({message:"Timed out after "+(t-u)});else try{var o=e();o==c?t-u>=i&&(clearInterval(d),s.resolve(o)):n(o)&&(r(o),c=o,l=t)}catch(p){s.reject(p)}},o);return s.promise()}function p(e,t,o,i,s){if(void 0===i&&(i=2),void 0===s&&(s=0),s&&s>o)return r({message:"Exponential interval timed out"});var u=a(o).then(function(){var r=e(),a=t(r);return a?n(r):p(e,t,o*i,i)});return u}function f(e,n,r,o){void 0===r&&(r=function(e){return!1}),void 0===o&&(o=2);var i,a=t(),s=n;try{var u;u=function(){var t=e();s*=o,r(t)?a.resolve(t):i=setTimeout(u,s)},i=setTimeout(u,n)}catch(c){a.reject(c)}return a.promise()}function g(e,t,n){void 0===n&&(n=100);var r;window.addEventListener(t,function(){clearTimeout(r),r=setTimeout(e,n)})}function m(e,n){void 0===n&&(n=0);var r=t(),o=null,i=!1;n>0&&(o=setTimeout(function(){i||(i=!0,r.reject({message:"Timedout after "+n}))},n));var a=function(e){i||(i=!0,clearTimeout(o),r.resolve(e))};try{e(a)}catch(s){i||(i=!0,clearTimeout(o),r.reject(s))}return r.promise()}function h(e,n,r){void 0===r&&(r=null);var o=t();return e.done(function(e){return o.getStatus()==A.Unfulfilled&&o.resolve(e)}),e.fail(function(e){return o.getStatus()==A.Unfulfilled&&o.reject(e)}),setTimeout(function(){o.getStatus()==A.Unfulfilled&&(null==r?o.reject({message:"Timed out after "+n}):o.resolve(r))},n),o.promise()}function v(t,r){void 0===r&&(r=function(e){return!!e});var o=n(null);return e.Col.of(t).each(function(e){o=o.then(function(t){return r(t)?n(t):e()})}),o}function y(e,t,r){void 0===t&&(t=function(e){return!0}),void 0===r&&(r=null);for(var o=n(null),i=0;i<e.length;i++){var a=C(e[i],t,i+1,r);o=o.alwaysThen(a)}return o}function C(t,r,o,i){void 0===i&&(i=null);var a=function(o,a,s){return!s&&null!=a&&r(a.value)?n(a):(i&&e.Logger.time(i+"."+t.name),t.value(o).then(function(n){return i&&e.Logger.timeEnd(i+"."+t.name),{name:t.name,value:n}}))};return w(a,o)}function S(e,t){return function(){return e(t)}}function b(e,t){return function(n){return e(t,n)}}function w(e,t){return function(n,r){return e(t,n,r)}}function _(e,t){return function(n,r,o){return e(t,n,r,o)}}function O(e,t){void 0===t&&(t=1);for(var n=r({message:"initial state"}),o=0;o<t;o++)n=n.alwaysThen(E(e,o));return n}function E(e,t){return void 0===t&&(t=1),function(r,o){return o?e(t):n(r)}}function F(e){return function(){return P(e())}}function P(e){return new I(e)}function R(e,n){var r=t();return D(r,e(),n),r.promise()}function D(e,t,n){t.advance().done(function(r){return r?(n(t.current),void D(e,t,n)):void e.resolve({})}).fail(function(t){return e.reject(t)})}function k(e){return"undefined"==typeof e}e.defer=t,e.resolve=n,e.reject=r,e.unfold=o,function(e){e[e.Unfulfilled=0]="Unfulfilled",e[e.Rejected=1]="Rejected",e[e.Resolved=2]="Resolved"}(e.Status||(e.Status={}));var A=e.Status;e.wait=a,e.waitForEvent=s,e.waitFor=u,e.when=c,e.typedWhen=l,e.waitForStable=d,e.setExponentialInterval2=p,e.setExponentialInterval=f,e.stableAddEventListener=g,e.promiseFromCallback=m,e.withTimeout=h,e.waterfall=v,e.namedWaterfall=y,e.lambda1=S,e.lambda2=b,e.lambda3=w,e.lambda4=_,e.retryPromise=O;var T=function(){function t(e){this.deferred=e}return t.prototype.getStatus=function(){return this.deferred.getStatus()},t.prototype.getResult=function(){return this.deferred.getResult()},t.prototype.getError=function(){return this.deferred.getError()},t.prototype.done=function(e){return this.deferred.done(e),this},t.prototype.fail=function(e){return this.deferred.fail(e),this},t.prototype.always=function(e){return this.deferred.always(e),this},t.prototype.alwaysThen=function(e){return this.deferred.alwaysThen(e)},t.prototype.then=function(e){return this.deferred.then(e)},t.prototype.logPassthrough=function(t){return this.then(function(n){return"string"==typeof n||n instanceof String?e.Logger.log(t+": "+n):e.Logger.log(t+": "+JSON3.stringify(n)),n})},t}(),x=function(){function n(){this._resolved=function(e){},this._rejected=function(e){},this._status=A.Unfulfilled,this._error={message:""},this._promise=new T(this)}return n.prototype.promise=function(){return this._promise},n.prototype.getStatus=function(){return this._status},n.prototype.getResult=function(){if(this._status!=A.Resolved)throw new Error("Promise: result not available");return this._result},n.prototype.getError=function(){if(this._status!=A.Rejected)throw new Error("Promise: rejection reason not available");return this._error},n.prototype.thenOld=function(e){var n=t();return this.done(function(t){var r=e(t);if(r&&"function"==typeof r.done&&r.deferred){var o=r;return o.done(function(e){return n.resolve(e)}).fail(function(e){return n.reject(e)}),o}n.resolve(r)}).fail(function(e){return n.reject(e)}),n.promise()},n.prototype.then=function(n){var r=t();return this.done(function(t){var o=null;try{o=n(t)}catch(i){return window.FO_NATIVE_DEBUG&&console.warn(i),e.Logger.warn("First level error: "+i.message+" @ "+n),void r.reject(i)}if(o&&"function"==typeof o.done&&o.deferred){var a=o;return a.done(function(e){return r.resolve(e)}).fail(function(e){return r.reject(e)}),a}r.resolve(o)}).fail(function(e){return r.reject(e)}),r.promise()},n.prototype.alwaysThen=function(n){var r=t(),o=function(t,o){var i=null;try{i=n(t,o)}catch(a){return e.Logger.warn("First level error: "+a.message+" @ "+n),void r.reject(a)}if(i&&"function"==typeof i.done&&i.deferred){var s=i;return s.done(function(e){return r.resolve(e)}).fail(function(e){return r.reject(e)}),s}r.resolve(i)};return this.done(function(e){return o(e,null)}).fail(function(e){return o(null,e)}),r.promise()},n.prototype.done=function(e){if(this.getStatus()===A.Resolved)return e(this._result),this;if(this.getStatus()!==A.Unfulfilled)return this;var t=this._resolved;return this._resolved=function(n){t(n),e(n)},this},n.prototype.fail=function(e){if(this.getStatus()===A.Rejected)return e(this._error),this;if(this.getStatus()!==A.Unfulfilled)return this;var t=this._rejected;return this._rejected=function(n){t(n),e(n)},this},n.prototype.always=function(e){return this.done(function(t){return e(t)}).fail(function(t){return e(null,t)}),this},n.prototype.resolve=function(e){if(this._status!==A.Unfulfilled)throw new Error("tried to resolve a fulfilled promise");return this._result=e,this._status=A.Resolved,this._resolved(e),this.detach(),this},n.prototype.reject=function(e){if(this._status!==A.Unfulfilled)throw new Error("tried to reject a fulfilled promise");return this._error=e,this._status=A.Rejected,this._rejected(e),this.detach(),this},n.prototype.detach=function(){this._resolved=function(e){},this._rejected=function(e){}},n}();e.generator=F,e.iterator=P;var I=function(){function e(e){this.f=e,this.current=void 0}return e.prototype.advance=function(){var e=this,t=this.f();return t.then(function(t){return!k(t)&&(e.current=t,!0)})},e}();e.each=R,e.isUndefined=k}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){function t(e){return new n(e)}e.pset=t;var n=function(){function t(e){this.promises=e}return t.ofPromises=function(){for(var n=[],r=0;r<arguments.length;r++)n[r-0]=arguments[r];var o=e.Col.of(n);return t.ofPromiseCol(o)},t.ofPromiseCol=function(e){var n=e.toMap(function(e,t){return t.toString()},function(e,t){return e});return t.ofMap(n)},t.ofMap=function(e){return new t(e)},t.ofHash=function(n){return new t(e.Map.ofHash(n))},t.prototype.allDone=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=""),this.allDoneWhere(function(e){return!0},e,t)},t.prototype.allDoneWhere=function(n,r,o){void 0===r&&(r=0),void 0===o&&(o="");var i=e.defer(),a={},s=this.promises.length();return this.promises.each(function(t){t.value.fail(function(t){return i.getStatus()==e.Status.Unfulfilled&&i.reject(t)}),t.value.done(function(r){i.getStatus()==e.Status.Unfulfilled&&(n(r)?(a[t.key]=r,s--,0==s&&i.resolve(e.Map.ofHash(a))):i.reject({message:t.key+" did not meet condition "+o}))})}),t.timeoutDeferred(i,r),i.promise()},t.prototype.allComplete=function(n){void 0===n&&(n=0);var r=e.defer(),o={},i=this.promises.length();return this.promises.each(function(t){t.value.always(function(n,a){r.getStatus()==e.Status.Unfulfilled&&(a?e.Logger.warn("Rejected promise '"+t.key+"' while waiting for allComplete: "+a.message):o[t.key]=n,i--,0==i&&r.resolve(e.Map.ofHash(o)))})}),t.timeoutDeferred(r,n),r.promise()},t.prototype.firstDone=function(e){return void 0===e&&(e=0),this.firstDoneWhere(function(e){return!0},e)},t.prototype.firstDoneWhere=function(n,r){void 0===r&&(r=0);var o=e.defer(),i=this.promises.length();return this.promises.each(function(t){t.value.done(function(r){return o.getStatus()==e.Status.Unfulfilled&&n(r)&&o.resolve({key:t.key,value:r})}),t.value.fail(function(t){return o.getStatus()==e.Status.Unfulfilled&&o.reject(t)}),t.value.always(function(){return o.getStatus()==e.Status.Unfulfilled&&0==--i&&o.reject({message:"All promises completed, yet none satisfied condition"})})}),t.timeoutDeferred(o,r),o.promise()},t.timeoutDeferred=function(t,n){n>0&&setTimeout(function(){return t.getStatus()==e.Status.Unfulfilled&&t.reject({message:"Timed out after "+n})},n)},t}();e.PromiseSet=n}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(e){this.userSettings=e}return t.prototype.isSuspended=function(n){var r=this.userSettings.retrive(t.SUSPENDED_KEY),o=(new Date).getTime();if(r&&n in r&&"timestamp"in r[n]){var i=r[n].timestamp;return i==-1||i>o}if(r)if(n in r&&"timestamp"in r[n]){var i=r[n].timestamp;e.Logger.log("Suspension found, but expired on "+new Date(i).toUTCString())}else e.Logger.log("Suspension id "+n+" not in suspension map");else e.Logger.log("No suspension map found");return!1},t.prototype.shouldAutoAppear=function(e){var n=this.userSettings.retrive(t.SUSPENDED_KEY);return!(n&&e in n&&"autoAppear"in n[e]&&0==n[e].autoAppear)},t.prototype.suspend=function(n,r){var o=this.userSettings.retrive(t.SUSPENDED_KEY);null==o&&(o={});var i=(new Date).getTime(),a=i+r;o[n]||(o[n]={}),o[n].timestamp=a,e.Logger.log("Suspended "+n+" until "+new Date(a).toUTCString()),this.userSettings.store(t.SUSPENDED_KEY,o)},t.SUSPENDED_KEY="suspended",t}();t.DefaultSuspender=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var Injector=function(){function e(){}return e.getAltDocument=function(){if(null==e.altDocument){var t=document.createElement("iframe");t.style.border="0px",t.style.width="1px",t.style.height="1px",t.style.left="-100px",t.style.top="-100px",t.style.visibility="hidden",document.body.appendChild(t),e.altDocument=t.contentWindow.document}return e.altDocument},e.retryOnFailure=function(t,n,r){try{t(function(o){0==n?r(o):e.retryOnFailure(t,n-1,r)},n)}catch(o){0==n?r(o):e.retryOnFailure(t,n-1,r)}},e.injectScriptWithRetries=function(t,n,r,o){void 0===o&&(o=!1),e.retryOnFailure(function(r,i){return e.injectScript(t+"?retries="+i,n,r,o)},3,r)},e.injectScript=function(t,n,r,o){void 0===o&&(o=!1);var i=null,a=!0,s=!1,u=document.createElement;u.toString().indexOf("[native code]")>0?i=document.createElement("script"):(i=e.getAltDocument().createElement.call(document,"script"),a=!1),i.onload=i.onreadystatechange=function(e){s||i.readyState&&"loaded"!==i.readyState&&"complete"!==i.readyState||(s=!0,o&&console.log("Injected script loaded"),n&&window.setTimeout(function(){n()},1))},i.onerror=function(e){s||(s=!0,o&&console.warn("Injected script failed",e),r&&window.setTimeout(function(){r(e)},1))};var c=document.getElementsByTagName("head")[0],l=c.appendChild;return l.toString().indexOf("[native code]")>0?c.appendChild(i):(e.getAltDocument().appendChild.call(c,i),a=!1),i.src=t,o&&console.log("Injected script "+t+". Using native functions: "+a),a},e.altDocument=null,e}(),FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.matchUserAgent=function(e){var t=navigator.userAgent.match(new RegExp(e+"[/ ](\\d+)","i"));return t&&!!t[1]||!1},e.getClickEventName=function(){var e="click",t=this.matchUserAgent("chrome"),n=this.matchUserAgent("safari"),r=this.matchUserAgent("firefox"),o=this.matchUserAgent("trident");return t||n?e="mousedown":(r||document.all||o)&&(e="mouseup"),e},e.addEvent=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,function(){return n.call(e,window.event)})},e.useNativeCustomEvent=function(){try{var e=new CustomEvent("cat",{detail:{foo:"bar"}});return"cat"===e.type&&"bar"===e.detail.foo}catch(t){}return!1},e.createCustomEvent=function(t,n){if(e.useNativeCustomEvent())return new CustomEvent(t,n);if("function"==typeof document.createEvent){var r=document.createEvent("CustomEvent");return n?r.initCustomEvent(t,n.bubbles,n.cancelable,n.detail):r.initCustomEvent(t,!1,!1,void 0),r}var o=document.createEventObject();return o.type=t,n?(o.bubbles=Boolean(n.bubbles),o.cancelable=Boolean(n.cancelable),o.detail=n.detail):(o.bubbles=!1,o.cancelable=!1,o.detail=void 0),o},e}();e.EventUtils=t}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function n(){}return n.isNative=function(e){return e.toString().indexOf("[native code]")>=0},n.getAltDocument=function(e){if(null==n.altDocument){var t=document.createElement("iframe");t.style.border="0px",t.style.width="1px",t.style.height="1px",t.style.left="-100px",t.style.top="-100px",t.style.visibility="hidden",e&&(t.onload=function(){n.altDocument=t.contentDocument?t.contentDocument:t.contentWindow.document,e(n.altDocument)}),!n.isNative(document.body.appendChild)&&n.isNative(document.body.insertBefore)&&document.body.firstChild?document.body.insertBefore(t,document.body.firstChild):document.body.appendChild(t),e&&(n.altDocument=t.contentDocument?t.contentDocument:t.contentWindow.document,e(n.altDocument)),n.altDocument=t.contentDocument?t.contentDocument:t.contentWindow.document}else e&&e(n.altDocument);if(!e)return n.altDocument},n.safeAddEventListener=function(e,r,o,i){t.EventUtils.matchUserAgent("firefox")?n.getAltDocument(null).addEventListener.call(e,r,o,i):n.getAltDocument(function(t){t.addEventListener.call(e,r,o,i)})},n.append=function(r,o,i){e.flag(e.Flags.Runtime.CLEAN_FNS)?i&&r.hasChildNodes()?t.EventUtils.matchUserAgent("firefox")?n.getAltDocument(null).insertBefore.apply(r,[o,r.childNodes[0]]):n.getAltDocument(function(e){e.appendChild.apply(r,[o])}):t.EventUtils.matchUserAgent("firefox")?n.getAltDocument(null).insertBefore.apply(r,[o,r.childNodes[0]]):n.getAltDocument(function(e){e.appendChild.apply(r,[o])}):i&&r.hasChildNodes()?r.insertBefore(o,r.childNodes[0]):r.appendChild(o)},n.altDocument=null,n}();t.SafeDocument=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(){function r(){}return r.initialize=function(e){r.autoExecute=e;var t=new MutationObserver(r.onMutation),n={attributes:!0,childList:!0,characterData:!0,subtree:!0};t.observe(document.body,n)},r.getElementReconstitution=function(e){return e.reconstitution?e.reconstitution:[]},r.appendElementReconstitution=function(e,t){e.reconstitution||(e.reconstitution=[]),e.reconstitution.push(t)},r.onMutation=function(e,n){r.pass||t.Col.of(e).each(function(e){t.Col.ofNodes(e.addedNodes).each(r.protectAgainstCovering)})},r.startExecuteOnce=function(){r.startedExecute||(r.startedExecute=!0,r.startExecute())},r.startExecute=function(){var e=t.flag(t.Flags.Runtime.DEBUG);r.autoExecute=!0,t.Col.of(r.pendingExecute).each(function(t){e&&console.log("removing for protection - resumed",t),t&&t.parentNode&&t.parentNode.removeChild(t)}),r.pendingExecute=[]},r.protectAgainstCovering=function(n){var o=t.flag(t.Flags.Runtime.DEBUG);if(n.nodeType==Node.ELEMENT_NODE){var i=n,a=e.$(n),s=a.closest(r.ownSelector).length>0,u=parseInt(a.css("z-index")),c="undefined"!=typeof i.style&&("transparent"==i.style.backgroundColor||"0"==i.style.opacity||"0.0"==i.style.opacity);if(!s&&u>r.MAX_FOREIGN_ZINDX&&c){var l=a.find(".sgsefvhuedc").length>0;l?o&&console.log("Will NOT remove element with a safe class",n):r.autoExecute?(o&&console.log("removing for protection",n),i&&(i.style.width="10px",i.style.height="10px")):(o&&console.log("Postponing execution",n),r.pendingExecute.push(i))}}return!1},r.registerProtectedRoot=function(e){r.ownRoots.push(e)},r.safeMutate=function(e){r.pass=!0,e(),setTimeout(function(){return r.pass=!1},50)},r.safeAppend=function(e,t,o){n.SafeDocument.append(document.body,t,o),r.registerProtectedRoot(t)},r.safeRemove=function(t){console.log("Safe remove",t),r.safeMutate(function(){return e.$(t).remove()})},r.MAX_FOREIGN_ZINDX=2147483547,r.pass=!1,r.ownSelector=".fo-root",r.ownRoots=[],r.pendingExecute=[],r.startedExecute=!1,r}();n.DomProtect=r}(n=t.Common||(t.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(t,n,r,o){void 0===o&&(o=null),this._isDebugMode=!1,this.extraParams={},this.extraParams={},this._paths=t,this._params=n,this._host=window.location.host,this._isDebugMode=this.determineIsDebugMode(),this._overrides=o?o:new e.Overrides(this);for(var i in r)this.extraParams[i]=r[i]}return t.prototype.paths=function(){return this._paths},t.prototype.params=function(){return this._params},t.prototype.host=function(){return this._host},t.prototype.isDebugMode=function(){return this._isDebugMode},t.prototype.overrides=function(){return this._overrides},t.prototype.determineIsDebugMode=function(){return!!window.FO_DEBUG},t.prototype.pushNotificationParam=function(e,t){this.extraParams[e]=t},t.prototype.notificationParams=function(){var e={hn:this.host(),partid:this.params()?this.params().partnerCode:"",subid:this.params()?this.params().subId:"",v:"0_0_1214",fam:"nwp",dmn:this.paths().domain(),safepassage:"1"};for(var t in this.extraParams)e[t]=this.extraParams[t];return e},t}();e.BootstrapContext=t}(t=e.Context||(e.Context={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function n(){}return n.getCountry=function(e){return t.VersionSingletone.perform("country",function(){return n.getCountryPromise(e)})},n.getCountryNative=function(e){return t.VersionSingletone.perform("country.native",function(){return n.nativeGetCountryPromise(e)})},n.getCountryPromise=function(t){var n=window.FO_COUNTRY;if(n)return e.Logger.log("Impersonaating country "+n),e.resolve(n);var r=t.paths().apiRoot()+"/fo/country.js";return e.jqGetPromise(r).then(function(e){var t=JSON3.parse(e);return t.country}).alwaysThen(function(t,n){return n&&!t?(e.Logger.warn("Failed getting Country.js for context.Defaulting to 'US': "+n.message),t="US"):e.Logger.log("Country resolved as "+t),t})},n.nativeGetCountryPromise=function(n){var r=window.FO_COUNTRY;if(r)return e.Logger.log("Impersonaating country "+r),e.resolve(r);var o=n.paths().apiRoot()+"/fo/country.js";return t.NativeJSHelper.nativeAjax(o).then(function(e){var t=JSON3.parse(e);return t.country}).alwaysThen(function(t,n){return n&&!t?(e.Logger.warn("Failed getting Country.js for context.Defaulting to 'US': "+n.message),t="US"):e.Logger.log("Country resolved as "+t),t})},n}();t.CountryHelper=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.encodeInternal=function(t,n){var r,o,i,a,s,u,c,l="",d=0;for(t=e._utf8_encode(t);d<t.length;)r=t.charCodeAt(d++),o=t.charCodeAt(d++),i=t.charCodeAt(d++),a=r>>2,s=(3&r)<<4|o>>4,u=(15&o)<<2|i>>6,c=63&i,isNaN(o)?u=c=64:isNaN(i)&&(c=64),l=l+n.charAt(a)+n.charAt(s)+n.charAt(u)+n.charAt(c);return l},e.decodeInternal=function(t,n){var r,o,i,a,s,u,c,l="",d=0;for(t=t.replace(/[^A-Za-z0-9\-\_\=]/g,"");d<t.length;)a=n.indexOf(t.charAt(d++)),s=n.indexOf(t.charAt(d++)),u=n.indexOf(t.charAt(d++)),c=n.indexOf(t.charAt(d++)),r=a<<2|s>>4,o=(15&s)<<4|u>>2,i=(3&u)<<6|c,l+=String.fromCharCode(r),64!=u&&(l+=String.fromCharCode(o)),64!=c&&(l+=String.fromCharCode(i));return l=e._utf8_decode(l)},e.encode=function(t){return e.encodeInternal(t,e._keyStr)},e.decode=function(t){return e.decodeInternal(t,e._keyStr)},e._utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},e._utf8_decode=function(e){for(var t="",n=0,r=0,o=0,i=0;n<e.length;)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(o=e.charCodeAt(n+1),t+=String.fromCharCode((31&r)<<6|63&o),n+=2):(o=e.charCodeAt(n+1),i=e.charCodeAt(n+2),t+=String.fromCharCode((15&r)<<12|(63&o)<<6|63&i),n+=3);return t},e._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",e}();e.Base64=t}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function n(){}return n.countWords=function(t){var n=e.Col.of(t).groupBy(function(e){return e}),r=n.selectValues(function(e){return e.value.length});return r},n.countWords_old=function(t){var n=e.StaticCol.groupByString(t,function(e){return e}),r=e.StaticCol.hashSelect(n,function(e){return e.length});return r},n.getNonTrivialWords=function(e){var t=new RegExp("^"+window.location.hostname.replace(/\./g,"|")+"$","i"),r=new RegExp(n.trivialWordPattern,"i"),o=[];return e&&(e=n.cleanString(e).toLowerCase(),o=n.splitToDistinctWords(e,function(e){return!r.test(e)&&!t.test(e)&&"|"!=e})),o},n.splitToDistinctWords=function(t,n){var r=t.match(/\S+/g);return r?e.Col.of(r).distinct(function(e){return e}).where(n).toArray():[]},n.cleanString=function(e){return e=e.replace(/(<([^>]+)>)/gi,""),e=e.replace(/\$\d(?:\d|,|&|\.)*/g," "),e=e.replace(/\(.*\)/g," "),e=e.replace(/[\|,\-\/#!$%\^&\*;:{}=\-_`~()@\+\?><\[\]\+]/g," "),
e=e.replace(/\./g,function(e,t,n){var r=0!=t&&n[t-1].match(/\d/),o=t!=n.length-1&&n[t+1].match(/\d/);return r&&o?".":" "}),e=e.replace(/\s{2,}/g," "),e=e.replace(/('|\s$)/g,""),/[\u00C0-\u017F]/.test(e)&&(e=n.removeDiacritics(e)),e},n.removeDiacritics=function(e){for(var t=[{base:"A",letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},{base:"AA",letters:/[\uA732]/g},{base:"AE",letters:/[\u00C6\u01FC\u01E2]/g},{base:"AO",letters:/[\uA734]/g},{base:"AU",letters:/[\uA736]/g},{base:"AV",letters:/[\uA738\uA73A]/g},{base:"AY",letters:/[\uA73C]/g},{base:"B",letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},{base:"C",letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},{base:"D",letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},{base:"DZ",letters:/[\u01F1\u01C4]/g},{base:"Dz",letters:/[\u01F2\u01C5]/g},{base:"E",letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},{base:"F",letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:"G",letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},{base:"H",letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},{base:"I",letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},{base:"J",letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:"K",letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},{base:"L",letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},{base:"LJ",letters:/[\u01C7]/g},{base:"Lj",letters:/[\u01C8]/g},{base:"M",letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},{base:"N",letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},{base:"NJ",letters:/[\u01CA]/g},{base:"Nj",letters:/[\u01CB]/g},{base:"O",letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},{base:"OI",letters:/[\u01A2]/g},{base:"OO",letters:/[\uA74E]/g},{base:"OU",letters:/[\u0222]/g},{base:"P",letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},{base:"Q",letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:"R",letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},{base:"S",letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},{base:"T",letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},{base:"TZ",letters:/[\uA728]/g},{base:"U",letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},{base:"V",letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},{base:"VY",letters:/[\uA760]/g},{base:"W",letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},{base:"X",letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:"Y",letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},{base:"Z",letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},{base:"a",letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},{base:"aa",letters:/[\uA733]/g},{base:"ae",letters:/[\u00E6\u01FD\u01E3]/g},{base:"ao",letters:/[\uA735]/g},{base:"au",letters:/[\uA737]/g},{base:"av",letters:/[\uA739\uA73B]/g},{base:"ay",letters:/[\uA73D]/g},{base:"b",letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},{base:"c",letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},{base:"d",letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},{base:"dz",letters:/[\u01F3\u01C6]/g},{base:"e",letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},{base:"f",letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:"g",letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},{base:"h",letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},{base:"hv",letters:/[\u0195]/g},{base:"i",letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},{base:"j",letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:"k",letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},{base:"l",letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},{base:"lj",letters:/[\u01C9]/g},{base:"m",letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},{base:"n",letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},{base:"nj",letters:/[\u01CC]/g},{base:"o",letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},{base:"oi",letters:/[\u01A3]/g},{base:"ou",letters:/[\u0223]/g},{base:"oo",letters:/[\uA74F]/g},{base:"p",letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},{base:"q",letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:"r",letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},{base:"s",letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},{base:"t",letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},{base:"tz",letters:/[\uA729]/g},{base:"u",letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},{base:"v",letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},{base:"vy",letters:/[\uA761]/g},{base:"w",letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},{base:"x",letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:"y",letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},{base:"z",letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}],n=0;n<t.length;n++)e=e.replace(t[n].letters,t[n].base);return e},n.encodedTrivialWordPattern="XihzZWFyY2h8cmVzdWx0fHJlc3VsdHN8Y29tfGluZm98bmV0fGl0ZW18a2V5d29yZHxrZXl3b3Jkc3xjYXJ0fGZvcnxhY2NvdW50c3xhY2NvdW50fGN1c3RvbWVyfHNlcnZpY2V8c3VwcG9ydHxjb250YWN0fHdlfGRlc2NyaXB0aW9ufHhtbHxwcm94eXxzdHlsZXNoZWV0fHNob3BzfHNob3B8c2hvcHBpbmd8cHJpY2V8bWlufG1heHxvbmxpbmV8aWR8ZW1haWx8c2hpcHxzaGlwcGluZ3x0b3xwZXJzb25hbGl6ZWR8c3VjaGVufGxpZWJsaW5nc3Byb2R1a3R8cHJvZHVrdHxkZXxzdWNoZXxlcmdlYm5pc3xlcmdlYm5pc3NlfGFydGlrZWx8c3RpY2h3b3J0fGpvYnRpdGVsfHdhcmVua29yYnxrdW5kZW5kaWVuc3R8a3VuZGVuc3VwcG9ydHxrb250YWt0aWVyZW58dW50ZXJzdMO8dHp1bmd8d2lyfGJlc2NocmVpYnVuZ3xlaW5rYXVmZW58Z2VzY2jDpGZ0ZXxwcmVpc3xzY2hpZmZzfHZlcnNhbmR8dW50ZXJzdMO8dHp1bmd8c2NodWhlfHphbGFuZG98YWNjb3VudHxwcm9kdWt0ZXxvbmxpbmVzaG9wfHN1Y2hlcmdlYm5pc3NlfHF1ZXJ5fGxhbmdpZHxtYXJrdHxtZWRpYXxtdWx0aWNoYW5uZWxzZWFyY2h8YWNoYXRzfGFjaGF0c3xjb21tZXJjZXxkaXNjb3VudHxyZWNoZXJjaMOpfHJlY2hlcmNoZXxyZWNoZXJjaGVyfHJlY2hlcmNoZXN8Y2hlcmNoZXJ8cHJvZHVpdHxwcm9kdWl0c3xhcnRpY2xlfHLDqXN1bHRhdHxyw6lzdWx0YXRzfHN1aXRlfGNvbnNlcXVlbmNlfHJhaXNvbnxwcml4fHBhZ2V8YXNwfGFzcHh8cGhwfGNob2l4fHByaXh8w6lsZWN0cm9tw6luYWdlcnxhY2N1ZWlsfGhvbWVwYWdlfG1hcmNoYW5kfG1lcmNoYW50fGjDpG5kbGVyfHVybHxodG1sfHByb2RvdHRpfHByb2dyYW1taXxndWFyZGFyZXxwcmV6eml8dHJvdmF8YWNxdWlzdGl8cmljZXJjYXxjb25mcm9udGF8b2ZmZXJ0ZXxjZXJjYXxJc2NyaXZpdGl8QWNjZWRpfGxvZ2lufGVtYWlsfGUtbWFpbHxzY29udGl8bGF2b3JldHRpfG1lbnV8Y29yc298YmVuZXNzZXJlfHBhcmNoZWdnaXxyaWNhcmljYWJpbGV8Y29tcGFyYXxsaXN0c2FsZXN8cmV0dXJudXJsfHNhbGVzfHRhZ3x0YWduYW1lfG9mZmVydGF8cHJvZHVjdHxkZXRhaWxzKSQ=",n.trivialWordPattern=t.Base64.decode(n.encodedTrivialWordPattern),n}();t.WordUtils=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(n){var r=function(){function n(t,n,r,o,i){this.context=null,this.suspendIdentifier=null,this.legacySuspendIdentifier=null,this.suspendPeriods=null,this.suspendBoxOpen=e.ko.observable(!1),this.suspendPeriods=o,this.selectedPeriodMS=e.ko.observable(this.suspendPeriods[0].ms),this.context=t,this.suspendIdentifier=n,this.legacySuspendIdentifier=r,this.closeFn=i}return n.prototype.openSuspendBox=function(){this.suspendBoxOpen(!0)},n.prototype.closeSuspendBox=function(){this.suspendBoxOpen(!1)},n.prototype.shouldAutoAppear=function(){return this.context.suspender().shouldAutoAppear(this.suspendIdentifier)},n.prototype.applySelectedSuspension=function(){this.suspend(this.selectedPeriodMS())},n.prototype.suspend=function(e){this.context.suspender().suspend(this.suspendIdentifier,e),e>0?this.closeFn():this.closeSuspendBox(),t.Logger.Analytics.notify(this.context,t.Logger.Analytics.SUSPEND,{identifier:this.suspendIdentifier,period:e.toString()})},n.prototype.openSuspendWindow=function(){var e=t.Common.stringFormat("http://removemyapp.info/suspend.html?hid={0}_{1}&contact={2}",this.context.userSettings().uuid(),this.legacySuspendIdentifier,encodeURIComponent(this.context.params().providerLink)),r="toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=730, height=400",o=window.open(e,"",r),i=this,a=window.setInterval(function(){var e=n.checkSuspendWindowClosed(i,o,i.closeFn);e&&window.clearInterval(a)},500)},n.checkSuspendWindowClosed=function(e,n,r){return!(!n||!n.closed)&&(e.context.userSettings().reload().then(function(){var n=e.context.suspender().isSuspended(e.suspendIdentifier),o=e.context.suspender().shouldAutoAppear(e.suspendIdentifier);t.Logger.log("Suspend advanced window closed. Suspended: "+n+". AutoAppear: "+o),n&&r()}),!0)},n.prototype.openSuspendWindow_new=function(){var e=this,n=t.Common.stringFormat("http://removemyapp.info/suspend.html?hid={0}_{1}&contact={2}",this.context.userSettings().uuid(),this.legacySuspendIdentifier,encodeURIComponent(this.context.params().providerLink)),r="toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=730, height=400",o=window.open(n,"",r),i=window.setInterval(function(){o&&o.closed&&(e.context.userSettings().reload().then(function(){var n=e.context.suspender().isSuspended(e.suspendIdentifier),r=e.context.suspender().shouldAutoAppear(e.suspendIdentifier);t.Logger.log("Suspend advanced window closed. Suspended: "+n+". AutoAppear: "+r),n&&e.closeFn()}),window.clearInterval(i))},500)},n.defaultSuspendPeriods=[{text:"1 Hour",ms:36e5},{text:"1 Day",ms:864e5},{text:"1 Week",ms:6048e5}],n.strictSuspendPeriods=[{text:"1 Day",ms:864e5},{text:"1 Week",ms:6048e6},{text:"Forever",ms:3155692597470}],n.allSuspendPeriods=[{text:"1 Hour",ms:36e5},{text:"1 Day",ms:864e5},{text:"1 Week",ms:6048e5},{text:"Forever",ms:3155692597470}],n.defaultNoSuspendPeriods=[{text:"No Suspend",ms:-1},{text:"1 Hour",ms:36e5},{text:"1 Day",ms:864e5},{text:"1 Week",ms:6048e5}],n}();n.SuspendTarget=r}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e){this.datastore=null,window.FO.GlobalStore||(window.FO.GlobalStore={}),this.datastore=window.FO.GlobalStore,e&&(e in this.datastore||(this.datastore[e]={}),this.datastore=this.datastore[e])}return e.prototype.retrive=function(e){return this.datastore[e]},e.prototype.store=function(e,t){this.datastore[e]=t},e.prototype.remove=function(e){delete this.datastore[e]},e.prototype.retriveAndRemove=function(e){var t=this.retrive(e);return this.remove(e),t},e}();e.GlobalSpace=t}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function n(){}return n.resolveProductsByRealEstate=function(r,o){var i=[],a=e.StaticCol.groupByString(o,function(t){return e.Products.VisualRealEstate[t.product.visual.realEstate()]});for(var s in a){var u=a[s],c=e.StaticCol.maxBy(u,function(e){return e.score});i.push(c.product)}for(var l=new t.GlobalSpace("RealEstate"),d=[],p=0;p<i.length;p++){var f=i[p],g=e.Products.VisualRealEstate[f.visual.realEstate()],m=n.isTaken(l,g);m?(e.Logger.info("Product "+f.name+" skipped. Its realestate "+g+" is occupied"),e.Logger.Analytics.notify(r,e.Logger.Analytics.NO_SHOW,{reason:"realestate_taken",w:f.visual.flag()},0)):(n.claimRealestate(l,g,f.name),l.store(g,f.name),d.push(f))}return d},n.isTaken=function(e,t){var r=!!e.retrive(t);if(r)return!0;var o=n.realEstateToOldMarker(t);if(o){var i=!!window[o];if(i)return!0}return!1},n.claimRealestate=function(e,t,r){e.store(t,r);var o=n.realEstateToOldMarker(t);o&&(window[o]=!0)},n.releaseRealestate=function(r){var o=new t.GlobalSpace("RealEstate");o.remove(r);var i=n.realEstateToOldMarker(r);i&&(window[i]=!1),e.Logger.log("Released realestate "+r)},n.realEstateToOldMarker=function(e){var t={RIGHT_PANEL:"__rsor",BOTTOM_PANEL:"__bsor"};return t[e]},n}();t.RealEstateHelper=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t=function(){function e(){for(var e in this)"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e}();e.RootClass=t}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(n){var r=function(r){function o(o,i,a,s){var u=this;void 0===s&&(s=function(){}),r.call(this),this.collapsed=e.ko.observable(!1),this.hidden=e.ko.observable(!1),this.suspendTarget=null,this.videoContainerId="FO_jwplayer_videoContainer",this.winSize=e.ko.observable({x:0,y:0}),this.docSize=e.ko.observable({x:0,y:0}),this.coveredImageUrl=e.ko.observable(""),this.postRenderHandler=function(e,t){};var c=this;this.context=o,this.suspendIdentifier=i,this.providerLink=o.params().providerLink,this.providerName=o.params().providerName,this.providerFooter=o.params().providerFooter;var l=o.overrides().boolValue("show-extra-attribute",!1);this.extraAttribution=l&&window.__rvzfrrstfr&&window.__rvzfrrstfr.product_name;var d=this.extraAttribution?n.SuspendTarget.strictSuspendPeriods:n.SuspendTarget.defaultSuspendPeriods;switch(o.productName){case"PushDisplay":d=n.SuspendTarget.defaultNoSuspendPeriods}this.suspendTarget=new n.SuspendTarget(o,i,a,d,function(){return u.destroy()}),this.collapsed(!this.suspendTarget.shouldAutoAppear()),this.onClose=s,this.afterRender=function(n,r){if(0==n.length)t.Logger.warn("No nodes sent to after render. wtf?");else{var o=n[0].parentNode,i=e.$(o);u.postRenderHandler(i,o)}};var p=function(){c.winSize({x:e.$(window).width(),y:e.$(window).height()}),c.docSize({x:e.$(document).width(),y:e.$(document).height()})};p(),e.$(window).resize(p)}return __extends(o,r),o.prototype.hide=function(){this.destroy()},o.prototype.destroy=function(){this.hidden(!0),t.Common.RealEstateHelper.releaseRealestate(this.suspendIdentifier),this.onClose()},o.prototype.toggleCollapsed=function(){this.collapsed(!this.collapsed())},o.prototype.blockPropagation=function(e,t){return t&&(t.stopPropagation(),t.cancelBubble=!0),!0},o}(t.RootClass);n.ProductModelBase=r}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.treatForCollisions=function(t){t.addClass(e.antiCollisionClass),t.find("*").addClass(e.antiCollisionClass)},e.antiCollisionClass="fo-close-xyz sgsefvhuedc",e}();e.CollisionHelper=t}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL",e[e.BOTH=2]="BOTH"}(r||(r={}));var o=function(){function n(){}return n.waitForBody=function(){return t.waitFor(function(){return document.body},0,100,!0)},n.appendHtmlWithRootClass=function(t,r,o){void 0===o&&(o=document);var i=e.$(t).addClass(r);return n.appendToBody(i,o),i},n.parseAndAppendHtmlToElement=function(t,n){var r=e.$.parseHTML(t);return e.$(n).append(r)},n.appendToDivById=function(e,t,r){void 0===r&&(r=document);var o=r.getElementById(e);n.safeAppend(o,t,!1)},n.appendToBody=function(e,t){void 0===t&&(t=document),n.safeAppend(t.body,e,!1)},n.appendToHead=function(e,t){void 0===t&&(t=document),n.safeAppend(t.head,e,!1)},n.safeAppend=function(t,n,r){var o="ver"+(1e7*Math.random()).toFixed();if(n.addClass(o),r?e.$(t).prepend(n):e.$(t).append(n),0==e.$("."+o).length){for(var i=0;i<n.length;i++){var a=n[i],s=t.childElementCount>0?t.children.item(0):null;t.insertBefore(a,s)}if(0==e.$("."+o).length)throw new Error("Root element cannot be found after supposadly appended")}},n.elementBelowTheFold=function(t,n,r){var o=e.$(window).height()+e.$(window).scrollTop();return o<=e.$(t).offset().top+e.$(t).height()*n-r},n.elementAboveTheTop=function(t,n,r){var o=e.$(window).scrollTop(),i=e.$(t).height();return o>=e.$(t).offset().top+i-i*n-r},n.elementRightOfScreen=function(t,n,r){var o=e.$(window).width()+e.$(window).scrollLeft();return o<=e.$(t).offset().left-(e.$(t).width()*n-r)},n.positionNextTo=function(t,r,o,i){void 0===o&&(o=0),void 0===i&&(i=window);var a,s=n.getElementPosWithOffsets(t[0]),u=t.width(),c=r.width(),l=s.left+u+o+c<i.innerWidth,d=s.left-o>c;a=l?s.left+u+o:d?s.left-o-c:(i.innerWidth-c)/2;var p=Math.min(s.top,e.$(i).scrollTop()+e.$(i).height()-r.height());return{x:a,y:p}},n.getElementPosWithOffsets=function(e){var t=e[0]||e;if(t&&t.getBoundingClientRect){var n={top:0,left:0,width:0,height:0,bottom:0,right:0},r=t&&t.ownerDocument;if(n=t.getBoundingClientRect(),!r)return n;var o=r.defaultView||r.parentWindow,i=r.documentElement,a=n.top+(o.pageYOffset||i.scrollTop||0)-(i.clientTop||0),s=n.left+(o.pageXOffset||i.scrollLeft||0)-(i.clientLeft||0),u=t.offsetWidth||0,c=t.offsetHeight||0,l=a+c,d=s+u;return{top:a,left:s,width:u,height:c,bottom:l,right:d}}},n.isContained=function(e,t,n){return e>=n.left&&e<=n.right&&t>=n.top&&t<=n.bottom},n.elementLeftOfScreen=function(t,n,r){var o=e.$(window).scrollLeft(),i=e.$(t).width();return o>=e.$(t).offset().left+i-i*n-r},n.isElementInViewport=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r={}),!(n.elementRightOfScreen(e,t,r.right||0)||n.elementLeftOfScreen(e,t,r.left||0)||n.elementBelowTheFold(e,t,r.bottom||0)||n.elementAboveTheTop(e,t,r.top||0))},n}();n.VisualHelper=o}(n=t.Common||(t.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.INVALID=0]="INVALID",e[e.SMALL=1]="SMALL",e[e.LARGE=2]="LARGE"}(e.ProductImageSize||(e.ProductImageSize={}));var t=e.ProductImageSize;e.defaultPBSettings={useGeneric:!0,generic:{productImageAreas:[{size:t.INVALID,maxArea:3500},{size:t.SMALL,maxArea:4e4},{size:t.LARGE,maxArea:1e6}],productImageMaxRatio:2.8,productBoxToImageMaxRatio:9,productBoxToImageSingleDimensionMaxRatio:4},useCustom:!1},e.laxGenericSettings={productImageAreas:[{size:t.INVALID,maxArea:5e3},{size:t.SMALL,maxArea:4e4},{size:t.LARGE,maxArea:1e6}],productImageMaxRatio:6,productBoxToImageMaxRatio:18,productBoxToImageSingleDimensionMaxRatio:4}}(t=e.ProductBoxes||(e.ProductBoxes={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.calculateBoxElement=function(n){var r=e.$(n),o=r.outerWidth(),i=r.outerHeight(),a=Math.max(i/o,o/i),s=o*i,u=r.is(":visible"),c=t.Common.VisualHelper.getElementPosWithOffsets(n),l={element:n,jqElement:r,width:o,height:i,ratio:a,area:s,isVisible:u,rect:c};return l},n.updateBoxDimensionsToImage=function(e){var t=e.width,n=e.image.height,r=Math.max(n/t,t/n),o=t*n;return e.height=n,e.ratio=r,e.area=o,e.rect.height=n,e.productToImageRatio=e.area/e.image.area,e},n.isElementHidden=function(e){return!e||"none"===n._getStyle(e,"display")||"hidden"===n._getStyle(e,"visibility")},n.isElementVisible=function(t){return e.$(t).is(":visible")},n._getStyle=function(e,t){return window.getComputedStyle?document.defaultView.getComputedStyle(e,null)[t]:e.currentStyle?e.currentStyle[t]:void 0},n.isVisible=function(e,t){function r(e,t,i,a,s,u,c,l){var d=e.parentNode,p=2;return!!o(e)&&(9===d.nodeType||"0"!==n._getStyle(e,"opacity")&&"none"!==n._getStyle(e,"display")&&"hidden"!==n._getStyle(e,"visibility")&&("undefined"!=typeof t&&"undefined"!=typeof i&&"undefined"!=typeof a&&"undefined"!=typeof s&&"undefined"!=typeof u&&"undefined"!=typeof c||(t=e.offsetTop,s=e.offsetLeft,a=t+e.offsetHeight,i=s+e.offsetWidth,u=e.offsetWidth,c=e.offsetHeight),!d||!l||("hidden"!==n._getStyle(d,"overflow")&&"scroll"!==n._getStyle(d,"overflow")||!(s+p>d.offsetWidth+d.scrollLeft||s+u-p<d.scrollLeft||t+p>d.offsetHeight+d.scrollTop||t+c-p<d.scrollTop))&&(e.offsetParent===d&&(s+=d.offsetLeft,t+=d.offsetTop),r(d,t,i,a,s,u,c,l))))}function o(e){for(;e=e.parentNode;)if(e==document)return!0;return!1}return void 0===t&&(t=!0),r(e,void 0,void 0,void 0,void 0,void 0,void 0,t)},n}();n.DomHelper=r}(n=t.ProductBoxes||(t.ProductBoxes={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){t.knownCurrencies=e.Col.of([{iso:"USD",patterns:["\\$","USD","US\\s+\\$","DOLLAR","DOLLARS"],meaninglessSeparators:",",decimalSeparators:"."},{iso:"GBP",patterns:["","\\u00A3","POUND","GBP"],meaninglessSeparators:",",decimalSeparators:"."},{iso:"EUR",patterns:["","\\u20AC","EURO","EUR"],meaninglessSeparators:",",decimalSeparators:"."},{iso:"JPY",patterns:["","\\u00A5","YEN"],meaninglessSeparators:",",decimalSeparators:"."},{iso:"ILS",patterns:["\\u20aa","ILS","NIS","ILS ",""],meaninglessSeparators:",",decimalSeparators:"."},{iso:"PLN",patterns:["z"],meaninglessSeparators:".",decimalSeparators:","},{iso:"INR",patterns:["Rs\\."],meaninglessSeparators:",",decimalSeparators:"."},{iso:"TR",patterns:["TL"],meaninglessSeparators:".",decimalSeparators:","},{iso:"BRL",patterns:["R\\$","BRL"],meaninglessSeparators:".",decimalSeparators:","},{iso:"RUB",patterns:["",""],meaninglessSeparators:" ",decimalSeparators:","}])}(t=e.ProductBoxes||(e.ProductBoxes={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Irrelevant=0]="Irrelevant",e[e.HomePage=1]="HomePage",e[e.ProductPage=2]="ProductPage",e[e.ListPage=3]="ListPage",e[e.SearchPage=4]="SearchPage",e[e.CartPage=5]="CartPage",e[e.BelowFoldListPage=6]="BelowFoldListPage",e[e.CheckoutPage=7]="CheckoutPage",e[e.Weird=8]="Weird"}(e.PageType||(e.PageType={}));e.PageType}(t=e.Classification||(e.Classification={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function n(){}return n.retrieveSettings=function(n){for(var r in t.manualCustomSettings)if(n.match(r))return e.resolve(t.manualCustomSettings[r]);return e.resolve(null)},n}();t.CustomHelper=n,t.manualCustomSettings={"xx_ebay\\.co[\\.\\w]{1,3}/itm/":{useGeneric:!0,useCustom:!0,custom:{boxSelectors:[{name:"ebay product page",boxSelector:"#CenterPanelInternal",titleSelector:"#itemTitle",priceSelector:"#prcIsum",isVerifier:!1,minCount:1}]}},"xx_amazon\\.co[\\.\\w]{1,3}":{useGeneric:!0,useCustom:!0,custom:{boxSelectors:[{name:"amazon product page",boxSelector:"#centerCol",titleSelector:"#productTitle",priceSelector:"#priceblock_ourprice",isVerifier:!1,minCount:0}]}},"xx_homedepot\\.com/p/":{useGeneric:!0,useCustom:!0,custom:{boxSelectors:[{name:"homedepot product page",boxSelector:"#productinfo_ctn",titleSelector:".product_title",priceSelector:"#ajaxPrice",isVerifier:!1,minCount:1}]}}}}(t=e.ProductBoxes||(e.ProductBoxes={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(){function r(){this.priceSuffixes=["(per|/)?\\s*\\w+"],this.priceSuffixesPattern="\\s*("+this.priceSuffixes.join("|")+")?\\s*",this.pricePatternSymbols="("+n.knownCurrencies.selectMany(function(e){return e.patterns}).stringJoin("|")+")",this.singlePricePattern="([\\s\\d\\.,\\-]*)"+this.pricePatternSymbols,this.pricePattern="([\\s\\d\\.,\\-]*)"+this.pricePatternSymbols+"([\\s\\d\\.,\\-]*)",this.priceSeperatorPattern="\\s*(\\-|to)\\s*",this.strictPriceRx=new RegExp("^"+this.pricePattern+"(?:"+this.priceSeperatorPattern+this.pricePattern+")?"+this.priceSuffixesPattern+"$","gi"),this.strictPriceRxForChildlessNodes=new RegExp(this.pricePattern+"(?:"+this.priceSeperatorPattern+this.pricePattern+")?"+this.priceSuffixesPattern+"$","gi")}return r.prototype.customScrape=function(r,o,i,a){var s=this,u=t.Col.of(o.boxSelectors).selectMany(function(r){var o=t.Col.fromSelector(r.boxSelector).select(function(t){var o=n.DomHelper.calculateBoxElement(t),i=e.$(t),a=i.find(r.titleSelector);if(0==a.length)return null;o.mainText=a[0].textContent;var u=i.find(r.priceSelector);return 0==u.length?null:(o.price=s.priceFromElement(u[0]),o)});return r.minCount>o.length()&&i&&i.reportUnfulfilledCustom(r,o.length()),o.toArray()}),c=null;if(o.searchBoxSelector){var l=e.$(o.searchBoxSelector);l.length>0&&l[0].textContent&&(c={element:l[0],text:l[0].textContent})}var d=o.explicitPageType?t.Classification.PageType[o.explicitPageType]:null;return{boxes:u,searchBox:c,explicitPageType:d}},r.prototype.debugNaiveScrape=function(e){var t=n.defaultPBSettings;this.scrapeByImageNaive(e,t.generic,!0)},r.prototype.debugScrape=function(e){void 0===e&&(e=document.documentElement);var t=n.defaultPBSettings;this.genericScrape(e,t.generic,!0)},r.prototype.debugPrice=function(e){var n=this;t.StaticCol.recurseElements(e,function(e,r){n.tryPriceFromElement(e,!0);return t.RecursionFlow.CONTINUE})},r.prototype.genericScrape=function(e,r,o){var i=this,a=function(e){return i.collectMeaningfullBoxes(e,r,o)},s=function(e,t,n){return i.mergeMeaningfullBoxes(e,t,n,r,o)},u=t.StaticCol.recurseSelectElements(e,a,s,this.getIgnoreableElements(),function(e,t){return n.DomHelper.isElementHidden(e)||t.productBoxes.length>=8}),c=t.Col.of(u[1].productBoxes).orderByDesc(function(e){return e.area});return c=c.where(function(e){var t=c.first(function(t){return e.element!=t.element&&e.element.contains(t.element)&&e.price.value==t.price.value&&e.mainText==t.mainText});return t&&o&&console.log(e.element," eliminated. contains ",t.element),!t})},r.prototype.collectMeaningfullBoxes=function(e,r,o){if(n.DomHelper.isVisible(e,!1))if("img"==e.tagName.toLowerCase()){var i=this.productImageFromIMG(e,r,o);if(i.size!=n.ProductImageSize.INVALID)return[t.RecursionFlow.BREAK_NODE,{validImage:i,validPrices:[],productBoxes:[]}]}else{var a=this.tryPriceFromElement(e,o);if(a)return[t.RecursionFlow.BREAK_NODE,{validImage:null,validPrices:[a],productBoxes:[]}]}return[t.RecursionFlow.CONTINUE,{validImage:null,validPrices:[],productBoxes:[]}]},r.prototype.mergeMeaningfullBoxes=function(e,t,n,r,o){var i;i=t.validImage&&n.validImage?t.validImage.area>n.validImage.area?t.validImage:n.validImage:t.validImage||n.validImage;var a={validImage:i,validPrices:t.validPrices.concat(n.validPrices),productBoxes:t.productBoxes.concat(n.productBoxes)},s=this.tryCombineToProductBox(e,a.validImage,a.validPrices,r,o);return s&&(a.validImage=null,a.validPrices=[],a.productBoxes.push(s)),a},r.prototype.getIgnoreableElements=function(){return t.flag(t.Flags.ProductBoxes.SKIP_IGNOREABLE_ELEMENTS)?t.Map.emptyMap().add("head",{}).add("script",{}).add("link",{}).add("style",{}).add("meta",{}).add("iframe",{}):t.Map.emptyMap()},r.prototype.attemptAltMainProductBox=function(e,r){var o=this,i=n.laxGenericSettings,a=document.title,s=a.split(/\W+/).join(" "),u=t.Col.ofElements(document.images).select(function(e){var n=e.alt.split(/[\W_]+/).join(" "),r=t.Common.getEditDistance(n,s),o=1-r/a.length;return{image:e,closeness:o}}),c=u.where(function(e){return e.closeness>.6}),l=c.select(function(e){return o.productImageFromIMG(e.image,i,r)}),d=l.where(function(e){return e.rect.top<=window.innerHeight}),p=e.maxBy(function(e){return e.image.area}),f=p?p.image.area:4e4,g=d.where(function(e){return e.area>f}),m=1==g.length()?this.findContainingProductBox(g.getItem(0),i,r):null;return m?(r&&console.log("alt product box",m),m):(r&&(console.log("AltProductBox failed!"),console.log("SimilarAlt",c.toArray()),console.log("aboveTheFold",d.toArray()),console.log("largerThanOthers",g.toArray())),null)},r.prototype.productImageFromIMG=function(r,o,i){var a=n.DomHelper.calculateBoxElement(r),s=a.ratio<=o.productImageMaxRatio&&a.isVisible,u=t.Common.VisualHelper.isElementInViewport(a.jqElement,0,{bottom:.5*e.$(window).height()});if(i&&!s&&console.log("Ignoring image due to bad ration / invisible",a),i&&t.flag(t.Flags.ProductBoxes.SKIP_IMAGES_NOT_IN_VIEWPORT)&&!u&&console.log("Ignoring image due to it being offscreen",a),s){var c;t.flag(t.Flags.ProductBoxes.SKIP_IMAGES_NOT_IN_VIEWPORT)?u?(c=t.Col.of(o.productImageAreas).first(function(e){return e.maxArea>a.area}),a.size=c?c.size:n.ProductImageSize.LARGE):a.size=n.ProductImageSize.INVALID:(c=t.Col.of(o.productImageAreas).first(function(e){return e.maxArea>a.area}),a.size=c?c.size:n.ProductImageSize.LARGE)}else a.size=n.ProductImageSize.INVALID;return a.alt=r.alt,a},r.prototype.tryPriceFromElement=function(e,t){if("line-through"==n.DomHelper._getStyle(e,"textDecoration"))return null;var r=e.textContent.trim(),o=r.match(this.strictPriceRx);if(o)return this.priceFromElement(e);if(0!=e.children.length){var i=new RegExp("^from"),a=r.replace(i,"");return a!=r?this.priceFromString(a,e):null}return(o=r.match(this.strictPriceRxForChildlessNodes))?this.priceFromString(o[0],e):void 0},r.prototype.priceFromElement=function(e){var t=e.textContent.trim();return this.priceFromString(t,e)},r.prototype.priceFromString=function(e,r){var o=this,i=n.knownCurrencies.first(function(n){return t.Col.of(n.patterns).any(function(t){return new RegExp(t,"gi").test(e)})});if(!i){var a,s=e.replace(/[^0-9|,|.\.]+/g,"");if(s.indexOf(",")>0){var u=s.split(",");u&&u.length>1&&u[u.length-1].length<3&&(a=Number(s.replace(",",".")))}"undefined"==typeof a&&(a=Number(s.replace(",",".")));var c=r?n.DomHelper.calculateBoxElement(r):null;return{box:c,value:a,currency:null}}for(var l,d="([\\d"+this.escapeRegExp(i.decimalSeparators)+this.escapeRegExp(i.meaninglessSeparators)+"]+)",p=new RegExp(d,"g"),f=null;null!==(l=p.exec(e));)if(l&&l.length){var g=t.Col.of(l).skip(1).where(function(e){
return!!e}).select(function(e){return o.parsePriceValueString(e)}).where(function(e){return!!e}),m=g.minBy(function(e){return e});m&&m>0&&(f=f?Math.min(m,f):m)}if(f){var c=r?n.DomHelper.calculateBoxElement(r):null;return{box:c,value:f,currency:i}}return null},r.prototype.parsePriceValueString=function(e){var n=e.match(/^(\d+[ \.,\d]*?)(?:[ \.,](\d{1,2}))?$/);if(!n||0==n.length)return t.Logger.log("Failed to parse price value for '"+e+"'"),null;var r=n[1],o=r.split(/[ ,\.]/).join(""),i=parseInt(o),a=n[2],s=a?parseFloat("0."+a):0,u=i+s;return u},r.prototype.isProductBoxValid=function(t,r,o){var i=this;t.height>e.$(window).height()&&t.productToImageRatio<150&&(t=n.DomHelper.updateBoxDimensionsToImage(t),o&&console.log("Update ProductBox dimensions",t));var a=t.height?t.height/t.image.height:0,s=t.width?t.width/t.image.width:0,u=t.prices.groupBy(function(e){return i.getActualTextSize(e.box.element).toString()});if(s<.7)return o&&console.log("Box invalid. Image width too large compared to box width",t),!1;if(s>15)return o&&console.log("Box invalid. ProductBox width too large compared to Image width",t),!1;if(a<.7)return o&&console.log("Box invalid. Image Height too large compared to box height",t),!1;if(a>8)return o&&console.log("Box invalid. ProductBox Height too large compared to Image height",t),!1;if(t.rect.height>3*e.$(window).height())return o&&console.log("Box invalid. ProductBox Height too large compared to screen height",t),!1;if(t.rect.width>e.$(window).width())return o&&console.log("Box invalid. ProductBox Width too large compared to screen width",t),!1;if(t.productToImageRatio>r.productBoxToImageMaxRatio&&s>r.productBoxToImageSingleDimensionMaxRatio&&a>r.productBoxToImageSingleDimensionMaxRatio&&s>r.productImageMaxRatio)return o&&console.log("Box invalid. Both 2D and 1D image to box ratios are bad",t),!1;var c=t.prices.distinct(function(e){return e.value.toString()});return!(c.length()>10)&&(!!u.keys().first(function(e){return parseInt(e)>=10})&&(!(t.prices.length()>3&&u.length()<2)||(o&&console.log("Box invalid. Too many prices at the same size",t),!1)))},r.prototype.tryCombineToProductBox=function(e,r,o,i,a){if(null==r||null==o||0==o.length)return null;var s=n.DomHelper.calculateBoxElement(e);return s.isVisible?(s.image=r,s.prices=t.Col.of(o),s.productToImageRatio=s.area/s.image.area,this.isProductBoxValid(s,i,a)?(s.mainText=this.resolveProductBoxText(s),s.price=this.resolvePrice(s,i,a),s.mainText?s.price?s:(a&&console.log("Box invalid. No price",s),null):(a&&console.log("Box invalid. No text",s),null)):void 0):(a&&console.log("Ignoring invisible box",e),null)},r.prototype.resolveProductBoxText=function(e){if(e.texts=this.collectProductBoxTexts(e),0==e.texts.length())return null;var t=e.image.alt&&this.resolveMainTextByAlt(e);if(t)return t;var n=this.resolveTextByStyle(e);return n?n:void 0},r.prototype.collectProductBoxTexts=function(e){var r=[];return t.StaticCol.recurseNodes(e.element,function(o,i){if(e.prices.any(function(e){return e.box.element==o}))return t.RecursionFlow.BREAK_NODE;if(3==o.nodeType){var a=o.nodeValue.trim();if(a&&a.length>5&&a.length<150){var s=a.split(" ");if(s.length>=1&&s.length<30){var u={text:a,element:o.parentNode},c=t.Common.VisualHelper.getElementPosWithOffsets(u.element);n.DomHelper.isVisible(u.element,!1)&&c.height>5&&c.width>5&&r.push(u)}}}else if(1==o.nodeType&&o.textContent&&o.attributes.href){var a=o.textContent.trim();if(a&&a.length>5&&a.length<150){var s=a.split(" ");if(s.length>=1&&s.length<30){var u={text:a,element:o.parentNode},c=t.Common.VisualHelper.getElementPosWithOffsets(u.element);n.DomHelper.isVisible(u.element)&&c.height>5&&c.width>5&&r.push(u)}}}return t.RecursionFlow.CONTINUE}),t.Col.of(r)},r.prototype.resolveTextByStyle=function(t){var n=t.texts.orderByDesc(function(t){return parseFloat(e.$(t.element).css("font-size"))}).firstOrValue(null);return n.text},r.prototype.resolveMainTextByAlt=function(e){var n=e.image.alt.replace("...",""),r=e.texts.select(function(e){var r=e.text.replace("...",""),o=Math.min(n.length,r.length);if(o<4)return{text:e.text,match:0};var i=t.Common.getEditDistance(n.substr(0,o),r.substr(0,o)),a=1-i/o;return{text:e.text,match:a}}),o=r.orderByDesc(function(e){return e.match}).firstOrValue(null);if(o&&o.match>.9){var i=e.image.alt.length>o.text.length?e.image.alt:o.text;return i}return null},r.prototype.resolvePrice=function(e,n,r){var o=this,i=e.prices.where(function(e){var n=e.box.jqElement,o=t.Col.ofInts(0,3).any(function(e){return"line-through"==n.css("text-decoration")||void(n=n.parent())});return o?(r&&console.log("Price disregarded. Has line through",e),!1):!!e.box.isVisible||(r&&console.log("Price disregarded. Invisible",e),!1)});if(0==i.length())return null;var a=i.select(function(e){return t.Pair.from(e,o.getActualTextSize(e.box.element))}).orderByDesc(function(e){return e.second}),s=a.getItem(0).second,u=a.where(function(e){return e.second/s>.9}),c=u.orderByDesc(function(e){return e.first.value}).firstOrValue(null);return c.first},r.prototype.getActualTextSize=function(n){var r=t.Col.ofElements(n.children).first(function(e){return e.textContent.trim()==n.textContent.trim()});return r?this.getActualTextSize(r):parseFloat(e.$(n).css("font-size"))},r.prototype.escapeRegExp=function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},r.prototype.scrapeByImageNaive=function(e,r,o){var i=this,a=t.Col.of(this.findElements(e,"img")).select(function(e){return i.productImageFromIMG(e,r,o)}),s=a.where(function(e){return e.size!=n.ProductImageSize.INVALID}),u=s.select(function(e){return i.findContainingProductBox(e,r,o)}).where(function(e){return!!e});return u},r.prototype.findContainingProductBox=function(e,t,n){for(var r=e.element;r.parentElement;){r=r.parentElement;var o=this.findPriceElements(r);if(o.length>0){var i=this.tryCombineToProductBox(r,e,o,t,n);return i}}return n&&console.log("Ignoring image, no containing div also contains price(s)",e),null},r.prototype.findPriceElements=function(e){var n=this,r=this,o=[];return t.StaticCol.recurseElements(e,function(e){if(e.textContent.trim().match(n.strictPriceRx)){var i=r.priceFromElement(e);return i&&i.value&&o.push(i),t.RecursionFlow.BREAK_NODE}return t.RecursionFlow.CONTINUE}),o},r.prototype.findElements=function(e,n){var r=[];return t.StaticCol.recurseElements(e,function(e){return e.tagName.toLowerCase()==n&&r.push(e),t.RecursionFlow.CONTINUE}),r},r}();n.ScraperBase=r}(n=t.ProductBoxes||(t.ProductBoxes={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){t.emptyDedicatedResult={hasDedicated:!1,wordCounts:e.Map.emptyMap(),clientPrice:{value:4294967295,currency:"",box:null},isHomepage:!1};var n=function(){function n(){}return n.tryScrpaePageByDedicated=function(r,o){var i=o.paths().dynamicContentRoot()+"/site-classification/site/"+r;return e.jqGetPromise(i).alwaysThen(function(r,i){if(i)return e.Logger.log("Failed get dedicated definition"),t.emptyDedicatedResult;if("{}"==r.trim())return e.Logger.log("Empty dedicated definition"),t.emptyDedicatedResult;try{var a=JSON3.parse(r),s=n.parsePageSchema(o,a,o.scraper());return s}catch(u){throw e.Logger.error("Dedicated failed: "+(u&&u.message)),u}})},n.parsePageSchema=function(r,o,i){var a=o.jqxgridHomepage&&o.jqxgridHomepage.some(function(e){return e.text==window.location.href}),s=t.WordUtils.getNonTrivialWords(document.title);a&&(s=[]);var u=i.queryParams(),c=[];if(o.jqxgridUrlParams)for(var l=0;l<o.jqxgridUrlParams.length;l++){var d=o.jqxgridUrlParams[l];if(d.text in u){var p=t.WordUtils.getNonTrivialWords(u[d.text]);c=c.concat(p)}}var f=i.getElementTextByReference(o.jqxgridDescription,!0),g=t.WordUtils.getNonTrivialWords(f),m=i.getElementTextByReference(o.jqxgridPrice,!1),h=this.cleanPriceString(m),v=n.getMetaTags(),y=o.chkMetaKeywords?t.WordUtils.getNonTrivialWords(v.keywords):[],C=o.chkMetaDescription?t.WordUtils.getNonTrivialWords(v.description):[],S=g.concat(s).concat(C).concat(y).concat(c),b=e.StaticCol.where(S,function(e){return!e.match(/^[\W_]*$/)}),w=t.WordUtils.countWords(b),_={hasDedicated:!0,wordCounts:w,clientPrice:h,isHomepage:a};return _},n.cleanPriceString=function(e){var t;return t=e?isNaN(e)?this.scpPriceHelper.priceFromString(e,null):{value:Number(e),currency:"",box:null}:{value:n.MAX_PRICE,currency:"",box:null}},n.getMetaTags=function(){for(var e=[],t=document.getElementsByTagName("meta"),n=0;n<t.length;n++)"keywords"==t[n].name.toLowerCase()?e.keywords=t[n].content:"description"==t[n].name.toLowerCase()&&(e.description=t[n].content);return e},n.MAX_PRICE=4294967295,n.scpPriceHelper=new e.ProductBoxes.ScraperBase,n}();t.DedicatedHelper=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t){this.virgin=!0,this.keyFunc=e,this.valueFunc=t}return e.prototype.value=function(){var e=this.keyFunc();return(this.virgin||e!=this.key)&&(this._value=this.valueFunc(),this.key=e,this.virgin=!1),this._value},e}();e.DependentSingletone=t}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(){function r(){var t=this;this._queryParams=new n.DependentSingletone(function(){return window.location.href},function(){return t.parseQueryString(window.location)}),this._documentHTML=new n.DependentSingletone(function(){return window.location.href},function(){var t="";return e.$("meta[content]").each(function(n,r){var o=e.$(r).attr("content");t+=o?o+" ":""}),t+=e.$(document.documentElement).text()})}return r.prototype.escapeRegexp=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},r.prototype.documentHTML=function(){return this._documentHTML.value()},r.prototype.queryParams=function(){return this._queryParams.value()},r.prototype.parseQueryString=function(e){for(var t=e.search.substring(1).split("&"),n=e.hash.substring(1).split("&"),o=n.concat(t),i={},a=0;a<o.length;a++){var s;try{s=decodeURIComponent(o[a])}catch(u){s=o[a]}if(s.indexOf("=")==-1)i[s]=r.VALUELESS_PARAM;else{var c=s.split("=");i[c[0]]=c[1]}}return i},r.prototype.testPatternsAgainstHTML=function(e){for(var n=0;n<e.length;n++){var r=new RegExp("(^|[^a-z|A-Z])("+e[n].pattern+")($|[^a-z|A-Z])","ig"),o=this.documentHTML().match(r),i=o?o.length:0;if(i)return t.Logger.info("Matched pattern ["+e[n].name+"]. ["+i+"] matches found"),t.Logger.info("Matches: ["+o+"]"),1}return 0},r.prototype.getElementTextByReference=function(n,o){for(var i=[function(e){return e.xpath&&r.getElementByXpath(e.xpath.trim())},function(e){return e.id&&document.querySelector("#"+e.id.trim())},function(e){return e.name&&document.getElementsByName(e.name.trim())[0]},function(e){return e["class"]&&document.querySelector("."+e["class"].trim())},function(t){return t.selector&&e.$(t.selector,document)[0]}],a="",s=0;s<n.length;s++)for(var u=n[s],c=0;c<i.length;c++)try{var l=i[c],d=l(u);if(d){if(!o)return r.getInnerText(d);a=a+r.getInnerText(d)+" "}}catch(s){t.Logger.warn("Failure in dedicated field parsing. Skipping accessor")}return a},r.findElementsContainsText=function(e,t,n){void 0===n&&(n=!1);var o=document.querySelectorAll(e);return[].filter.call(o,function(e){return n?RegExp(t,"i").test(r.getInnerText(e)):RegExp(t).test(r.getInnerText(e))})},r.getInnerText=function(e){return e.innerText||e.textContent||""},r.getElementByXpath=function(e){var t=document.evaluate&&document.evaluate(e,document,null,9,null).singleNodeValue;return t},r.prototype.getFirstMatchText=function(t,n,o){void 0===n&&(n=""),void 0===o&&(o=!1);for(var i=0;i<t.length;i++){var a=t[i]+(o?":visible":""),s=e.$(a)[0];if(s){var u=r.getInnerText(s);if(u)return u}}return n},r.prototype.getInnerTextFromElements=function(n,o){void 0===o&&(o=!1);var i=e.$(n).toArray(),a=t.Col.of(i).select(function(e){return{text:r.getInnerText(e),element:e}}).toArray();return a},r.prototype.getPhrasesFromElementsNLP=function(e){for(var n=this,o="("+t.Col.of(r.phraseDelimiters).select(function(e){return n.escapeRegexp(e)}).toArray().join("|")+")",i=new RegExp("^"+o,"g"),a=new RegExp(o+"$","g"),s=new RegExp(o,"g"),u=window.nlp_compromise,c=[],l=u.text(e),d=l.terms(),p=0;p<d.length;p++){var f=d[p];if(!(f.text.length<=2)&&f.is_word()&&f.pos.Noun){if(!r.isPhraseValid(f.text))continue;if(f.is_place()||f.is_person()||f.is_organization()||f.is_capital()||f.is_value()){var g=f.text,m=g.toLocaleLowerCase();!r.isStopWord(m)&&r.isWordValid(m)&&r.isPhraseValid(m)&&(g=g.replace(i,""),g=g.replace(a,""),g=g.replace(s,"\\$1"),c.push(g))}}}return c},r.prototype.getPhrasesFromElements=function(e){for(var n=this,o="("+t.Col.of(r.phraseDelimiters).select(function(e){return n.escapeRegexp(e)}).toArray().join("|")+")",i=new RegExp("^"+o,"g"),a=new RegExp(o+"$","g"),s=new RegExp(o,"g"),u=[],c=0;c<e.length-1;c++)if(!r.isStopWord(e[c])&&!r.isFinalWord(e[c])&&r.isWordValid(e[c])){for(var l=c,d=c+1;r.isStopWord(e[d])&&!r.isFinalWord(e[d])&&d<e.length-1&&r.isWordValid(e[d]);)d++;for(;(!r.isWordValid(e[d])||r.isStartingWord(e[d]))&&d>l;)d--;var p=e.slice(l,d+1).join(" ").trim();r.isPhraseValid(p)&&(p=p.replace(i,""),p=p.replace(a,""),p=p.replace(s,"\\$1"),u.push(p))}return u},r.prototype.getMetaStrings=function(){var t=[];return t.push(e.$('meta[property="og:description"]').attr("content")),t},r.isPhraseValid=function(e){for(var t=0;t<r.invalidPhrases.length;t++)if(e.toLocaleLowerCase()==r.invalidPhrases[t].toLocaleLowerCase())return!1;return!0},r.isWordValid=function(e){for(var t=0;t<r.invalidSigns.length;t++)if(e.indexOf(r.invalidSigns[t])!=-1)return!1;for(var t=0;t<r.invalidWords.length;t++)if(e.toLocaleLowerCase()==r.invalidWords[t].toLocaleLowerCase())return!1;return!0},r.isUpperCasePhrase=function(e){var n=e.trim().split(" ");return!t.Col.of(n).any(function(e){return e!==e.toUpperCase()})},r.isCapitalizedPhrase=function(e){var n=e.trim().split(" ");return!t.Col.of(n).any(function(e){return e.charAt(0)!==e.charAt(0).toUpperCase()})},r.isStopWord=function(e){return r.stopSearchWords.indexOf(e.toLocaleLowerCase())!=-1},r.isFinalWord=function(e){return t.Col.of(r.phraseDelimiters).any(function(t){return e.indexOf(t)==e.length-1})},r.isStartingWord=function(e){return t.Col.of(r.phraseDelimiters).any(function(t){return 0==e.indexOf(t)})},r.prototype.getElementPosWithOffsets=function(e){return n.VisualHelper.getElementPosWithOffsets(e)},r.stopSearchWords=["every","real","via","is","of","to","at","the","a","about","above","after","again","against","all","am","an","and","any","are","aren't","as","at","be","because","been","before","being","below","between","both","but","by","can't","cannot","could","couldn't","did","didn't","do","does","doesn't","doing","don't","down","during","each","few","for","from","further","had","hadn't","has","hasn't","have","haven't","having","he","he'd","he'll","he's","her","here","here's","hers","herself","him","himself","his","how","how's","i","i'd","i'll","i'm","i've","if","in","into","is","isn't","it","it's","its","itself","let's","me","more","most","mustn't","my","myself","no","nor","not","of","off","on","once","only","or","other","ought","our","ours\t","ourselves","out","over","own","same","shan't","she","she'd","she'll","she's","should","shouldn't","so","some","such","than","that","that's","the","their","theirs","them","themselves","then","there","there's","these","they","they'd","they'll","they're","they've","this","those","through","to","too","under","until","up","very","was","wasn't","we","we'd","we'll","we're","we've","were","weren't","what","what's","when","when's","where","where's","which","while","who","who's","whom","why","why's","with","won't","would","wouldn't","you","you'd","you'll","you're","you've","your","yours","yourself","yourselves","\n"],r.phraseDelimiters=[":",".","*",",",";","?","!",")","(","[","]","{","}"," ",""," ","","'","."],r.invalidWords=["news","sports","popular"],r.invalidPhrases=["view all"],r.invalidSigns=["@","#","&","-","_","|"],r.VALUELESS_PARAM="",r}();n.DefaultPageScraper=r}(n=t.Common||(t.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(t){function n(n,r,o,i,a,s){t.call(this,n.paths(),n.params(),n.extraParams,n.overrides()),this._countryCode=r,this._userSettings=o,this._suspender=i,this._iframe=a,this._scraper=new e.Common.DefaultPageScraper,this._fnWindow=window}return __extends(n,t),n.prototype.countryCode=function(){return this._countryCode},n.prototype.userSettings=function(){return this._userSettings},n.prototype.suspender=function(){return this._suspender},n.prototype.scraper=function(){return this._scraper},n.prototype.iframe=function(){return this._iframe},n.prototype.fnWindow=function(){return this._fnWindow},n.prototype.notificationParams=function(){var e=t.prototype.notificationParams.call(this);return e.hid=this.userSettings().uuid(),e},n.fromPromise=function(t,r,o,i,a){var s=e.Common.CountryHelper.getCountry(t);return e.namedWhen2({CC:s,US:r,SU:o}).then(function(e){var r=e.CC,o=e.US,s=e.SU;return new n(t,r,o,s,i,a)})},n}(t.BootstrapContext);t.ApplicationContext=n}(t=e.Context||(e.Context={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(e){function t(t,n,r){e.call(this,t,t.countryCode(),t.userSettings(),t.suspender(),t.iframe(),t.fnWindow()),this.productName=n,this.visual=r}return __extends(t,e),t.prototype.notificationParams=function(){var t=e.prototype.notificationParams.call(this);return t.pname=this.productName,t.w=this.visual.flag(),t},t}(e.ApplicationContext);e.VisualContext=t}(t=e.Context||(e.Context={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t){this.primaryCount=e,this.secondaryCount=t}return e.prototype.totalCount=function(){return this.primaryCount+this.secondaryCount},e}();e.ItemCounts=t}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(e){function t(t,n,r,o){e.call(this,t,n,o),this._logic=r}return __extends(t,e),t.prototype.logic=function(){return this._logic},t.prototype.notificationParams=function(){var t=e.prototype.notificationParams.call(this);return t.pr=this.logic().flag(),t},t}(e.VisualContext);e.LVContext=t}(t=e.Context||(e.Context={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t,n,r){void 0===r&&(r={}),this.source=e,this.context=t,this.data=n,this.extras=r}return e.prototype.hasData=function(){return this.data&&this.data.length>0},e}();e.PlainDataResult=t;var n=function(){function e(e,t){this.source=e,this.context=t}return e.prototype.hasData=function(){return!0},e}();e.StubDataResult=n;var r=function(e){function t(t,n,r,o){void 0===o&&(o={}),e.call(this,t,n),this.generator=r,this.extras=o}return __extends(t,e),t.prototype.generateLink=function(e,t){return this.generator(e,t)},t}(n);e.LinkResultGenerator=r;var o=function(e){function t(t,n,r){e.call(this,t,n),this.generator=r}return __extends(t,e),t.prototype.generateData=function(e,t,n){return this.generator(e,t,n)},t}(n);e.DataGeneratorResult=o}(t=e.Data||(e.Data={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.Shown=0]="Shown",e[e.NoShow_ZeroResults=1]="NoShow_ZeroResults",e[e.NoShow_DrawFailure=2]="NoShow_DrawFailure"}(e.DisplayState||(e.DisplayState={}));e.DisplayState}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.LEFT_PANEL=0]="LEFT_PANEL",e[e.RIGHT_PANEL=1]="RIGHT_PANEL",e[e.TOP_PANEL=2]="TOP_PANEL",e[e.BOTTOM_PANEL=3]="BOTTOM_PANEL",e[e.MAIN_TABLE=4]="MAIN_TABLE",e[e.MAIN_IMAGE=5]="MAIN_IMAGE",e[e.IMAGE_RIGHT=6]="IMAGE_RIGHT",e[e.IMAGE_INNER=7]="IMAGE_INNER",e[e.APPNEXUS_SPECIAL=8]="APPNEXUS_SPECIAL",e[e.BANNER_SQUERE=9]="BANNER_SQUERE",e[e.SEARCH_BAR=10]="SEARCH_BAR",e[e.EVERYWHERE=11]="EVERYWHERE",e[e.LIGHTBOX=12]="LIGHTBOX",e[e.NOWHERE=13]="NOWHERE",e[e.EXTERNAL_CALLBACK_1=14]="EXTERNAL_CALLBACK_1",e[e.IN_TEXT_VISUAL=15]="IN_TEXT_VISUAL"}(e.VisualRealEstate||(e.VisualRealEstate={}));e.VisualRealEstate}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function n(){this.dataSyncStore=new t.GlobalSpace("DataSync")}return n.prototype.getAll=function(){var e=this.dataSyncStore.retrive("DataItems");return e||(e={}),e},n.prototype.setAll=function(e){this.dataSyncStore.store("DataItems",e)},n.prototype.claim=function(e,t,n){void 0===n&&(n=!1);var r=this.getAll(),o=e in r;return o&&!n||(r[e]=t),this.setAll(r),o},n.prototype.cliamWithoutMarking=function(t,n,r,o){void 0===o&&(o=[]);for(var i=[],a=e.StaticCol.select(o,n),s=0;s<t.length&&!(i.length>=r);s++){var u=t[s],c=n(u),l=e.StaticCol.contains(a,c);l||i.push(u)}return i},n.prototype.claimUniques=function(t,n,r,o,i,a){void 0===i&&(i=!0),void 0===a&&(a=[]);for(var s=[],u=[],c=[],l=this.getAll(),d=e.StaticCol.select(a,n),p=0;p<t.length;p++){var f=t[p],g=n(f),m=e.StaticCol.contains(d,g);if(!m)if(g in l)u.push(f);else if(s.push(f),l[g]=r,s.length>=o)break}if(this.setAll(l),i){var h=this.cliamWithoutMarking(u,n,o-s.length,s);c=s.concat(h)}else c=s;return c},n}();t.DataSynchronizer=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.breakdownHost=function(){for(var e=document.location.host,t="weird_get_top_level_domain=cookie",n=e.split("."),r=n.length-1;r>=0;r--){var o=n.slice(r).join(".");if(document.cookie=t+";domain=."+o+";",document.cookie.indexOf(t)>-1){document.cookie=t.split("=")[0]+"=;domain=."+o+";expires=Thu, 01 Jan 1970 00:00:01 GMT;";var i=n.slice(0,r).join("."),a=n[r],s=n.slice(r+1).join(".");document.location.protocol+"//";return[i+"."+a+"."+s,a+"."+s,a]}}return[e]},n.contentWhitelistMatch=function(e,n){var r=document.location.host;return t.jqGetPromise(e+"?url="+encodeURIComponent(r)).alwaysThen(function(e,o){if(o)return t.Logger.error("Failed to check content whitelist for domain: ["+r+"] Reason: ["+o.message+"]"),0;var i=JSON3.parse(e);return i.result?(t.Logger.log("WBC for "+r+": "+i.result),n):(t.Logger.log("WBC for "+r+" was not found"),0)})},n.blackWhiteMatch=function(e,r,o,i){var a={};return null!=r&&(a.white=t.jqGetPromise(r,3e3)),null!=o&&(a.black=t.jqGetPromise(o,3e3)),t.namedWhen2(a).then(function(r){for(var o=("white"in r?n.parseBloomFromResponse(r.white):null),a=("black"in r?n.parseBloomFromResponse(r.black):null),s=t.resolve({match:null,score:0}),u=0;u<e.length;u++){var c=e[u].toLowerCase(),l=n.createTestMatchClosure(o,a,i,c);s=s.then(l)}return s.logPassthrough("bw result")})},n.blackWhiteWeakMatch=function(r,o,i){if(void 0===i&&(i=null),i.params().isStandAlone&&i.params().standaloneBloomArray&&i.params().standaloneBloomArray.length>0){var a=new e.BloomFilter(i.params().standaloneBloomArray,10),s=n.testBloomResponse(a,r);return t.resolve(s)}return t.jqGetPromise(o,3e3).then(function(e){var o=n.parseBloomFromResponse(e),i=n.testBloomResponse(o,r);return t.resolve(i)})},n.testBloomResponse=function(e,t){for(var n=0,r=[],o=0;o<t.length;o++){var i=t[o].toLowerCase(),a=e&&e.test(i);a&&(r.push(i),n++)}return{match:r,score:n}},n.parseBloomFromResponse=function(t){var n=t.match(/\[.*\]/)[0],r=JSON3.parse(n);return new e.BloomFilter(r,10)},n.createTestMatchClosure=function(e,r,o,i){return function(a){return 0==a.score?n.testMatch(e,r,o,i):t.resolve(a)}},n.testMatch=function(e,n,r,o){var i=e&&e.test(o),a=n&&n.test(o);if(r&&(i||a)){var s=r+encodeURIComponent(o);return t.jqGetPromise(s).then(function(e){var n=JSON3.parse(e),r="found"in n?n.found?2:-1:0;return r&&t.Logger.log("WBL for "+o+": "+r),{match:o,score:r}})}return i?t.resolve({match:o,score:1}):a?t.resolve({match:o,score:-1}):t.resolve({match:o,score:0})},n}();n.BlackWhiteListHelper=r}(n=t.Common||(t.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){e.sliderStrings=[{key:"deals_header",en:"Related Products",tr:"Dier Frsatlara",fr:"Super offres",de:"Top-Schnppchen",it:"Offerte speciali",es:"Grandes ofertas",ru:" ",pt:"Ofertas Incrveis",pl:"Gorce oferty",ja:"Related Products",nl:"Populaire deals",sv:"Heta erbjudanden",da:"Fantastiske tilbud",he:" ",ar:" "},{key:"coupons_header",en:"Best Coupons",tr:"En yi Kuponlar",fr:"Meilleurs coupons",de:"Beste Gutscheine",it:"Coupon migliori",es:"Mejores cupones",ru:" ",pt:"Melhores Cupons",pl:"Najlepsze kupony",ja:"Best Coupons",nl:"Beste coupons",sv:"Bsta kuponger",da:"Bedste kuponer",he:"",ar:" "},{key:"campaigns_header",en:"Special Offers",tr:"Special Offers",fr:"Special Offers",de:"Special Offers",it:"Special Offers",es:"Special Offers",ru:"Special Offers",pt:"Special Offers",pl:"Special Offers",ja:"Special Offers",nl:"Special Offers",sv:"Special Offers",da:"Special Offers",he:"Special Offers",ar:"Special Offers"},{key:"coupons_tab",en:"Coupons",tr:"Kuponlar",fr:"Coupons",de:"Gutscheine",it:"Coupon",es:"Cupones",ru:"",pt:"Cupons",pl:"Kupony",ja:"Coupons",nl:"Coupons",sv:"Kuponger",da:"Kuponer",he:"",ar:""},{key:"campaigns_tab",en:"Offers",tr:"Teklifler",fr:"Offers",de:"Offers",it:"Offers",es:"Offers",ru:"Offers",pt:"Offers",pl:"Offers",ja:"Offers",nl:"Offers",sv:"Offers",da:"Offers",he:"Offers",ar:"Offers"},{key:"deals_tab",en:"Deals",tr:"Frsatlar",fr:"Offres",de:"Angebote",it:"Offerte",es:"Ofertas",ru:"",pt:"Ofertas",pl:"Oferty",ja:"Deals",nl:"Deals",sv:"erbjudanden",da:"Tilbud",he:"",ar:""},{key:"deals_header2",en:"Best Value",tr:"En yi Frsatlar",fr:"Meilleur offre",de:"Beste",it:"Offerta migliore",es:"Mejor oferta",ru:"",pt:"Melhor oferta",pl:"Najlepsze oferty",ja:"Best Value",nl:"Beste deal",sv:"Bsta erbjudanden",da:"Bedste tilbud",he:" ",ar:" "},{key:"travels_header",en:"Hotels",tr:"Oteller",fr:"htels",de:"Hotels",it:"Hotel",es:"Hoteles",ru:"",pt:"hotis",pl:"Hotele",ja:"Hotels",nl:"hotels",sv:"hotell",da:"hoteller",he:" ",ar:""},{key:"travels_tab",en:"Travel",tr:"seyahat",fr:"Voyage",de:"Reise",it:"Viaggiare",es:"Viajar",ru:"",pt:"Viagem",pl:"podr",ja:"Travel",nl:"reizen",sv:"Resa",da:"Rejser",he:"",ar:""},{key:"free_shipping",en:"Free Shipping",tr:"cretsiz Kargo",fr:"Port gratuit",de:"Gratisversand",it:"Spedizione gratuita",es:"Envo gratis",ru:" ",pt:"Frete grtis",pl:"Darmowa dostawa",ja:"Free Shipping",nl:"Gratis verzending",sv:"Gratis frakt",da:"Gratis forsendelse",he:" ",ar:" "},{key:"click_here",en:"Click Here",tr:"Buraya Tklayn",fr:"Cliquez ici",de:"Hier klicken",it:"Clicca qui",es:"Haz clic aqu",ru:" ",pt:"Clique aqui",pl:"Kliknij tutaj",ja:"Click Here",nl:"Klik hier",sv:"Klicka hr",da:"Klike her",he:" ",ar:" "},{key:"get_code",en:"Get Code",tr:"Kodu Al",fr:"Recevoir le code",de:"Code erhalten",it:"Ricevi codice",es:"Obtener cdigo",ru:" ",pt:"Obter cdigo",pl:"Otrzymaj kod",ja:"Get Code",nl:"Krijg code",sv:"Hmta kod",da:"Hent kode",he:" ",ar:"  "},{key:"see_more",en:"See more",tr:"Daha fazla",fr:"Voir plus",de:"Mehr erfahren",it:"Vedi altro",es:"Ver ms",ru:". ",pt:"Ver mais",pl:"Zobacz wicej",ja:"See more",nl:"Meer info",sv:"Visa mer",da:"Se mere",he:" ",ar:" "},{key:"more_deals",en:"Compare Prices",tr:"Dier Frsatlara Git",fr:"Recevoir plus d'offres",de:"Mehr Schnppchen erhalten",it:"Ricevi altre offerte",es:"Obtener ms ofertas",ru:"  ",pt:"Receba mais ofertas",pl:"Otrzymaj wicej ofert",ja:"Compare Prices",nl:"Krijg meer deals",sv:"Hmta fler erbjudanden",da:"F flere tilbud",he:" ",ar:"    "},{key:"more_deals2",en:"Compare Prices",tr:"Dier Frsatlar Gr",fr:"Recevoir plus d'offres",de:"Mehr Schnppchen erhalten",it:"Ricevi altre offerte",es:"Obtener ms ofertas",ru:"  ",pt:"Receba mais ofertas",pl:"Otrzymaj wicej ofert",ja:"Compare Prices",nl:"Krijg meer deals",sv:"Hmta fler erbjudanden",da:"F flere tilbud",he:" ",ar:"    "},{key:"buy",en:"Read More",tr:"Satn Al",fr:"Acheter maintenant",de:"Jetzt kaufen",it:"Compra ora",es:"Comprar ahora",ru:" ",pt:"Compre j",pl:"Kup teraz",ja:"Read More",nl:"Koop nu",sv:"Kp nu",da:"Kb nu",he:" ",ar:" "},{key:"attribution1",en:"Powered by",tr:"desteiyle",fr:"Optimis par",de:"Untersttzt von",it:"Powered by",es:"Tecnologa de",ru:"  ",pt:"Desenvolvido por",pl:"Wspierane przez",ja:"Ads by",nl:"Geleverd door",sv:"Drivs av",da:"Drevet af",he:"Powered by",ar:" "},{key:"attribution2",en:"Brought by",tr:"gvencesiyle",fr:"Fourni par",de:"Prsentiert von",it:"Offerto da",es:"Ofrecido por",ru:"",pt:"Trazido por",pl:"Przedstawia",ja:"Brought by",nl:"Gebracht door",sv:"Levererat av",da:"Udviklet af",he:"Brought by",ar:"  "},{key:"obr_attribution",en:"Recommended by",tr:"Recommended by",fr:"Recommended by",de:"Recommended by",it:"Recommended by",es:"Recommended by",ru:"Recommended by",pt:"Recommended by",pl:"Recommended by",ja:"Recommended by",nl:"Recommended by",sv:"Recommended by",da:"Recommended by",he:"Recommended by",ar:"Recommended by"},{key:"click_to_use",en:"Get Coupon",tr:"Kupon Al",fr:"Recevoir le coupon",de:"Gutschein erhalten",it:"Ottieni coupon",es:"Obtener cupn",ru:" ",pt:"Obter cupom",pl:"Otrzymaj kupon",ja:"Get Coupon",nl:"Krijg coupon",sv:"Hmta kupong",da:"Hent kupon",he:" ",ar:"  "},{key:"black_friday_deals",en:"Black friday <b>deals</b>",tr:"Black friday <b>deals</b>",fr:"Spcial",de:"Heie Angebote",it:"Speciale",es:"Ofertas calientes",ru:" ",pt:"Ofertas quentes",pl:"Gorce oferty",ja:"Black friday <b>deals</b>",nl:"",sv:"",da:"",he:"",ar:""},{key:"copy_paste_failed",en:"Copy/Paste code to use at Checkout",tr:"Kopyala / Yaptr kodu kullanmak iin",fr:"Copier/Coller le code  utiliser lors du paiement",de:"Code kopieren und bei Abschluss der Bestellung einfgen",it:"Copia/incolla codice da usare alla cassa",es:"Copiar/pegar cdigo y usar al pagar",ru:"/     ",pt:"Copie/Cole cdigo e use no Checkout",pl:"Kopiuj/Wklej kod do wykorzystania przy kasie",ja:"Copy/Paste code to use at Checkout",nl:"Kopieer/plak code bij het afrekenen",sv:"Kopiera/klistra in kod att anvnda i kassan",da:"Kopier/st ind koden, der skal bruges ved betaling",he:"     ",ar:" /   "},{key:"click_to_copy",en:"Click to copy",tr:"Kopyalamak iin tklayn",fr:"Cliquez pour copier",de:"Klicken Sie auf die zu kopier",it:"Clicca per copiare",es:"Haga clic para copiar",ru:",  ",pt:"Clique para copiar",pl:"Kliknij, aby skopiowa",ja:"Click to copy",nl:"Klik om te kopiren",sv:"Klicka fr att kopiera",da:"Klik for at kopiere",he:" ",ar:" "},{key:"copy_paste",en:"Copied",tr:"kopyalanan",fr:"copi",de:"kopiert",it:"Copiato",es:"copiado",ru:"",pt:"copiado",pl:"skopiowane",ja:"Copied",nl:"gekopieerde",sv:"kopieras",da:"kopieret",he:"",ar:""},{key:"click_coupon",en:"Click to get the Coupon",tr:"Kupon almak iin tklayn",fr:"Cliquer pour recevoir le coupon",de:"Klicken, um Gutschein zu erhalten",it:"Clicca per ricevere il coupon",es:"Haz clic para obtener cupn",ru:"   ",pt:"Clique para obter o cupom",
pl:"Kliknij, by otrzyma kupon",ja:"Click to get the Coupon",nl:"Klik om de coupon te krijgen",sv:"Klicka fr att hmta kupong",da:"Klik for at hente kuponen",he:"  ",ar:"   "},{key:"more_deals_short",en:"Compare Prices",tr:"Dier Frsatlara Git",fr:"Voir plus d'offres",de:"Mehr Angebote",it:"Trova offerte",es:"Ver ms",ru:". ",pt:"Veja mais ofertas",pl:"Zobacz wicej",ja:"Compare Prices",nl:"Krijg meer deals",sv:"Hmta fler erbjudanden",da:"",he:"",ar:""},{key:"cyber_monday_deals",en:"Cyber Monday <b>deals</b>",tr:"Cyber Monday <b>deals</b>",fr:"Spcial",de:"Heie Angebote",it:"Speciale",es:"Ofertas calientes",ru:" ",pt:"Ofertas quentes",pl:"Gorce oferty",ja:"Cyber Monday <b>deals</b>",nl:"",sv:"",da:"",he:"",ar:""},{key:"mature_deals_header",en:"Sexy Deals",tr:"Sexy Deals",fr:"",de:"",it:"",es:"",ru:"",pt:"",pl:"",ja:"Sexy Deals",nl:"",sv:"",da:"",he:"",ar:""},{key:"visit_store",en:"Visit Store",tr:"Ziyaret maazas",fr:"Acheter maintenant",de:"Jetzt kaufen",it:"Compra ora",es:"Comprar ahora",ru:" ",pt:"Compre j",pl:"Kup teraz",ja:"Visit Store",nl:"Koop nu",sv:"Kp nu",da:"Kb nu",he:" ",ar:" "},{key:"more",en:"More",tr:"More",fr:"More",de:"More",it:"More",es:"More",ru:"More",pt:"More",pl:"More",ja:"More",nl:"More",sv:"More",da:"More",he:"",ar:"More"},{key:"we_found",en:"We found",tr:"Biz denemek iin",fr:"Nous avons trouv",de:"Wir haben",it:"Abbiamo trovato",es:"Encontramos",ru:" ",pt:"Encontrmos",pl:"Znalelimy",ja:"We found",nl:"We hebben",sv:"Vi hittade",da:"Vi fandt",he:"",ar:" "},{key:"codes_to_try",en:"codes to try",tr:"kodlar bulundu",fr:"codes pour essayer",de:"-Codes, um zu versuchen",it:"codici per provare",es:"cdigos para tratar",ru:",  ",pt:"cdigos para tentar",pl:"kodw, aby sprbowa",ja:"codes to try",nl:"codes te proberen",sv:"koder fr att frska",da:"koder at prve",he:" ",ar:"  "},{key:"try_codes",en:"Try codes",tr:"kodlar deneyin",fr:"Essayez codes",de:"Versuchen Codes",it:"Prova codici",es:"Trate de cdigos",ru:" ",pt:"tente cdigos",pl:"Sprbuj kody",ja:"Try codes",nl:"Probeer codes",sv:"Frsk koder",da:"Prv koder",he:" ",ar:" "},{key:"go_back_to_coupons",en:"Go back to coupons",tr:"Kuponlar geri dn",fr:"Retour  coupons",de:"Zurck zum Gutscheine",it:"Torna tagliandi",es:"Volver a los cupones",ru:"  ",pt:"Voltar para cupons",pl:"Wr do kuponw",ja:"Go back to coupons",nl:"Ga terug naar coupons",sv:"G tillbaka till kuponger",da:"Tilbage til kuponer",he:" ",ar:"  "},{key:"cpnwiz_no_results",en:"Sorry, We haven't found any valid coupon code",tr:"Maalesef, biz herhangi bir geerli kupon kodunu bulamadm.",fr:"Dsol, nous avons pas trouv de code promo valide.",de:"Sorry, wir haben keine gltige Gutscheincode zu finden.",it:"Siamo spiacenti, ma non abbiamo trovato nessun codice coupon valido.",es:"Lo sentimos, no hemos encontrado ningn cdigo de descuento vlido.",ru:" ,       .",pt:"Desculpe, No encontramos qualquer cdigo de cupom vlido.",pl:"Przepraszamy, nie znalazem adnego poprawny kod kuponu.",ja:"Sorry, We haven't found any valid coupon code",nl:"Sorry, we hebben nog niet over een geldige coupon code.",sv:"Tyvrr, vi har inte hittat ngon giltig kupongkod.",da:"Beklager, vi har ikke fundet nogen gyldig kuponkode.",he:",     ",ar:"       ."},{key:"coupon_code",en:"Coupon code:",tr:"Kupon Kodu:",fr:"Code promo:",de:"Gutscheincode:",it:"Codice coupon:",es:"Cdigo promocional:",ru:" :",pt:"Cdigo do cupom:",pl:"Kod kuponu:",ja:"Coupon code:",nl:"Coupon code:",sv:"Kupongskod:",da:"Kuponkode:",he:" :",ar:" :"},{key:"processing",en:"Processing: ",tr:"ileme:",fr:"traitement:",de:"Verarbeitung:",it:"Lavorazione:",es:"Procesamiento:",ru:":",pt:"processamento:",pl:"przetwarzanie:",ja:"Processing: ",nl:"verwerking:",sv:"bearbetning:",da:"Behandler:",he:":",ar:":"},{key:"we_saved_you",en:"We saved you ",tr:"Sizi kurtard",fr:"Nous vous sauvs",de:"Wir retteten Sie",it:"Vi salvato",es:"Le ahorramos",ru:"  ",pt:"Ns te salvou",pl:"Mamy ci ocalia",ja:"We saved you ",nl:"We je gered",sv:"Vi rddade dig",da:"Vi frelst dig",he:"  ",ar:" "},{key:"we_applied_coupon",en:"We applied this coupon for you: ",tr:"Biz sizin iin bu kupon uygulamal:",fr:"Nous avons appliqu ce coupon pour vous:",de:"Wir wendeten diesen Coupon fr Sie:",it:"Abbiamo applicato questo coupon per voi:",es:"Hemos aplicado este cupn para usted:",ru:"     :",pt:"Ns aplicamos este cupom para voc:",pl:"Zastosowalimy ten kupon dla Ciebie:",ja:"We applied this coupon for you: ",nl:"We pasten deze coupon voor u:",sv:"Vi tillmpat denna kupong fr dig:",da:"Vi anvendte denne kupon for dig:",he:"    :",ar:"   :"},{key:"content_slider_title",en:"From Around The Web",tr:"Web Drt Bir Yanndan Gelen",fr:"De Autour du Web",de:"Aus dem Web",it:"Da tutto il web",es:"De toda la web",ru:"  ",pt:"De todo o web",pl:"Z internetu",ja:"From Around The Web",nl:"Van Around The Web",sv:"Frn webben",da:"Fra nettet",he1:" ",he:"   ",ar:"    "},{key:"deals_for_you",en:"We've Got Deals For You",fr:"Des offres exclusives ",de:"Unsere Angebote fr Sie",it:"Abbiamo delle offerte per te"},{key:"deals_available",en:"All the deals you want are available for you ",fr:"Pour consulter toutes nos offres disponibles ",de:"Alle gewnschten Angebote sind hier verfgbar ",it:"Tutte le offerte che vorresti sono disponibili qui "},{key:"click_here",en:"Click Here  ",fr:"Cliquez ici  ",it:"clicca qui "},{key:"push_premission_message",en:"We'd like to show you notifications for the latest news and updates.",tr:"Size en yeni haberler ve gncellemeler iin bildirimler gstermek istiyoruz.",fr:"Nous aimerions vous montrer des notifications pour les dernires nouvelles et mises  jour.",de:"Wir mchten Ihnen Benachrichtigungen fr die neuesten Nachrichten und Updates zeigen.",it:"Vorremmo mostrarti le notifiche per le ultime notizie e aggiornamenti.",es:"Nos gustara mostrarle notificaciones de las ltimas noticias y actualizaciones.",ru:"         .",pt:"Queremos mostrar suas notificaes para as ltimas novidades e atualizaes.",pl:"Chcemy wywietla powiadomienia o nowociach i aktualizacjach.",ja:"",nl:"We willen u meldingen laten zien voor het laatste nieuws en updates.",he:"     "},{key:"push_allow",en:"Allow",tr:"zin vermek",fr:"Permettre",de:"ermglichen",it:"permettere",es:"Permitir",ru:"",pt:"permitir",pl:"Dopuszcza",nl:"Toestaan",he:""},{key:"push_block",en:"No Thanks",tr:"Hayr teekkrler",fr:"Non merci",de:"Nein Danke",it:"No grazie",es:"No, gracias",ru:" ",pt:"No, obrigado",pl:"Nie, dzikuj",nl:"Nee, dank u wel",he:""}]}(t=e.Locale||(e.Locale={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){!function(e){e[e.en=0]="en",e[e.es=1]="es",e[e.he=2]="he",e[e.fr=3]="fr",e[e.de=4]="de",e[e.pt=5]="pt",e[e.it=6]="it"}(n.LanguageCode||(n.LanguageCode={}));var r=n.LanguageCode,o=function(){function o(){}return o.getLanguagesForCountry=function(e,n){void 0===n&&(n="en");var r=o.countryLanguages[e.toUpperCase()];return t.StaticCol.contains(r,n)||r.push(n),r},o.getLanguageStrings=function(e){var n=t.StaticCol.toHashmap(t.Locale.sliderStrings,function(e){return e.key});return t.StaticCol.hashSelect(n,function(t){return t[e]})},o.getStringMapForCountry=function(e,n,r){void 0===r&&(r="en");var i=o.getLanguagesForCountry(e,r),a=t.StaticCol.toHashmap(n,function(e){return e.key});return t.StaticCol.hashSelect(a,function(e){return t.Col.of(i).selectFirst(function(t){return e[t]},function(e){return e&&e.length>0})})},o.getSiteLanguageCode=function(){var t=document.documentElement.lang||document.body.lang||document.head.lang||e.$('meta[http-equiv="content-language"]').first().attr("content")||e.$('meta[property="og:locale"]').first().attr("content")||"";return t&&(t=t.split(/[_-]+/)[0]),r[t]},o.detectSiteLanguage=function(e){return n.VersionSingletone.perform(e.host(),function(){return o.detectSiteLanguageInner(e)})},o.detectSiteLanguageInner=function(r){return n.Res.injectScript(r.paths().outerResourcesRoot()+"/_languageData.js").then(function(){return t.waitFor(function(){return window._languageData},2e3,50)}).then(function(){return n.Res.injectScript(r.paths().outerResourcesRoot()+"/guessLanguage.js")}).then(function(){return t.waitFor(function(){return window.guessLanguage},2e3,50)}).then(function(n){for(var o=document.title.trim(),i=["h1","h2","h3"],a=0;a<i.length&&o.length<400;a++)e.$(i[a]).map(function(t,n){o+=" "+e.$(n).text()}),o=o.replace(/\s\s+/g," ");return t.promiseFromCallback(function(e){return n.detect(o,e)}).then(function(e){return t.Logger.info("Detected language: ["+e+"]"),r.language=e,e})})},o.countryLanguages={AF:["ps","uz","tk"],AX:["sv"],AL:["sq"],DZ:["ar"],AS:["en","sm"],AD:["ca"],AO:["pt"],AI:["en"],AQ:[],AG:["en"],AR:["es","gn"],AM:["hy","ru"],AW:["nl","pa"],AU:["en"],AT:["de"],AZ:["az","hy"],BS:["en"],BH:["ar"],BD:["bn"],BB:["en"],BY:["be","ru"],BE:["nl","fr","de"],BZ:["en","es"],BJ:["fr"],BM:["en"],BT:["dz"],BO:["es","ay","qu"],BQ:["nl"],BA:["bs","hr","sr"],BW:["en","tn"],BV:[],BR:["pt"],IO:["en"],VG:["en"],BN:["ms"],BG:["bg"],BF:["fr","ff"],BI:["fr","rn"],KH:["km"],CM:["en","fr"],CA:["en","fr"],CV:["pt"],KY:["en"],CF:["fr","sg"],TD:["fr","ar"],CL:["es"],CN:["zh"],CX:["en"],CC:["en"],CO:["es"],KM:["ar","fr"],CG:["fr","ln"],CD:["fr","ln","kg","sw","lu"],CK:["en"],CR:["es"],HR:["hr"],CU:["es"],CW:["nl","pa","en"],CY:["el","tr","hy"],CZ:["cs","sk"],DK:["da"],DJ:["fr","ar"],DM:["en"],DO:["es"],EC:["es"],EG:["ar"],SV:["es"],GQ:["es","fr"],ER:["ti","ar","en"],EE:["et"],ET:["am"],FK:["en"],FO:["fo"],FJ:["en","fj","hi","ur"],FI:["fi","sv"],FR:["fr"],GF:["fr"],PF:["fr"],TF:["fr"],GA:["fr"],GM:["en"],GE:["ka"],DE:["de"],GH:["en"],GI:["en"],GR:["el"],GL:["kl"],GD:["en"],GP:["fr"],GU:["en","ch","es"],GT:["es"],GG:["en","fr"],GN:["fr","ff"],GW:["pt"],GY:["en"],HT:["fr","ht"],HM:["en"],VA:["it","la"],HN:["es"],HK:["zh","en"],HU:["hu"],IS:["is"],IN:["hi","en"],ID:["id"],CI:["fr"],IR:["fa"],IQ:["ar","ku"],IE:["ga","en"],IM:["en","gv"],IL:["en","he","ar"],IT:["it"],JM:["en"],JP:["ja"],JE:["en","fr"],JO:["ar"],KZ:["kk","ru"],KE:["en","sw"],KI:["en"],KW:["ar"],KG:["ky","ru"],LA:["lo"],LV:["lv"],LB:["ar","fr"],LS:["en","st"],LR:["en"],LY:["ar"],LI:["de"],LT:["lt"],LU:["fr","de","lb"],MO:["zh","pt"],MK:["mk"],MG:["fr","mg"],MW:["en","ny"],MY:[],MV:["dv"],ML:["fr"],MT:["mt","en"],MH:["en","mh"],MQ:["fr"],MR:["ar"],MU:["en"],YT:["fr"],MX:["es"],FM:["en"],MD:["ro"],MC:["fr"],MN:["mn"],ME:["sr","bs","sq","hr"],MS:["en"],MA:["ar"],MZ:["pt"],MM:["my"],NA:["en","af"],NR:["en","na"],NP:["ne"],NL:["nl"],NC:["fr"],NZ:["en","mi"],NI:["es"],NE:["fr"],NG:["en"],NU:["en"],NF:["en"],KP:["ko"],MP:["en","ch"],NO:["no","nb","nn"],OM:["ar"],PK:["en","ur"],PW:["en"],PS:["ar"],PA:["es"],PG:["en"],PY:["es","gn"],PE:["es"],PH:["en"],PN:["en"],PL:["pl"],PT:["pt"],PR:["es","en"],QA:["ar"],XK:["sq","sr"],RE:["fr"],RO:["ro"],RU:["ru"],RW:["rw","en","fr"],BL:["fr"],SH:["en"],KN:["en"],LC:["en"],MF:["fr"],PM:["fr"],VC:["en"],WS:["sm","en"],SM:["it"],ST:["pt"],SA:["ar"],SN:["fr"],RS:["sr"],SC:["fr","en"],SL:["en"],SG:["en","ms","ta","zh"],SX:["nl","en","fr"],SK:["sk"],SI:["sl"],SB:["en"],SO:["so","ar"],ZA:["af","en","nr","st","ss","tn","ts","ve","xh","zu"],GS:["en"],KR:["ko"],SS:["en"],ES:["es","eu","ca","gl","oc"],LK:["si","ta"],SD:["ar","en"],SR:["nl"],SJ:["no"],SZ:["en","ss"],SE:["sv"],CH:["de","fr","it"],SY:["ar"],TW:["zh"],TJ:["tg","ru"],TZ:["sw","en"],TH:["th"],TL:["pt"],TG:["fr"],TK:["en"],TO:["en","to"],TT:["en"],TN:["ar"],TR:["tr"],TM:["tk","ru"],TC:["en"],TV:["en"],UG:["en","sw"],UA:["uk"],AE:["ar"],GB:["en"],US:["en"],UM:["en"],VI:["en"],UY:["es"],UZ:["uz","ru"],VU:["bi","en","fr"],VE:["es"],VN:["vi"],WF:["fr"],EH:["es"],YE:["ar"],ZM:["en"],ZW:["en","sn","nd"]},o}();n.LocaleHelper=o}(n=t.Common||(t.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.None=0]="None",e[e.Commerce=1]="Commerce",e[e.Travel=2]="Travel"}(e.VerticalType||(e.VerticalType={}));e.VerticalType}(t=e.Vertical||(e.Vertical={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){!function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(n.RibbonSize||(n.RibbonSize={}));var r=n.RibbonSize;!function(e){e[e.Large=300]="Large",e[e.Medium=189]="Medium",e[e.Small=99]="Small"}(n.ImageMinHeight||(n.ImageMinHeight={}));var o=n.ImageMinHeight,i=function(){function i(){}return i.getProductImage=function(){var t=new e.NWPLegacy;return t.ImageUtils.getLargestImage()},i.getFirstEcommerceImage=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);var n=i.getAllEcommerceImages(e,t,!1);return n.length>0?n[0]:null},i.distanceFromViewPortCenter=function(t){var n=e.$(t),r={X:e.$(window).width()/2,Y:e.$(window).height()/2},o=n.offset();o.left+=n.width()/2,o.top+=n.height()/2;var i=r.X-o.left;i*=i;var a=r.Y-o.top;return a*=a,Math.sqrt(i+a)},i.getAllEcommerceImages=function(r,o,i){var a=t.Col.ofElements(document.images).where(function(t){var i=e.$(t);return!(r&&!i.is(":visible"))&&(!(o&&!n.VisualHelper.isElementInViewport(i,.9))&&!(i.hasClass("fo-offer-img")||!n.ImageUtils.isImageValid(i[0])))});return i&&(a=a.stableSort(function(e,t){return t.height-e.height})),a.toArray()},i.findValidImagesBySize=function(o,i,a){var s=t.Col.ofElements(document.images).where(function(t){var r=e.$(t);return!(!r.is(":visible")||r.hasClass("fo-offer-img")||!n.ImageUtils.isImageValid(r[0]))&&(!a||n.VisualHelper.isElementInViewport(r,.9))});return s=s.stableSort(function(e,t){return t.height-e.height}),s.length()>0?(this.imageSizeToRibbonSize(s.getItem(0).height)==r.Large&&(o=0),s.skip(o).take(i).toArray()):[]},i.imageSizeToRibbonSize=function(e){return e>=o.Large?r.Large:e>=o.Medium?r.Medium:r.Small},i.getLargestImageText=function(){var t=new e.NWPLegacy,n=t.ImageUtils.getLargestImage(),r=n?t.utils.getImgText(n,5):null;return r&&(r=i.removeStopWords(r)),r},i.getImageText=function(n){var r=new e.NWPLegacy;try{var o=n?r.utils.getImgText(n,5):null;return o&&(o=i.removeStopWords(o)),o}catch(a){return t.Logger.error("Failure in getImageText: "+a.message),""}},i.isImageValid=function(e){var t=i.imageHasStandardEcommerceDimensions(e)&&i.isImageExtensionValid(e)&&!i.imageHasClickableAreas(e)&&!i.imageIsPartOfCarussel(e);return t},i.imageIsPartOfCarussel=function(t){return e.$(t).parents("[data-role='slider']").length>0},i.imageHasStandardEcommerceDimensions=function(e){var t=4200,n=.45,r=2.1,o=e.width,i=e.height;if(o*i<t)return!1;var a=o/i;return!(a<n||a>r)},i.isImageExtensionValid=function(e){var t="";try{t=e.src.toLowerCase()}catch(n){return!1}var r=t.indexOf("?");if(r!=-1&&(t=t.substring(0,r)),t.length<4)return!1;var o=t.substring(t.length-4,t.length);return"."!=t.charAt(t.length-4)||".gif"!=o&&".png"!=o},i.imageHasClickableAreas=function(e){return!!e.getAttribute("usemap")},i.removeStopWords=function(e){for(var t=["by","-","of","for","in","a","the","at","is","with","to","this","and","usd","eur","br","product","details"],n=0;n<t.length;n++){var r="\\s+("+t[n]+")\\s+",o=new RegExp(r,"g");e=(" "+e+" ").replace(o," ")}return e=e.trim()},i}();n.ImageUtils=i}(n=t.Common||(t.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.LanguageCommercePhrases={da:[{name:"ecommerce",pattern:"kurven|returnering|kategorier|butik|mine produkter|bedste pris|kb|kurv|tilbud|indkbskurv|kbsguide til"}],de:[{name:"ecommerce",pattern:"alle marken|stbern in kategorien|wunschliste|heiesten angebote|deinwarenkorb|geschenkefinder|beliebte produkte|kaufberatung|preisvergleich|einkaufswagen|warenkorb|auf lager|versandkosten|wunsch zettel|gratisversand|gratis rcksendung|sofort(-s)kaufen|einkauf(en|sliste|s-wagen|s-tasche)|express-(zustellung|lieferung)|(meine|kostenfreie|standard) lieferung|24-stunden-lieferung|speditionslieferung|lieferstatus|lieferzeit|versand|mwst|bestellen|bestellung|wunschzettel|merkzettel|gutschein|geschenkkarte|widerruf|zur kasse gehen|warenkorb|einkaufswagen|einkaufstasche|meine einkaufstasche|kostenlosem versand|gratis versand|bestseller|bestsellers|bestellung|in den einkaufswagen|in den warenkorb|in die einkaufstasche|zur einkaufstasche|erffnen|kaufen|ankauf|angebote|gutscheine|verkaufen|einkaufswagen|einkaufstasche gelegt|wunschzettel|merkzettel|wunschliste|lieferung|lieferung verfolgen|bestellung anzeigen|geschenkverpackung|zur kasse gehen|zur kasse|rckversand|versandkosten|rcksendung|online kaufen|geschenk-gutscheine|geschenk|gutscheine|artikel merken|auf die wunschliste|weitershoppen|weiter einkaufen|rabatte|produktinformationen|versandkosten|sichere zahlung"}],en:[{name:"ecommerce",pattern:"(add\\s?(item)?\\s?to\\s?(my)?\\s?(shopping|digital)?\\s?(cart\b|bag\b|basket|order))|(my|your|view|show) (\bcart\b|shopping) (\bcart\b|\btrolley\b|\bbag\b|\bbasket\b|categories)|view all brands|shop by (brand|department(s)?|categor(y|ies))|(shop|buy) now|in stock|shipping (time|info|cost(s)?|charges|policy|options)|(free|no anxiety) shipping|(refund|return) policy|(my|your) order(s)?|order(s)? status|(shopping|buying) guide|(fast|ontime) delivery|store locat(ion(s)?|or)|(continue|start|safe|secure|no minimum) shopping|gift voucher|bulk orders|cash purchase|cash on delivery|replacement (guarantee|options)|money back guaranty|my shopping alert|wish list"}],es:[{name:"ecommerce",pattern:"mis pedidos|compra online|cesta de la compra|lista dedeseos|tarifas y polticas de envoi|envo libre|mi compra(s)?|iniciar compra(s)?|cambio gratis|gastos de envio|gastos de envoi|ideas para regalar|ofertas destacadas|panier|envo gratis|tu bolsa|bolsa de compras|plazos de entrega|a carrito|(mi|al) carrito|listas de regalos|comprar ya en 1-clic|(tu|mi|ir|la|a) cesta|ver carrito|lista de (favoritos|deseos|productos)|mi boisa|cheques regalo|seguir mi pedido|entrega gratuita|entrega y devoluciones"}],fr:[{name:"ecommerce",pattern:"panier|(mon|votre) sac|liste d'envies|livraison (gratuite|offerte)|livraison  domicile sur rendez-vous|je retourne par la poste|disponible sous|(retours ou |reprise ou a)change gratuit|expdition (gratuite|libre)|la livraison gratuite|les dlais de livraison|carte cadeau|bons de reduction|commandez maintenant|acheter moins cher|en soldes|joutez au comparateur|(continue|continuerz) (vos|mes) (achats|continuer) le shopping|livraison gratuits|meilleures ventes|ordres|ordre|acheter maintenant|ajouter au panier|boutique|acheter|achat|bons de rduction|vendez|liste d'enies|livraison|la livraison de la piste|emballage cadeau|passer la commande|expdition de retour|acheter en ligne|chques-cadeaux|cadeau|ajoutez  votre liste d'envies|continuer mes achats|rductions|dtails sur le produit|frais de livraison|paiement scuris|guide des tailles|le produit|en stock|top marques"}],it:[{name:"ecommerce",pattern:"idee regalo|lista (desideri|dei desideri)|consegna gratuita|spedizione e reso gratuity|offerte del giorno|vai al negozio|prenota ora|spedizioni|spese di (consegna|spedizione|trasporto)|spedizione gratuita|servizio  di spedizione|modalit di spedizione|pagamento per contrassegno|\bacquista\b|articoli selezionati|\bordina\b|continua shopping|stato ordini|storico ordini|buono acquisto|diritto di recesso|carrello|pagamenti rateali|buoni (sconto|regalo)"}],jp:[{name:"ecommerce",pattern:"|||||||||"}],no:[{name:"ecommerce",pattern:"mine lister|sammenlign (priser|produkter)|nettbutik(ker|ke)?|til(bud| kassen)|handle(lister|vognen|kurven|vogn)|kjp|p lager|nskeliste(r)?|priskrigen|salg|gavekort|butikk(er)?"}],pl:[{name:"ecommerce",pattern:"koszyk|upominki|do koszyka|z zamwienie|listy zakupowe|okazje|lista ycze|karty podarunkowe|darmowa dostawa|oferty|marka|wysyka gratis|dodaj do koszyka|kup teraz|koszty dostawy|twj koszyk jest pusty|kategorie|sklepy|bezpieczne zakupy|informacje o produkcie|mj koszyk|patnoci|delivery method|delivery"}],pt:[{name:"ecommerce",pattern:"ofertas exclusivas para voc|entrega a domicilio gratis|frete grtis|formas de pagamentos|meu carrinho|nossas lojas|meu carrinho vazio|caixa expresso shopping|Lista de Desejos|Ofertas e Descontos|Ver todos os Departamentos|Poltica de compra|lista de casamento|meus pedidos|comprar (este|produto|agora|com garantia)|quem viu esse produto acabou comprando|acompanhe seus pedidos|trocas|lista de presentes|super descontos|envio imediato|em estoque|minha cesta|compre por departamento|melhores ofertas|frte e prazo|informaes do produto|garantia estendida|quem viu esse produto viu tambm|caixa expresso|minhas compras|complemente sua compra|compre tambm|entrega expressa|mais vendidos da semana"}],ru:[{name:"ecommerce",pattern:"( )?( )?( )?|, |( )? | | | | | |  | |  | | | | |  ?|(|) |  |  | (   | )|add to the bag|   14 |  | |\n | | |  |  ||  | |  |-| | | |\n   | | | | "}],sv:[{name:"ecommerce",pattern:"erbjudanden|dagens deal|varukorg|fraktfria|frakt|orderstatus|s hr handlar du|presentkort|skickar vanligtvis bestllda varor inom 24 timmar|butiker|kundvagnen|returinformation|leveransinformation|fraktinformation|shop by brand|kp|i lager|jmfr priser|direkt frn lagerhyllan|kundvagn|varukorgen|kassan|prissnkta produkter"}],tr:[{name:"ecommerce",pattern:"maazaya|maaza|sepetim|kargo bedava rnler|cok satanlar|sipari takibi|sipari|gvenli alveri|hemen al|sepete ekle|gnn frsat rnleri|popler rnler|kargo sresi|hemen al|maazalar|alveri|rn|markalar|kampanyalar|yeni rnler|deme seenekleri|gvenli alveri|cretsiz kargo|beden tablosu|deiim bilgileri|iade bilgileri"}]},e.LanguageDisqualifyingPhrases={br:[{name:"porn",pattern:"lesbisch|oralsex|blowjob|pornstars|porno"},{name:"bank",pattern:"online-banking|banking"},{name:"gambling",pattern:"casino|video slots"},{name:"gaming",pattern:"jogos online grtis|jogos para download|jogos online|jogar grtis|jogar agora"},{name:"real-estate",pattern:"imovl|aluguel|apartamento"},{name:"auto",pattern:"tabela fipe"},{name:"download",pattern:"download gratis|mais baixados"},{name:"work",pattern:"download gratis|mais baixados"},{name:"online-tv",pattern:"assistir filmes online|filmes online gratis|tv online|filmes gratis"}],de:[{name:"porn",pattern:"lesbisch|oralsex|blowjob|pornstars|porno"},{name:"bank",pattern:"online-banking|banking"},{name:"gambling",pattern:"casino|video slots"}],en:[{name:"porn",pattern:"anal|blowjob|lesbian|porn|sex web cam"},{name:"banking",pattern:"banking"},{name:"gambling",pattern:"casino|slot machine|roulette"},{name:"investment",pattern:"stock trading|stock market|investment bond|stocks to buy"},{name:"dating",pattern:"videochat|video chat|online dating|dating service"}],es:[{name:"porn",pattern:"lsbianas|porno"},{name:"bank",pattern:"banco|banking|banca"},{name:"gambling",pattern:"casino|las tragamonedas|video tragamonedas"}],fr:[{name:"porn",pattern:"lesbienne|lesbiennes|mnage  trois|porno|camras rotiques"},{name:"bank",pattern:"banque|banking|bank|compte bancaire"},{name:"gambling",pattern:"casino|machines  sous|video slots"}],it:[{name:"porn",pattern:"lesbiche|porno"},{name:"bank",pattern:"bancario|banca|banche|bancari"},{name:"gambling",pattern:"casin|casino|video slots"}],pl:[{name:"porn",pattern:"lesbijki|porno"},{name:"bank",pattern:"bank|bankowo|banku|bancari"},{name:"gambling",pattern:"casino|roulette|video slots"}],pt:[{name:"porn",pattern:"lsbicas|porno"},{name:"bank",pattern:"crdito e financiamentos|banco|crditos e financiamentos|conta corrente"},{name:"gambling",pattern:"cassino|casino|roleta|caa nqueis|video slots"}],ru:[{name:"porn",pattern:"|"},{name:"bank",pattern:"| ||bank"},{name:"gambling",pattern:"casino||||casino|video slots"}]},e}();e.CommerceDictionary=t}(t=e.Vertical||(e.Vertical={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.getInstance=function(){return e.instance},e.prototype.retrive=function(t){return e.datastore[t]},e.prototype.store=function(t,n){e.datastore[t]=n},e.prototype.remove=function(t){delete e.datastore[t]},e.prototype.retriveAndRemove=function(e){var t=this.retrive(e);return this.remove(e),t},e.datastore={},e.instance=new e,e}();e.SharedSpace=t}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e._perform=function(e,t,n){var r=e.retrive(t);if(r)return r.promise;var o=n();return r={initTime:(new Date).getTime(),promise:o},e.store(t,r),o},e}(),n=function(){function n(){}return n.perform=function(e,r){return window.FO_DISABLESINGLETONS?r():t._perform(n.singletoneStore,e,r)},n.singletoneStore=new e.GlobalSpace("Singletones"),n}();e.GlobalSingletone=n;var r=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.perform=function(e,n){return t._perform(r.singletoneStore,e,n)},r.singletoneStore=e.SharedSpace.getInstance(),r}(t);e.VersionSingletone=r}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(){function r(){}return r.specialCase=function(e){return t.Common.VersionSingletone.perform("cls.commerce.specialcase",function(){return r.classifyBySpecialCasesAndJunk(e)})},r.schemaOrg=function(e){return t.Common.VersionSingletone.perform("cls.commerce.schemaorg",function(){return r.classifyBySchemaOrg(e)})},r.blackWhiteList=function(e){return t.Common.VersionSingletone.perform("cls.commerce.bwl",function(){return r.classifyByBlackWhiteList(e)})},r.qualifyingDictionaries=function(e){return t.Common.VersionSingletone.perform("cls.commerce.posdict",function(){return r.classifyByQualifyingDictionaries(e)})},r.disqualifyingDictionaries=function(e){return t.Common.VersionSingletone.perform("cls.commerce.negdict",function(){return r.classifyByDisqualifyingDictionaries(e)})},r.productImage=function(e){return t.Common.VersionSingletone.perform("cls.commerce.prodimg",function(){return r.classifyByProductImage(e)})},r.classifyBySpecialCasesAndJunk=function(e){var n=e.host().toLowerCase().match(this.blackRegex);return n?(t.Logger.log("Host matched black REGEX - Classifying as non-commerce. Matches: ["+n+"]"),t.resolve(-1)):t.resolve(0)},r.classifyBySchemaOrg=function(n){var r=e.$("[itemtype='http://schema.org/Offer']").length>0||e.$("[itemtype='http://schema.org/Offer/']").length>0,o=e.$("[itemtype='http://schema.org/Product']").length>0||e.$("[itemtype='http://schema.org/Product/']").length>0;return r||o?t.resolve(1):t.resolve(0)},r.classifyByBlackWhiteList=function(e,n){void 0===n&&(n=!0);var r=e.paths().blackWhiteListRoot()+"/search/",o=t.Common.BlackWhiteListHelper.breakdownHost();return t.Common.BlackWhiteListHelper.blackWhiteMatch(o,e.paths().dynamicContentRoot()+"/bwl/wl",e.paths().dynamicContentRoot()+"/bwl/bl",n?r:null).then(function(e){return e.score})},r.classifyByQualifyingDictionaries=function(e){for(var r=t.Common.LocaleHelper.getLanguagesForCountry(e.countryCode()),o=0,i=0;i<r.length;i++){var a=r[i];if(a in n.CommerceDictionary.LanguageCommercePhrases){var s=n.CommerceDictionary.LanguageCommercePhrases[a];if(s&&s.length>0){var u=e.scraper().testPatternsAgainstHTML(s);t.Logger.log("Language score for "+a+": "+u),u>o&&(o=u)}}}return t.Logger.log("Commerce classifyByQualifyingDictionaries lang result: "+o),t.resolve(o)},r.classifyByDisqualifyingDictionaries=function(e){for(var r=t.Common.LocaleHelper.getLanguagesForCountry(e.countryCode()),o=0;o<r.length;o++){var i=r[o];if(i in n.CommerceDictionary.LanguageDisqualifyingPhrases){var a=n.CommerceDictionary.LanguageDisqualifyingPhrases[i];if(a&&a.length>0){var s=e.scraper().testPatternsAgainstHTML(a);if(s)return t.Logger.log("Page contains disqualifying phrases for language ["+i+"]. Failing classification by dictionaries"),t.resolve(-1)}}}return t.Logger.log("classifyByDisqualifyingDictionaries result: 0"),t.resolve(0)},r.classifyByProductImage=function(e){var n,r=t.Common.ImageUtils.getFirstEcommerceImage(!0,!1),o=new t.ProductBoxes.ScraperBase,i=o.findPriceElements(document.body),a=i&&i.length>0;return n=r&&a?1:0,t.Logger.log("Product image (ribbon logic): "+n+". Image found: "+!!r+" Price found: "+a),t.resolve(n)},r.blackRegex=/xhamster\.com|avast\.com|avg\.com|porno|xxx|celibook\.com|boafoda\.com|gay411\.com|netechangisme\.com|swingers|pasion\.com|reallifecam|tufik\.com|sexcam|bearwww|instagram\.com|pl\.zbiornik\.com|dbgpoker\.com|bet365\.es|poker3dface\.lux777\.com|twitter\.com|tube|lazada|shopzilla\.|beso\.|kelkoo\.|orange\.|gameforge|infojobs|(allmyvideos|laposte|megafilmeshd|vidspot)\.net|gov\.|wikipedia\.org|(pricegrabber|stackoverflow|hulu|blogger|dartybox|alexa|baidu|cj|facebook|flickr|history|hotmail|imdb|imvu|linkedin|microsoft|msn|myspace|netflix|nytimes|politico|picasa|pinterest|delta-search|sfgate|shutterfly|techcrunch|verizon|venturebeat|wired|yankodesign|youtube|bing|vk|live|tumblr|roblox|411answers|tagged|nickjr|opposingviews|truste|adobe|breakfastdailynews|\.avg|\.aol|pogo|porno|pornhub|youporn|pron|youjizz|xnxx|juegos|surveysresearchgroup|dofus|adopteunmec|unique|nationzoom|sncf|privee|awesomehp|updateflashplayer|stocktradingcenters|empowernetwork|regionalhealthreview|websurveycentral|\.att|news788|411source|hsselite|verizonwireless|internetautoguide|symantec|\.pch|nortonpro|pchealthboost|voipo|contenko|seaworldparks|ratezip|game321|boostmobile|globo|yepi|jogatina|4shared|ojogos|tudogostoso|netcartas|voeazul|cartoonnetwork|\.tam|viajanet|jogosdemeninas|logitravel|freakshare|chaturbate|abt)\.com|paypal\.|google|.gov|.edu|qvo6|cam4|surveyservers|games.la|jeu.info|nubiles/i,r}();n.CommerceHelper=r}(n=t.Vertical||(t.Vertical={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.SEARCH=0]="SEARCH",e[e.COMMERCE=1]="COMMERCE",e[e.NON_COMMERCE=2]="NON_COMMERCE",e[e.CAMPAIGNS=3]="CAMPAIGNS",e[e.STUB=4]="STUB",e[e.COUPONS=5]="COUPONS",e[e.TRAVELS=6]="TRAVELS",e[e.ALLWAYS_CLASSIFIED=7]="ALLWAYS_CLASSIFIED",e[e.IN_TEXT=8]="IN_TEXT"}(e.ClassificationType||(e.ClassificationType={}));e.ClassificationType}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t,n){this.logic=null,this.name=e,this.logics=t,this.visual=n}return e.prototype.classify=function(e){return this.logic.classify(e)},e}();e.Product=t}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}));
}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.disable=function(){return window.FO_FORGET},e.getHistoricalClassification=function(t){if(e.disable())return 0;var n="FO.Classification."+t.flag(),r=localStorage.getItem(n),o=(new Date).getTime();return r&&parseInt(r)>o?1:0},e.setHistoricalClassification=function(t,n){if(void 0===n&&(n=3600),!e.disable()){var r="FO.Classification."+t.flag(),o=(new Date).getTime(),i=o+1e3*n;localStorage.setItem(r,i+"")}},e}();e.ElephantClassifier=t}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(){function r(e,t){this.paths=null,this.paths=e;var r=n.generateGuid(16);this.iframePromise=this.createIFrame(r,e.iframeStoreSrc(),t,5e3)}return r.prototype.createIFrame=function(r,o,i,a){var s=this,u=t.defer(),c=document.createElement("iframe");return c.id=r,c.src=i?o+"#debug":"https:"+o,c.style.position="absolute",c.style.width="1px",c.style.height="1px",c.style.left="-100px",c.style.top="-100px",c.style.visibility="hidden",n.VisualHelper.appendToBody(e.$(c)),n.attachPostMessageHandler(window,this.createHandleCallback(this.paths.rootUrl())),t.Logger.log("IFrameStore setup"),c.onload=function(){t.Logger.info("IFrame trying echo on onload"),s.verifyIFramePromise(c).fail(function(e){t.Logger.warn("IFrame echo failed");var n=e.message?e.message:e+"";u.reject({message:"Store IFrame echo after load failure: "+n})}).done(function(){t.Logger.info("Store IFrame alive and well.Loaded and echoes"),u.resolve(c)})},c.onerror=function(e){t.Logger.info("IFrame trying echo on onerror"),s.verifyIFramePromise(c).fail(function(n){t.Logger.warn("IFrame echo failed");var r=n.message?e.message:n+"";u.reject({message:"Store IFrame echo after error failure: "+r})}).done(function(){t.Logger.warn("Store IFrame alive and well even though error reported. WTF."),u.resolve(c)})},a&&setTimeout(function(){u.getStatus()===t.Status.Unfulfilled&&(t.Logger.warn("IFrame load timed out after: "+a),u.reject({message:"IFrame load timed out after: "+a}))},a),u.promise()},r.prototype.verifyIFramePromise=function(e){return this.postRequestPromise(e,"retrieveOrSet",!0,"echo","echo")},r.prototype.postRequest=function(e,t,n,r){var o=this;return this.iframePromise.then(function(i){return o.postRequestPromise(i,e,t,n,r)})},r.prototype.postRequestPromise=function(e,o,i,a,s){var u=t.defer(),c=!1,l=n.generateGuid(9);window.setTimeout(function(){if(!c){c=!0;var e={message:"IFrameStore request of type: "+o+". key: "+a+". Has timed out after "+r.REQUEST_TIMEOUT_MS};u.reject(e)}},r.REQUEST_TIMEOUT_MS),i&&r.getGlobalCallMap().store(l,function(e){c||(c=!0,u.resolve(e))});var d={id:l,type:o,key:a,value:s},p=JSON3.stringify(d);return e.contentWindow.postMessage(p,e.src),u.promise()},r.getGlobalCallMap=function(){return new n.GlobalSpace("postMessageCallbacks")},r.prototype.createHandleCallback=function(e){return function(t){var n=!1,o=r.getMainDomain(e),i=r.getMainDomain(t.origin);if(n||i==o)try{var a=JSON3.parse(t.data),s=r.getGlobalCallMap().retriveAndRemove(a.id);s&&s(a.value)}catch(u){}}},r.getMainDomain=function(e){if(e.indexOf("//localhost")!=-1)return"localhost";var t=/\/\/[^\.]+\.((?:[^\.\/]*\.+)?[^\.\/]*)/gi,n=t.exec(e)[1];return n},r.prototype.retrieveAll=function(){return this.postRequest("retrieveAll",!0)},r.prototype.retrieveOrSet=function(e,t){return this.postRequest("retrieveOrSet",!0,e,t)},r.prototype.retrieve=function(e){return this.postRequest("retrieve",!0,e)},r.prototype.store=function(e,t){this.postRequest("store",!1,e,t)},r.prototype.storeAll=function(e){this.postRequest("storeAll",!1,null,e)},r.REQUEST_TIMEOUT_MS=300,r}();n.IFrameStore=r}(n=t.Common||(t.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(e,t){this.asyncStore=e,this.data=t}return t.prototype.uuid=function(){return this.data.uuid},t.prototype.retrive=function(e){return this.data[e]},t.prototype.store=function(e,t){this.data[e]=t,this.commitChanges()},t.prototype.remove=function(e){delete this.data[e],this.commitChanges()},t.prototype.retriveAndRemove=function(e){var t=this.data[e];return delete this.data[e],this.commitChanges(),t},t.prototype.reload=function(){var n=this;return this.asyncStore.retrieve(t.USER_SETTINGS_KEY).alwaysThen(function(t,r){r?r&&e.Logger.warn("Failed reloading userSetting."):n.data=t})},t.prototype.commitChanges=function(){this.asyncStore.store(t.USER_SETTINGS_KEY,this.data),localStorage.setItem(t.USER_SETTINGS_KEY,JSON3.stringify(this.data))},t.fromAsyncStorePromise=function(n,r){var o={uuid:r,suspended:{}};return n.retrieveOrSet(t.USER_SETTINGS_KEY,o).alwaysThen(function(r,i){var a=null;if(i||null==r){e.Logger.warn("Failed getting real userSetting using default: "+(i&&i.message));var s=localStorage.getItem(t.USER_SETTINGS_KEY),u=null;try{u=JSON3.parse(s)}catch(c){}u&&u.uuid?(e.Logger.warn("Using localStorage info in place of iframe settings:"),e.Logger.info(s),a=u):(e.Logger.info("localStorage info missing or misshaped will use default values for user settings"),a=o)}else{e.Logger.info("Using true iframe data for user settings"),a=r;try{localStorage.setItem(t.USER_SETTINGS_KEY,JSON3.stringify(r))}catch(i){e.Logger.warn("Failed to save  on localStorage. Size: "+JSON3.stringify(r).length),localStorage.setItem(t.USER_SETTINGS_KEY,JSON3.stringify(o))}}return new t(n,a)}).fail(function(t){e.Logger.error("Failed loading async store for userSettings: "+t.message)})},t.USER_SETTINGS_KEY="userSettings",t}();t.LooseUserSettings=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.injectScriptRetryPromise=function(n,r){void 0===r&&(r=0);var o=function(e){return t.injectScriptPromise(n+(n.indexOf("?")!=-1?"&":"?")+"try="+e)};return e.retryPromise(o,r+1)},t.injectScriptPromise=function(t){var n=e.defer();return Injector.injectScript(t,function(){return n.resolve(null)},function(e){return n.reject({message:"Failed script load "+t+": "+(e&&e.message)})}),n.promise()},t.promiseFromLoader=function(t,n){var r=e.defer(),o=!1;return t.onload=t.onreadystatechange=function(e){o||t.readyState&&4!=t.readyState&&"loaded"!==t.readyState&&"complete"!==t.readyState||(o=!0,r.resolve(t))},t.onerror=function(e){o||(o=!0,r.reject({message:"unknown load error"}))},t.ontimeout=function(e){o||(o=!0,r.reject({message:"timeout error"}))},r.promise()},t.nativeAjax=function(e){var n=null;if("XDomainRequest"in window){var r=new window.XDomainRequest;r.open("get",e),n=t.promiseFromLoader(r,e),r.send()}else{var o=new XMLHttpRequest;o.open("get",e,!0),n=t.promiseFromLoader(o,e),o.send()}return n.then(function(e){if(200==e.status)return e.responseText;throw new Error(e.statusText)})},t}();t.NativeJSHelper=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(FO){var Shared;!function(Shared){var Common;!function(Common){var Res=function(){function Res(){}return Res.bring=function(e){return Common.VersionSingletone.perform(e,function(){return Res.bringInner(e)})},Res.bringInner=function(e){return Shared.jqGetPromise(e)},Res.injectHtml=function(e){return Common.VersionSingletone.perform(e,function(){return Res.injectHtmlInner(e)})},Res.injectHtmlInner=function(e){return Shared.jqGetPromise(e).then(function(e){return Common.VisualHelper.appendToBody(FO.$(e))})},Res.injectCss2=function(e,t){return void 0===t&&(t=document),Common.VersionSingletone.perform(e,function(){return Res.injectCss2Inner(e,t)})},Res.injectCss2Inner=function(e,t){if(void 0===t&&(t=document),t.createStyleSheet)t.createStyleSheet(e);else{var n=FO.$('<link rel="stylesheet" type="text/css" href="'+e+'" />');Common.VisualHelper.appendToHead(n,t)}return Shared.resolve(null)},Res.injectScript=function(e,t){return void 0===t&&(t=2),Common.VersionSingletone.perform(e,function(){return Res.injectScriptInner(e,t)})},Res.injectScriptWebSocket=function(url,wsUrl){return Common.VersionSingletone.perform(url,function(){return Shared.webSocketPromise(url,wsUrl).then(function(resultsString){eval(resultsString)})})},Res.injectScriptInner=function(e,t){return void 0===t&&(t=2),Common.NativeJSHelper.injectScriptRetryPromise(e,t)},Res.loadProduct=function(e,t,n,r){var o=Res.instantiateVisual(e,r),i=Shared.StaticCol.select(n,function(t){return Res.instantiateLogic(e,t)}),a=new Shared.Products.Product(t,i,o);return Shared.resolve(a)},Res.instantiateLogic=function(e,t){var n;n=e.params().isStandAlone?["FO.Shared.Products.Logic."+t,"FO.Shared.ExternalProducts."+t]:["FO.Shared_0_0_1214.Products.Logic."+t,"FO.Shared_0_0_1214.ExternalProducts."+t];var r=Shared.Col.of(n).selectFirst(function(e){return Res.instantiateFromQualifiedName(e,!1)});if(!r)throw new Error("Failed to instantiate logic "+t);return r},Res.instantiateVisual=function(e,t){var n;n=e.params().isStandAlone?["FO.Shared.Products.Visual."+t,"FO.Shared.ExternalProducts."+t]:["FO.Shared_0_0_1214.Products.Visual."+t,"FO.Shared_0_0_1214.ExternalProducts."+t];var r=Shared.Col.of(n).selectFirst(function(e){return Res.instantiateFromQualifiedName(e,!1)});if(!r)throw new Error("Failed to instantiate visual "+t);return r},Res.instantiateFromQualifiedName=function(e,t){void 0===t&&(t=!0);for(var n=e.split("."),r=window,o=0;o<n.length;o++){if(!(n[o]in r)){if(t)throw Error("Cannot instantiate from qualified name. "+n[o]+" not found for path "+e);return null}r=r[n[o]]}return new r},Res}();Common.Res=Res}(Common=Shared.Common||(Shared.Common={}))}(Shared=FO.Shared_0_0_1214||(FO.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){function r(e,n){n.subscribe(function(n){return t.Logger.log("Observable "+e+": "+n)})}n.watchObservable=r,n.defaultAdjustScaleOptions={active:!1,top:0,bottom:0,pos:.5,minScale:.65},n.defaultHorizontalPos={active:!1,right:0,left:0,minScale:1};var o=(function(){function n(t){this.context=t,this.originalBindingProvider=new e.ko.bindingProvider}return n.prototype.nodeHasBindings=function(e){return this.originalBindingProvider.nodeHasBindings(e)},n.prototype.getBindings=function(e,n){var r;try{r=this.originalBindingProvider.getBindings(e,n)}catch(o){t.Logger.Analytics.notify(this.context,t.Logger.Analytics.GENERIC,{subtype:"bindingError",when:"kobinding",error:o.message})}return r},n}(),function(){function n(t){this.originalBindingProvider=new e.ko.bindingProvider,this.context=t}return n.prototype.nodeHasBindings=function(e){return this.originalBindingProvider.nodeHasBindings(e)},n.prototype.getBindings=function(e,r){var o;try{o=this.originalBindingProvider.getBindings(e,r)}catch(i){var a=n.getNearestContext(r);a?(t.Logger.error("Binding error: "+i.message,a),t.Logger.Analytics.notify(a,t.Logger.Analytics.GENERIC,{subtype:"bindingError",when:"kobinding",error:i.message})):(t.Logger.error("Binding error: "+i.message),t.Logger.Analytics.notify(this.context,t.Logger.Analytics.GENERIC,{subtype:"bindingError",when:"kobindingNoContext",error:i.message}))}return o},n.getNearestContext=function(t){var r=e.ko.utils.unwrapObservable(t.$data.context);return n.objectIsContext(r)?r:t.$parentContext?n.getNearestContext(t.$parentContext):null},n.objectIsContext=function(e){return e&&e.notificationParams&&"function"==typeof e.notificationParams},n}()),i=function(){function r(){}return r.setErrorHandlingBindingProvider=function(t){e.ko.bindingProvider.instance=new o(t)},r.setAlternativeTemplateEngine=function(){var t=new e.ko.nativeTemplateEngine;t.renderTemplate=function(n,r,o,i){var a=e.ko.templateEngine.prototype.makeTemplateSource(n,null);return t.renderTemplateSource(a,r,o)},e.ko.setTemplateEngine(t)},r.registerCustomBindings=function(t){var n=new u,o=e.ko.bindingHandlers.event;e.ko.bindingHandlers.event=new l(o),e.ko.bindingHandlers.containedTemplate2=n,e.ko.bindingHandlers.containedTemplateInit=r.containedTemplateInit(n),e.ko.bindingHandlers.slideVisible=r.slideVisible(),e.ko.bindingHandlers.fadeVisible=r.fadeVisible(),e.ko.bindingHandlers.fadeVisibleInvisibleRemove=r.fadeVisibleInvisibleRemove(),e.ko.bindingHandlers.clickToggle=r.clickToggle(),e.ko.bindingHandlers.hoverToggle=r.hoverToggle(),e.ko.bindingHandlers.className=r.className(),e.ko.bindingHandlers.delayedCss=r.delayedCss(),e.ko.bindingHandlers.ifStyle=r.ifStyle(),e.ko.bindingHandlers.stopBubble=r.stopBubble(),e.ko.bindingHandlers.positionNextTo=r.positionNextTo(),e.ko.bindingHandlers.containedDivTemplate=r.containedDivTemplate(),e.ko.bindingHandlers.visibleInlineBlock=r.visibleInlineBlock(),e.ko.bindingHandlers.captureClick=r.captureClick(),e.ko.bindingHandlers.stopPropagation=r.stopPropagation(),e.ko.bindingHandlers.treatCollisions=r.treatForCollisions(),e.ko.bindingHandlers.adjustScale=new a,e.ko.bindingHandlers.bindIframe=new s,r.setAlternativeTemplateEngine()},r.captureClick=function(){return{init:function(t,r,o,i,a){var s,u=e.ko.utils.unwrapObservable(r()),c=n.EventUtils.getClickEventName();s="IFRAME"==t.tagName?t.contentWindow:t,n.SafeDocument.safeAddEventListener(s,c,function(e){u(i,e)},"undefined"==typeof a.$root.isCapture||a.$root.isCapture)}}},r.visibleInlineBlock=function(){return{update:function(t,n){var r=e.ko.utils.unwrapObservable(n()),o=!("none"==t.style.display);r&&!o?t.style.display="inline-block":!r&&o&&(t.style.display="none")}}},r.stopPropagation=function(){return{init:function(t,n,r,o,i){for(var a=e.ko.utils.unwrapObservable(n()),s=a.split(","),u="IFRAME"==t.tagName.toUpperCase()?t.contentWindow:t,c=0;c<s.length;c++)u.addEventListener(s[c].trim(),function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()},!0)}}},r.stopBubble=function(){return{init:function(r,o,i,a,s){for(var u=e.ko.utils.unwrapObservable(o()),c=u.split(","),l=0;l<c.length;l++)try{n.EventUtils.addEvent(r,c[l].trim(),function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()})}catch(d){t.Logger.warn("fail in stopBubble : "+d)}}}},r.subscribe=function(){return{update:function(t,n,r,o,i){var a=e.ko.utils.unwrapObservable(n()),s=a.to,u=a.fn;s&&s.subscribe&&u&&s.subscribe(u)}}},r.className=function(){return{update:function(t,n,r,o,i){try{var a=n();a&&e.$(t).toggleClass(a,!0)}catch(s){}}}},r.delayedCss=function(){return{update:function(t,n,r,o,i){setTimeout(function(){e.ko.bindingHandlers.css.update(t,n,r,o,i)},500)}}},r.ifStyle=function(){return{update:function(t,n,r,o,i){var a=e.ko.utils.unwrapObservable(n());for(var s in a)try{s&&(t.style[s]=a[s](o))}catch(u){}}}},r.positionNextTo=function(){return{update:function(t,r,o,i,a){var s=e.$(t),u=e.ko.utils.unwrapObservable(r()),c=n.VisualHelper.positionNextTo(u,s);s.css({top:c.y,left:c.x,position:"absolute"})}}},r.getBrowser=function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"MSIE "+(e[1]||"")):"Chrome"===n[1]&&(e=t.match(/\bOPR\/(\d+)/),null!=e)?"Opera "+e[1]:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))},r.clickToggle=function(){return{init:function(e,t,r,o,i){var a=t();n.EventUtils.addEvent(e,"click",function(){a(!a())})}}},r.hoverToggle=function(){return{init:function(e,t,r,o,i){var a=t();n.EventUtils.addEvent(e,"mouseenter",function(){return a(!0)}),n.EventUtils.addEvent(e,"mouseout",function(){return a(!1)})}}},r.containedTemplateInit=function(e){return{init:e.update}},r.appendReconstitution=function(e,t){e.reconstitution||(e.reconstitution=[]),e.reconstitution.push(t)},r.containedDivTemplate=function(){return{update:function(n,r,o,i,a){var s=e.$("<div></div>");e.ko.bindingHandlers.template.update(s[0],r,o,i,a);var u=e.ko.utils.unwrapObservable(r()),c=("object"==typeof u&&u.css?u.css:[],function(){e.$(n).append(s)});t.wait(100).then(c)}}},r.squareResizeWithOffsets=function(e,t,n){r.ctAdjustHeight(e,t,n,20),r.ctAdjustWidth(e,t,n,25)},r.treatForCollisions=function(){return{init:function(t,r,o,i,a){n.CollisionHelper.treatForCollisions(e.$(t))},update:function(t,r,o,i,a){n.CollisionHelper.treatForCollisions(e.$(t))}}},r.ctTreatForCollisions=function(e,t){n.CollisionHelper.treatForCollisions(t)},r.ctAdjustHeight=function(t,n,r,o){void 0===o&&(o=0),setInterval(function(){try{var r=n&&n.children().length&&n.children()[0];if(r){var i=e.$(r).height();e.$(t).height(i+o)}}catch(a){}},r)},r.ctAdjustWidth=function(t,n,r,o){void 0===o&&(o=0),setInterval(function(){try{var r=n&&n.children().length&&n.children()[0];if(r){var i=e.$(r).width();e.$(t).width(i+o)}}catch(a){}},r)},r.ctAdjustElementScale=function(n,o,i,a){var s=e.$(n),u=r.getFirstHeight(s),c=r.getFirstWidth(s);r.scaleElementOnResize(n,o,u,c),t.stableAddEventListener(function(){r.scaleElementOnResize(n,o,r.getFirstHeight(s),r.getFirstWidth(s))},"resize",100),t.Col.of(a).each(function(e){i[e]&&i[e].subscribe(function(){r.scaleElementOnResize(n,o,r.getFirstHeight(s),r.getFirstWidth(s))})})},r.ctAdjustScale=function(n,o,i,a,s){var u,c;t.waitFor(function(){return"true"===e.$(n.contentDocument.body).css("ready")},1e4,50).then(function(){t.waitForStable(function(){return u=r.getFirstHeight(o),c=r.getFirstWidth(o),u+c},function(e){return e>400},function(e){return r.scaleOnResize(n,i,u,c)},200,500)}),t.stableAddEventListener(function(){return r.scaleOnResize(n,i,r.getFirstHeight(o),r.getFirstWidth(o))},"resize",100),t.Col.of(s).each(function(e){a[e]&&a[e].subscribe(function(){r.scaleOnResize(n,i,r.getFirstHeight(o),r.getFirstWidth(o))})})},r.ctAdjustHorizontalPosition=function(n,o,i){t.waitFor(function(){return"true"===e.$(n.contentDocument.body).css("ready")},1e4,50).then(function(){return t.waitForStable(function(){return r.getFirstWidth(o)},function(e){return e>0},function(e){return r.adjustHorizontalPosition(n,i,e)},100,500)});var a,s=function(){var e=r.getFirstWidth(o);r.adjustHorizontalPosition(n,i,e)};e.$(window).resize(function(){clearTimeout(a),a=setTimeout(s,100)})},r.getFirstHeight=function(t){var n=e.$(t[0]).find(".fo-container").first();return n.length?n.height():0},r.getFirstWidth=function(t){var n=e.$(t[0]).find(".fo-container").first(),r=n.length?n.width():0,o=e.$(t[0]).find(".fo-handles").first(),i=o.length?o.height():0;return r+i+1},r.scaleElementOnResize=function(t,n,o,i){var a=e.$(t).data("scaleData");if(!a||window.innerHeight!=a.windowHeight||o!=a.innerHeight||window.innerWidth!=a.windowWidth||i!=a.innerWidth){a={windowHeight:window.innerHeight,innerHeight:o,windowWidth:window.innerWidth,innerWidth:i},e.$(t).data("scaleData",a);var s=i||n.width||310,u=window.innerHeight-n.top-n.bottom,c=u/o;c>1&&(c=1),c<n.minScale&&(c=n.minScale);var l=o*c,d=s*c,p=(u-l)*n.pos+n.top,f=window.innerHeight-n.bottom-l;p=Math.min(f,p),e.$(t).css("top",p+"px"),r.getBrowser().indexOf("Chrome")>=0?(e.$(t).height(l),e.$(t).width(d),e.$(t).css("zoom",c)):(e.$(t).height(o),e.$(t).css("transform","scale("+c+")"),e.$(t).css("right",(c-1)*e.$(t).width()+"px"))}},r.scaleOnResize=function(t,n,o,i){var a=e.$(t).data("scaleData");if(!a||window.innerHeight!=a.windowHeight||o!=a.innerHeight||window.innerWidth!=a.windowWidth||i!=a.innerWidth){a={windowHeight:window.innerHeight,innerHeight:o,windowWidth:window.innerWidth,innerWidth:i},e.$(t).data("scaleData",a);var s=i||n.width||310,u=window.innerHeight-n.top-n.bottom,c=u/o;c>1&&(c=1),c<n.minScale&&(c=n.minScale);var l=o*c,d=s*c,p=(u-l)*n.pos+n.top,f=window.innerHeight-n.bottom-l;p=Math.min(f,p),e.$(t).css("top",p+"px"),r.getBrowser().indexOf("Chrome")>=0?(e.$(t).height(l),e.$(t).width(d),e.$(t.contentDocument.body).css("zoom",c)):(e.$(t).height(o),e.$(t).css("transform","scale("+c+")"),e.$(t).css("right",(c-1)*e.$(t).width()+"px"))}},r.adjustHorizontalPosition=function(t,n,r){var o=window.innerWidth-n.left-n.right,i=o/r;i>1&&(i=1),i<n.minScale&&(i=n.minScale);var a=e.$(t).height()*(i-1);e.$(t).css("transform","scale("+i+")"),e.$(t).css("right",n.right+"px"),e.$(t).css("bottom",a+"px")},r.slideVisible=function(){return{init:function(t,n){var r=e.ko.unwrap(n());e.$(t).toggle(r)},update:function(t,n,r){var o=n(),i=e.ko.unwrap(o),a=r.get("slideInDuration")||300,s=r.get("slideOutDuration")||300;1==i?e.$(t).slideDown(a):e.$(t).slideUp(s)}}},r.fadeVisible=function(){return{update:function(t,n){var r=n();e.ko.unwrap(r)?e.$(t).fadeIn(600):e.$(t).fadeOut(300)}}},r.fadeVisibleInvisibleRemove=function(){return{update:function(t,r){var o=r();e.ko.unwrap(o)?e.$(t).fadeIn():e.$(t).fadeOut(600,function(){n.DomProtect.safeRemove(t)})}}},r.isPropertySupported=function(e){return e in document.body.style},r}();n.KoBindings=i;var a=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype.update=function(t,r,o,a,s){var u=e.ko.utils.unwrapObservable(r()),c=i.getBrowser(),l=o.get("resizeOnChange")||[],d=u&&"object"==typeof u&&"MSIE 9"!=c?u:{},p=e.$.extend({},n.defaultAdjustScaleOptions,d);p&&p.active&&i.ctAdjustElementScale(t,p,a,l)},r}(t.RootClass),s=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.init=function(t,n){function r(){try{var r=t.contentDocument}catch(o){}r&&r.write(e.ko.unwrap(n()))}r(),e.ko.utils.registerEventHandler(t,"load",r)},n}(t.RootClass),u=function(r){function o(){r.apply(this,arguments)}return __extends(o,r),o.prototype.update=function(r,a,s,u,c){var l=e.ko.utils.unwrapObservable(a()),d=i.getBrowser(),p=!0,f="object"==typeof l&&l.resizeOnChange?l.resizeOnChange:[],g="object"==typeof l&&l.squareResizeWithOffsets?l.squareResizeWithOffsets:0,m="object"==typeof l&&l.adjustHeightInterval?l.adjustHeightInterval:0,h="object"==typeof l&&l.adjustScale&&"MSIE 9"!=d?l.adjustScale:{},v=e.$.extend({},n.defaultAdjustScaleOptions,h),y="object"==typeof l&&l.css?l.css:null,C="object"==typeof l&&l.adjustHorizontal?l.adjustHorizontal:{},S=e.$.extend({},n.defaultHorizontalPos,C),b=t.flag(t.Flags.View.PROTECT_EVENTS),w=b?["click","mousedown","mouseup"]:[];w&&w.length>0&&(c=o.setupEventProtection(r,w,c));var _=e.$("<div></div>");e.ko.bindingHandlers.template.update(_[0],a,s,u,c),p&&i.ctTreatForCollisions(r,_),v&&v.active&&i.ctAdjustScale(r,_,v,u,f),S&&S.active&&i.ctAdjustHorizontalPosition(r,_,S),g&&i.squareResizeWithOffsets(r,_,m);var O=function(){y&&t.forItemOrMany(y,function(t){return e.$(r.contentDocument.head).append(e.$("<link rel='stylesheet' href='"+t+"'></link>"))}),e.$(r.contentDocument.body).append(_)};t.setExponentialInterval(function(){r.contentDocument&&r.contentDocument.body&&!r.contentDocument.body.hasChildNodes()&&O()},100)},o.setupEventProtection=function(e,n,r){var o=new c(n),i=r.extend({eventRegistry:o}),a="IFRAME"==e.tagName.toUpperCase()?e.contentWindow:e;return t.Col.of(n).each(function(e){a.addEventListener(e.trim(),function(t){t||(t=window.event);var n=t.target;o.triggerEvent(n,e,t),t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()},!0)}),i},o}(t.RootClass),c=function(){function e(e){this.handlers=[],this.coveredEvents=e}return e.prototype.registerEventHandler=function(e,r,o){if(t.StaticCol.contains(this.coveredEvents,r)){var i=n.generateGuid(9);return this.handlers.push({element:e,eventName:r,handler:o,id:i}),i}return null},e.prototype.removeEventHandler=function(e){var n=this.handlers.length;return this.handlers=t.Col.of(this.handlers).where(function(t){return t.id!=e}).toArray(),this.handlers.length<n},e.prototype.triggerEvent=function(e,n,r){for(var o=e,i=t.Col.of(this.handlers).where(function(e){return e.eventName==n});o;){var a=i.where(function(e){return e.element==o});if(a.length()>0)return a.each(function(e){e.handler(r)}),null;o=o.parentElement}return null},e}(),l=function(e){function n(t){e.call(this),this.originalEventBindingHandler=t}return __extends(n,e),n.prototype.init=function(e,n,r,o,i){if(i.eventRegistry){var a=n()||{},o=i.$data;t.StaticCol.hashEach(a,function(t,n){var r=function(e){return n.apply(o,[o,e])};i.eventRegistry.registerEventHandler(e,t,r)})}return this.originalEventBindingHandler.init(e,n,r,o,i)},n}(t.RootClass)}(n=t.Common||(t.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(FO){var Shared;!function(Shared){var Common;!function(Common){var ExternalResources=function(){function ExternalResources(){}return ExternalResources.getJQuery=function(e){return ExternalResources.patchExternalOrFallback("//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js",-2041667497,ExternalResources.patchJQuery,e+"jquery-1.11.1.js",ExternalResources.verifyJQuery).then(function(){window.FO.$=window.$.noConflict(!0),ExternalResources.extendJQuery()})},ExternalResources.extendJQuery=function(){FO.$.expr[":"].Contains=FO.$.expr.createPseudo(function(e){return function(t){return(t.textContent||t.innerText||"").toUpperCase().indexOf(e.toUpperCase())>=0}})},ExternalResources.patchJQuery=function(e){var t=',"function"==typeof define&&define.amd&&define("jquery",[],function(){return m})',n=e.replace(t,"");if(n.length!=e.length-t.length)throw new Error("Replace didnt take effect");return n},ExternalResources.verifyJQuery=function(){return"1.11.1"===window.$.fn.jquery},ExternalResources.getKnockout=function(e){return ExternalResources.patchExternalOrFallback("//cdnjs.cloudflare.com/ajax/libs/knockout/3.3.0/knockout-min.js",-1013341204,ExternalResources.patchKnockout,e+"knockout-3.3.0.js",ExternalResources.verifyKnockout)},ExternalResources.patchKnockout=function(e){var t='"function"===typeof define&&define.amd?define(["exports","require"],p):"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?p(module.exports||exports):p(y',n='p(window["FO"]',r=e.replace(t,n);if(r.length!=e.length-t.length+n.length)throw new Error("Replace didnt take effect");return r},ExternalResources.verifyKnockout=function(){return"3.3.0"==FO.ko.version},ExternalResources.patchExternalOrFallback=function(e,t,n,r,o){return void 0===o&&(o=function(){return!0}),ExternalResources.loadAndPatchExternal(e,t,n).then(function(){if(!o())throw new Error("External patch failed verification on "+e)}).alwaysThen(function(t,n){return n?(Shared.Logger.warn("Failed external patching on "+e+": "+n.message),ExternalResources.loadFallback(r).then(function(){if(!o())throw new Error("External fallback failed on "+r)})):Shared.resolve(null)})},ExternalResources.loadAndPatchExternal=function(externalUrl,verificationHash,patch){return Common.NativeJSHelper.nativeAjax(externalUrl).then(function(original){var originalHash=Common.stringHash(original);if(originalHash!=verificationHash)throw new Error("Original didnt match verification hash");var patched=patch(original);eval(patched)})},ExternalResources.loadFallback=function(e){return Common.NativeJSHelper.injectScriptRetryPromise(e,3)},ExternalResources}();Common.ExternalResources=ExternalResources}(Common=Shared.Common||(Shared.Common={}))}(Shared=FO.Shared_0_0_1214||(FO.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.xhr=function(e,t,n){var r=new XMLHttpRequest;if(r.open("get",e),t)for(var o in t)r.setRequestHeader(o,t[o]);r.onreadystatechange=function(){4==r.readyState&&200==r.status&&n&&n(r.responseText)},r.send(null)},t.xhrPromise=function(n,r){return void 0===r&&(r=null),e.promiseFromCallback(function(e){return t.xhr(n,r,e)})},t.imgGetPromise=function(t){return(new Image).src=t,e.resolve("")},t.getBrowser=function(){var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?(e=/\brv[ :]+(\d+)/g.exec(t)||[],"MSIE "+(e[1]||"")):"Chrome"===n[1]&&(e=t.match(/\bOPR\/(\d+)/),null!=e)?"Opera "+e[1]:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n.join(" "))},t}();t.AjaxHelper=n;var r=function(){function e(e){this.name="MagicStore",this.endpoint=e}return e.prototype.store=function(e,t){var r=this.endpoint+"?key="+encodeURIComponent(e),o={"X-Data":t,"Cache-control":"no-cache"};return n.xhrPromise(r,o)},e.prototype.retrieve=function(e){var t=this.endpoint+"?key="+encodeURIComponent(e);return n.xhrPromise(t)},e.prototype.isStoreAvailable=function(){return 0==n.getBrowser().indexOf("Chrome")},e.prototype.isRetrieveAvailable=function(){return 0==n.getBrowser().indexOf("Chrome")},e}();t.MagicStore=r;var o=function(){function t(e,t){this.name="ServerCookieStore",this.endpoint=e,this.domain=t}return t.prototype.store=function(e,t){var r=this.endpoint+"/set/logo.png?key="+encodeURIComponent(e)+"&value="+encodeURIComponent(t)+"&t="+(new Date).getTime();return n.imgGetPromise(r)},t.prototype.retrieve=function(t){for(var n=t+"=",r=document.cookie.split(";"),o=0;o<r.length;o++){for(var i=r[o];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(n)){var a=i.substring(n.length,i.length);return e.resolve(decodeURIComponent(a))}}return e.resolve("")},t.prototype.isStoreAvailable=function(){return!0},t.prototype.isRetrieveAvailable=function(){return document.location.host.indexOf(this.domain)>=0},t}();t.ServerCookieStore=o;var i=function(){function t(e){void 0===e&&(e=".fastimagecdn.com"),this.testKey="testKey",this.testValue="TestValueForSomething",this.naValue="NA";var t=new r("//app"+e+"/distore/store"),n=new o("//app"+e+"/distore/cookie",e);this.stores=[t,n]}return t.prototype.setValue=function(t,n){var r=[];return this.stores.forEach(function(e){e.isStoreAvailable()&&r.push(e.store(t,n))}),e.typedWhen(r)},t.prototype.getMultiValue=function(t){var n=this,r={};return this.stores.forEach(function(o){r[o.name]=o.isRetrieveAvailable()?o.retrieve(t):e.resolve(n.naValue)}),e.namedWhen2(r,!0).then(function(e){return e})},t.prototype.testSet=function(e){var t=this;this.setValue(this.testKey,this.testValue).then(function(){e&&t.testGetInner("psset")})},t.prototype.testGet=function(){this.testGetInner("psget")},t.prototype.clkGet=function(){var n={},r="",o=this.getMultiValue(this.testKey).then(function(e){for(var t in e)n["test_"+t]=e[t]}),i=this.getMultiValue("psclk").then(function(e){for(var t in e)n["clk_"+t]=e[t],e[t]&&"NA"!=e[t]&&(r=e[t])});return e.when(o,i).done(function(){t.notifyGeneric("psget",n)}).fail(function(e){t.notifyGeneric("psgeterror",{error:e.message})}),i.then(function(){return r})},t.prototype.testGetInner=function(e){this.getMultiValue(this.testKey).then(function(n){t.notifyGeneric(e,n)})},t.notifyGeneric=function(t,n){void 0===n&&(n={});var r={t:(new Date).getTime().toString(),hn:document.location.host,subtype:t};for(var o in n)r[o]=n[o];e.Logger.Analytics.notifyGenericUrl("//app.fastimagecdn.com/a/generic/logo.png",r)},t}();t.Persistance=i}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(e){function t(t,n,r,o){e.call(this,t,t.countryCode(),t.userSettings(),t.suspender(),t.iframe(),t.fnWindow()),this.productName=n,this.logic=r,this.visual=o}return __extends(t,e),t.prototype.notificationParams=function(){var t=e.prototype.notificationParams.call(this);return t.pname=this.productName,t.pr=this.logic.flag(),t.w=this.visual.flag(),t},t}(e.ApplicationContext);e.ProductContext=t}(t=e.Context||(e.Context={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.prototype.retrieveItem=function(e){var t=localStorage.getItem(e);try{t=JSON.parse(t)}catch(n){}return t},t.prototype.retrieve=function(t){var n=this.retrieveItem(t);return e.resolve(n)},t.prototype.retrieveOrSet=function(t,n){var r=this.retrieveItem(t);return"undefined"!=typeof r&&null!=r||(r=n,this.store(t,n)),e.resolve(r)},t.prototype.store=function(e,t){localStorage.setItem(e,JSON.stringify(t))},t}();t.LocalStore=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}));
}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function n(){this.words=[]}return n.prototype.push=function(e,t,n){void 0===n&&(n=1);for(var r=0;r<e.length;r++)this.words.push({word:e[r],origin:t,count:n})},n.prototype.contains=function(e){for(var t=0;t<this.words.length;t++)if(this.words[t].word==e)return!0;return!1},n.prototype.pushAndAmplify=function(t,n,r){var o=this;void 0===r&&(r=1),e.Col.of(t).each(function(e){var t=r>0||o.contains(e);t&&o.words.push({word:e,origin:n,count:Math.abs(r)})})},n.prototype.getWords=function(){e.Logger.log(this.describe());for(var t=[],n=0;n<this.words.length;n++)for(var r=this.words[n],o=0;o<r.count;o++)t.push(r.word);return t},n.prototype.getWordMap=function(){return e.Col.of(this.words).groupBy(function(e){return e.word}).toMap(function(e){return e.key},function(t){return e.Col.of(t.value).sum(function(e){return e.count})})},n.prototype.describe=function(){var n="Words: ";return e.Col.of(this.words).groupBy(function(e){return e.word+"|"+e.origin}).select(function(t){return[t.value[0].word,t.value[0].origin,e.Col.of(t.value).sum(function(e){return e.count})]}).orderByDesc(function(e){return Number(e[2])}).each(function(e){return n+=t.stringFormat("\n{0} ({1} x {2})",e[0],e[1],e[2])}),n},n.prototype.describeAmplifiedPath=function(){var n="Words: ",r={};return e.Col.of(this.words).orderByDesc(function(e){return Number(e.count)}).each(function(e){if(r.hasOwnProperty(e.word)){var t=r[e.word];t.count+=e.count,t.path+="->"+e.origin}else r[e.word]={word:e.word,path:e.origin,count:e.count}}),e.StaticCol.hashEach(r,function(e,r){n+=t.stringFormat("\n{0} ({1} x {2})",r.word,r.path,r.count)}),n},n}();t.WordCounter=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.getPriceByClass=function(){for(var t=document.querySelectorAll(".price, .current-price, .product_price"),n=0;n<t.length;n++){var r=e.splitPrice(t[n].innerText);if(r&&r.fullPrice)return r}return null},e.splitPrice=function(t){"string"!=typeof t&&(t=""+t),t=t.replace(/[\n\t ]/gi,""),t=t.replace(/(<([^>]+)>)/gi,""),t=t.replace(/<.+/g,"");var n,r,o,i,a=/([\$\u00A3\u20AC\u0440\u0192\u00A5\u20B1]|usd|eur|ils|r|rs|rp|){1,2}\.?/gi;t||(n=0,r=0,l="");var s,u,c=t.match(a),l=c?c[0]:"",d=t.replace(a,""),p=d.indexOf("."),f=d.indexOf(",");return p==-1&&f==-1?(n=e.strToNumber(d),r=0):(s=Math.max(p,f),u=d[s]||(p>f?".":","),d=d.replace(/ /g,""),d.length-s<=3?(o=d.split(u),n=e.strToNumber(o[0]),r=e.strToNumber(o[1])):(n=e.strToNumber(d),r=0)),i=parseFloat(n+"."+r),0==n&&0==r?null:{round:n,cents:r,sign:l,fullPrice:i}},e.strToNumber=function(e){if(!e)return 0;var t=/[0-9]+([,.][0-9]+)?/gi,n=e.match(t),r=n?n.join(""):"",o=r.length?parseFloat(r):0;return o},e}();e.PriceUtils=t}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function n(){}return n.getOgTitle=function(){if(document.querySelectorAll('[property="og:title"]').length&&document.querySelectorAll('[property="og:title"]')[0].attributes.content){var e=document.querySelectorAll('[property="og:title"]')[0].attributes.content.value;return t.WordUtils.getNonTrivialWords(e).join(" ")}return null},n.getOgPrice=function(){var e=document.querySelectorAll('[property="product:price:amount"]');if(e.length&&e[0].attributes.content)return e[0].attributes.content.value;if(e=document.querySelectorAll('[itemprop="price"]'),e.length){var n=t.PriceUtils.splitPrice(e[0].innerText);return n.fullPrice}var n=t.PriceUtils.getPriceByClass();return n&&n.fullPrice?n.fullPrice:-1},n.getOgCurrency=function(){return document.querySelectorAll('[property="product:price:currency"]').length&&document.querySelectorAll('[property="product:price:currency"]')[0].attributes.content?document.querySelectorAll('[property="product:price:currency"]')[0].attributes.content.value:null},n.getOgType=function(){return document.querySelectorAll('[property="og:type"]').length&&document.querySelectorAll('[property="og:type"]')[0].attributes.content?document.querySelectorAll('[property="og:type"]')[0].attributes.content.value:null},n.getOgFields=function(){if(document.querySelectorAll('[property="og:type"]').length){for(var e=[],t=document.querySelectorAll("[property]"),n=0;n<t.length;n++)if(t[n].attributes.property){var r=t[n].attributes.property.value;r.indexOf("og:")>-1&&e.push(r)}return e.join("|")}return null},n.ogExist=function(){if(document.querySelector("[property='og:type']")&&document.querySelector("[property='og:type']").attributes.content&&document.querySelector("[property='og:type']").attributes.content.value){var e=document.querySelector("[property='og:type']").attributes.content.value.toLowerCase();switch(e){case"product":case"video.other":case"og%3Aproduct":return!0}}return!1},n.getOgStat=function(){if(this.ogExist()){var e={exist:!0,title:this.getOgTitle(),ogType:this.getOgType(),fields:this.getOgFields()};return e}return null},n.getOG=function(){try{if(this.ogExist()){var e={name:this.getOgTitle(),price:this.getOgPrice(),currency:this.getOgCurrency()};return null!=e.name?e:null}return null}catch(t){return console.error(t),null}},n.getOgRequest=function(n){var r=null,o=new Date,i=this.getOG();if(null!=i){var a=i.name.toLowerCase().split(" "),s=t.ScrapingLogics.ogScrape(n,a);r={wordCounts:s,price:i.price,source:"og"}}var u=(new Date).getTime()-o.getTime();return e.Logger.log("og-scrape-time: "+u+"ms"),n.pushNotificationParam("ogScrpTime",u.toString()),r},n}();t.OpenGraph=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function n(){}return n.imageScrapeLogic=function(e,r){var o=t.ImageUtils.findValidImagesBySize(0,4,!1);return n.imageScrapeLogicWithSupporting(e,r,o)},n.imageScrapeLogicWithSupporting=function(n,r,o){var i,a=new Date,s=n.scraper(),u=["search","here","keyword","keywords","product","products","username","email","password","enter"],c=["q","Search","search","searchterm","searchTerm","search_query","query","Keywords","keywords","field-keywords","w","kw","origkw","SearchString","searchString","keys","text","Ntt","qu","Keyword","keyword","SearchTerms","searchTerms"],l=10,d=n.overrides().intValue("deal-scrape-weights.search",8),p=n.overrides().intValue("deal-scrape-weights.text",1),f=n.overrides().intValue("deal-scrape-weights.title",6),g=n.overrides().intValue("deal-scrape-weights.importantqs",20),m=n.overrides().intValue("deal-scrape-weights.otherqs",1),h=new t.WordCounter,v=t.ImageUtils.getImageText(r);if(v){var y=t.WordUtils.getNonTrivialWords(v);h.push(y,"Product Image",l);var C=t.WordUtils.getNonTrivialWords(document.title),S=e.StaticCol.intersect(y,C);if(h.push(S,"Product Image And Title Intersect",f),o){for(var b=0;b<o.length;b++)if(r!=o[b]){var w=t.ImageUtils.getImageText(o[b]);if(w){var _=t.WordUtils.getNonTrivialWords(w),O=e.StaticCol.intersect(y,_);h.push(O,"Extra image word intersection",l)}}var E=document.querySelectorAll("input[type='search']"),F=e.StaticCol.select(e.StaticCol.numValues(E),function(e){return e.value}).join(" "),P=t.WordUtils.getNonTrivialWords(F);if(0==e.StaticCol.intersect(P,u).length){var R=e.StaticCol.intersect(y,P);h.push(R,"Search inputs",d)}var D=document.querySelectorAll("input[type='text']"),k=e.StaticCol.select(e.StaticCol.numValues(D),function(e){return e.value}).join(" "),A=t.WordUtils.getNonTrivialWords(k);if(0==e.StaticCol.intersect(A,u).length){var T=e.StaticCol.intersect(y,A);h.push(T,"Text inputs",p)}var x=[],I=[];for(var L in s.queryParams())if(e.StaticCol.contains(c,L)){var N=s.queryParams()[L];x=x.concat(N.replace(/\+/g," ").trim().split(" "))}else{var N=s.queryParams()[L];I=I.concat(N.replace(/\+/g," ").trim().split(" "))}var B=e.StaticCol.intersect(y,x);h.push(B,"Recognized query string",g);var M=e.StaticCol.intersect(y,I);h.push(M,"Unknown query string",m)}var H=n.overrides().boolValue("deals-logic.filter-empty-words",!0),V=e.StaticCol.where(h.getWords(),function(e){return H?!e.match(/^[\s]*$/):!e.match(/^[\W_]*$/)}),W=t.WordUtils.countWords(V);i=W}else i=e.Map.emptyMap();var U=(new Date).getTime()-a.getTime();return e.Logger.log("Ribbon Scrape Time: "+U+"ms"),n.pushNotificationParam("ribbonScrapeTime",U.toString()),i},n.entirePageScrape=function(n,r,o){var i=["search","here","keyword","keywords","product","products","username","email","password","enter"],a=["q","Search","search","searchterm","searchTerm","search_query","query","Keywords","keywords","field-keywords","w","kw","origkw","SearchString","searchString","keys","text","Ntt","qu","Keyword","keyword","SearchTerms","searchTerms","_nkw"],s=n.overrides().intValue("deal-scrape-weights-amplify.ribbon",10),u=n.overrides().intValue("deal-scrape-weights-amplify.search",8),c=n.overrides().intValue("deal-scrape-weights-amplify.importantqs",20),l=n.overrides().intValue("deal-scrape-weights-amplify.text",1),d=n.overrides().intValue("deal-scrape-weights-amplify.h1",6),p=n.overrides().intValue("deal-scrape-weights-amplify.title",6),f=n.overrides().intValue("deal-scrape-weights-amplify.otherqs",1),g=n.overrides().intValue("deal-scrape-weights-amplify.dedicated",6),m=n.scraper(),h=new t.WordCounter,v=[],y=t.ImageUtils.getImageText(r);y&&(v=t.WordUtils.getNonTrivialWords(y));var C=document.querySelectorAll("input[type='search']"),S=e.StaticCol.select(e.StaticCol.numValues(C),function(e){return e.value}).join(" "),b=t.WordUtils.getNonTrivialWords(S),w=e.StaticCol.intersect(b,i).length?[]:b,_=[],O=[];for(var E in m.queryParams()){var F=m.queryParams()[E].split(/[+| ]/);if(e.StaticCol.contains(a,E))for(var P=0;P<F.length;P++)_.push(F[P]);else for(var P=0;P<F.length;P++)O.push(F[P])}var R=[];o&&(R=o.wordCounts.selectMany(function(t){return e.StaticCol.repeatString(t.key,t.value)}).toArray());var D=m.getFirstMatchText(["h1"],null,!0),k=t.WordUtils.getNonTrivialWords(D),A=t.WordUtils.getNonTrivialWords(document.title),T=document.querySelectorAll("input[type='text']"),x=e.StaticCol.select(e.StaticCol.numValues(T),function(e){return e.value}).join(" "),I=t.WordUtils.getNonTrivialWords(x),L=e.StaticCol.intersect(I,i).length?[]:I,N=[];N.push({keywords:v,weight:s,source:"Product Image"}),N.push({keywords:A,weight:p,source:"Title"}),N.push({keywords:k,weight:d,source:"H1"}),N.push({keywords:O,weight:f,source:"unknown query string"}),N.push({keywords:R,weight:g,source:"Dedicated keywords"}),N.push({keywords:_,weight:c,source:"Recognized query string"}),N.push({keywords:L,weight:l,source:"Text inputs"}),N.push({keywords:w,weight:u,source:"Search inputs"});var B=new e.Col(N),M=B.orderByDesc(function(e){return e.weight}).toArray();e.StaticCol.each(M,function(e){h.pushAndAmplify(e.keywords,e.source,e.weight)}),e.Logger.log(h.describe());var H=e.StaticCol.where(h.getWords(),function(e){return!e.match(/^[\s]*$/)}),V=t.WordUtils.countWords(H);return V},n.schemaOrgScrape=function(n,r,o){var i=n.scraper(),a=new t.WordCounter,s=n.overrides().intValue("deal-scrape-weights-amplify.h1",6),u=n.overrides().intValue("deal-scrape-weights-amplify.title",6),c=i.getFirstMatchText(["h1"],null,!0),l=t.WordUtils.getNonTrivialWords(c),d=t.WordUtils.getNonTrivialWords(document.title),p=[];p.push({keywords:r,weight:20,source:"SchemaOrg"}),p.push({keywords:o,weight:5,source:"SchemaBrand"}),p.push({keywords:d,weight:u,source:"Title"}),p.push({keywords:l,weight:s,source:"H1"});var f=new e.Col(p),g=f.orderByDesc(function(e){return e.weight}).toArray();e.StaticCol.each(g,function(e){a.pushAndAmplify(e.keywords,e.source,e.weight)}),e.Logger.log(a.describe());var m=e.StaticCol.where(a.getWords(),function(e){return!e.match(/^[\s]*$/)}),h=t.WordUtils.countWords(m);return h},n.searchTextScrape=function(r,o,i,a,s){void 0===i&&(i=""),void 0===a&&(a=!1),void 0===s&&(s=100);for(var u=r.scraper(),c=(new Date).getTime(),l=new t.WordCounter,d=0;d<o.length;d++)for(var p=o[d].selector,f=o[d].weight,g=u.getInnerTextFromElements(p),m=0;m<g.length;m++){var h=g[m].element,v=g[m].text,y=v.replace(/\s+/g," ").split(" "),C=parseFloat(window.getComputedStyle(h).getPropertyValue("font-size")),S=u.getPhrasesFromElements(y),b=u.getPhrasesFromElementsNLP(v);n.addPhrasesToWC(S,p,l,0,C,f),n.addPhrasesToWC(b,"NLP",l,1,C,f)}return e.Logger.info("Scraping took: "+((new Date).getTime()-c).toString()),e.Logger.info(l.describeAmplifiedPath()),l.getWordMap().orderByDesc(function(e){return e.value}).select(function(e){return e.key}).take(s).toArray()},n.addPhrasesToWC=function(e,n,r,o,i,a){for(var s=0;s<e.length;s++){var u=e[s];t.DefaultPageScraper.isUpperCasePhrase(u)?r.pushAndAmplify([u],"Uppercase: "+u.length,2*u.length):t.DefaultPageScraper.isCapitalizedPhrase(u)&&r.pushAndAmplify([u],"Capitalized: "+u.length,2*u.length),r.pushAndAmplify([u],"Font: "+i,i),r.pushAndAmplify([u],"Selector: "+n,a),r.pushAndAmplify([u],"Source : "+n,o)}},n.ogScrape=function(n,r){var o=n.scraper(),i=new t.WordCounter,a=n.overrides().intValue("deal-scrape-weights-amplify.h1",6),s=n.overrides().intValue("deal-scrape-weights-amplify.title",6),u=o.getFirstMatchText(["h1"],null,!0),c=t.WordUtils.getNonTrivialWords(u),l=t.WordUtils.getNonTrivialWords(document.title),d=[];d.push({keywords:r,weight:20,source:"OG"}),d.push({keywords:l,weight:s,source:"Title"}),d.push({keywords:c,weight:a,source:"H1"});var p=new e.Col(d),f=p.orderByDesc(function(e){return e.weight}).toArray();e.StaticCol.each(f,function(e){i.pushAndAmplify(e.keywords,e.source,e.weight)}),e.Logger.log(i.describe());var g=e.StaticCol.where(i.getWords(),function(e){return!e.match(/^[\s]*$/)}),m=t.WordUtils.countWords(g);return m},n}();t.ScrapingLogics=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(){function r(){}return r.createFrag=function(){var e=document.querySelectorAll("[itemtype='http://schema.org/Product']");return e.length||(e=document.querySelectorAll("[itemtype='https://schema.org/Product']")),e.length||(e=document.querySelectorAll("[itemtype='//schema.org/Product']")),e.length?e[0]:null},r.findLowerChild=function(e){if(e){for(e.querySelectorAll("[itemtype]").length;e.querySelectorAll("[itemtype]").length;)e=e.querySelectorAll("[itemtype]")[0]}return e},r.justText=function(t){return e.$(t).clone().children().remove().end().text()},r.getNodeSchemaProp=function(e){var t=[],n=e.querySelectorAll("[itemprop]");if(n.length){for(var r=0;r<n.length;r++){var o,i=n[r].attributes.itemprop.value;n[r].attributes.content?""!==n[r].attributes.content.value&&(o=n[r].attributes.content.value):o=n[r].innerText,o&&null==t[i]&&(t[i]=o.replace(/(\r\n|\n|\r)/gm,"").trim())}return t}return null},r.getNodeSchema=function(e){var t=[];if(e.attributes.itemtype){var n=e.attributes.itemtype.value;n=n.substr(n.lastIndexOf("/")+1),t[n]=this.getNodeSchemaProp(e),e.removeAttribute("itemtype")}return t},r.getNextParentNode=function(e){for(var t;e.parentNode;)if(e=e.parentNode,t=e.querySelectorAll("[itemtype]"),t.length)return t[0];return null},r.totalSchema=function(e){for(var t=[],n=[],r=this.findLowerChild(e);r;){n=this.getNodeSchema(r);var o=Object.keys(n)[0];o in t||(t[o]=n[o]),r=this.getNextParentNode(r)}return t},r.getSchemaStat=function(){try{if(this.schemaExist()){var e=this.createFrag(),t=this.totalSchema(e),n={exist:!0,name:this.getProductName(t),price:this.getPrice(t),currency:this.getCurrency(t),fields:this.getSchemaTypes(t)};return n}}catch(r){return console.error(r),null}},r.getSchema=function(){try{if(this.schemaExist()){var e=this.createFrag(),n=this.totalSchema(e),r={name:this.getProductName(n),price:this.getPrice(n),currency:this.getCurrency(n),brand:this.getBrand(n)};return null!=r.name&&null!=r.price?r:null}return null}catch(o){return t.Logger.warn("Failed to get Schema: "+o.message),null}},r.getSchemaRequest=function(e){var o=null,i=new Date,a=r.getSchema();if(null!=a){var s=a.name.toLowerCase().split(" "),u=[];a.brand&&(u=a.brand.toLowerCase().split(" "));var c=n.ScrapingLogics.schemaOrgScrape(e,s,u);o={wordCounts:c,price:a.price,source:"schema"}}var l=(new Date).getTime()-i.getTime();return t.Logger.log("schema-scrape-time: "+l+"ms"),e.pushNotificationParam("schemaScrpTime",l.toString()),o},r.schemaExist=function(){return!!this.getSchemaElement()},r.getSchemaElement=function(){var e=document.querySelector("[itemtype='http://schema.org/Product']");return e||(e=document.querySelector("[itemtype='https://schema.org/Product']")),e||(e=document.querySelector("[itemtype='//schema.org/Product']")),e},r.ld_jsonExist=function(){return e.$('script[type="application/ld+json"]').length>0},r.getCurrency=function(e){return e.Offer&&e.Offer.priceCurrency?e.Offer.priceCurrency:null},r.getProductName=function(e){var t=null;return e.Product&&(e.Product.name?t=e.Product.name:e.Product.ProductName&&(t=e.Product.ProductName)),t?n.WordUtils.getNonTrivialWords(t).join(" "):null},r.getSchemaTypes=function(e){var t="";for(var n in e)t=""==t?n:t+", "+n;return t},r.getPrice=function(e){var t="";if(!t.length&&e.AggregateOffer&&(e.AggregateOffer.highPrice?t=e.AggregateOffer.highPrice:e.AggregateOffer.lowPrice?t=e.AggregateOffer.lowPrice:e.AggregateOffer.price&&(t=e.AggregateOffer.price)),!t.length&&e.Offer&&(e.Offer.price?t=e.Offer.price:e.Offer.lowPrice?t=e.Offer.lowPrice:e.Offer.highPrice&&(t=e.Offer.highPrice)),!t.length&&e.Product&&(e.Product.price?t=e.Product.price:e.Product.lowPrice?t=e.Product.lowPrice:e.Product.highPrice&&(t=e.Product.highPrice)),!t.length&&e.AggregateOffer&&(e.AggregateOffer.highPrice?t=e.AggregateOffer.highPrice:e.AggregateOffer.lowPrice?t=e.AggregateOffer.lowPrice:e.AggregateOffer.price&&(t=e.AggregateOffer.price)),""!==t)return n.PriceUtils.strToNumber(t);var r=n.PriceUtils.getPriceByClass();return r&&r.fullPrice?r.fullPrice:-1},r.getBrand=function(e){return e.Brand&&e.Brand.name?e.Brand.name:null},r}();n.SchemaOrg=r}(n=t.Common||(t.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.getCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "==o.charAt(0);)o=o.substring(1);if(o.indexOf(t)!=-1)return o.substring(t.length,o.length)}return""},t.setCookie=function(e,t,n,r){var o="";n&&(new Date((new Date).getTime()+24*n*60*60*1e3).toUTCString(),o="; expires="+new Date((new Date).getTime()+24*n*60*60*1e3).toUTCString());var i="";r&&(i="; domain="+r),document.cookie=e+"="+t+o+"; path=/"+i},t.setBackendClickCookie=function(t,n){void 0===n&&(n={});try{var r=t.paths().notifyRoot()+"/c/clk/logo.png",o=t.paths().domain();if(r+="?",r=r+"&domain="+encodeURIComponent(o),n)for(var i in n){var a=n[i]+"";r=r+"&"+i+"="+encodeURIComponent(a)}e.Logger.Analytics.notifyGenericUrl(r)}catch(s){}},t.serverSetCookie=function(t,n,r){var o="//"+r+"/cookie/set?type=json&action=appand";e.Logger.Analytics.notifyGenericUrl(o,{key:t,value:n,t:(new Date).getTime().toString()})},t}();t.CookieUtils=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(){function r(){}return r.storeImpressionKeywords=function(e,t,n){void 0===n&&(n=""),r.storeKeywords(e,t,r.RT_IMPRESSIONS_KEY,n)},r.storeClickKeywords=function(e,t,o){void 0===o&&(o="");var i=r.storeKeywords(e,t,r.RT_CLICKS_KEY,o);n.CookieUtils.setBackendClickCookie(e,{clk:i})},r.storeKeywords=function(e,r,o,i){var a=localStorage.getItem(o),s=a?JSON3.parse(a):[],u={keywords:r.split(" "),when:(new Date).getTime()};return"api-dedicated"!=i&&"api-product-boxes"!=i&&"api-schema"!==i&&"api-og"!==i||n.CookieUtils.serverSetCookie(o,JSON3.stringify(u),e.paths().apiRoot()),s.push(u),s=t.Col.of(s).orderByDesc(function(e){return e.when}).take(10).toArray(),a=JSON3.stringify(s),localStorage.setItem(o,a),a},r.storeClickKeywordsToCookie=function(e,t,n){r.storeKeywordsToCookie(e,t,r.RT_CLICKS_KEY,n)},r.storeImpressionKeywordsToCookie=function(e,t,n){r.storeKeywordsToCookie(e,t,r.RT_IMPRESSIONS_KEY,n)},r.storeKeywordsToCookie=function(e,r,o,i){var a,s=n.CookieUtils.getCookie(o);try{s=s?decodeURIComponent(s):"",a=s?JSON3.parse(s):[]}catch(u){t.Logger.warn("error in Json.Parse on "+s),a=[]}a.push({keywords:r.split(" "),when:(new Date).getTime()}),a=t.Col.of(a).orderBy(function(e){return e.when}).take(10).toArray(),s=JSON3.stringify(a),n.CookieUtils.setCookie(o,s,365,i)},r.getRetargetingKeywordsFromLocalStorage=function(e){var t=r.readRecentKewwordsFromSource(r.RT_IMPRESSIONS_KEY),n=r.readRecentKewwordsFromSource(r.RT_CLICKS_KEY);return r.getRetargetingKeywords(e,t,n)},r.getRetargetingKeywordsFromCookie=function(e){var t=r.readRecentKewwordsFromCookieSource(r.RT_IMPRESSIONS_KEY),n=r.readRecentKewwordsFromCookieSource(r.RT_CLICKS_KEY);return r.getRetargetingKeywords(e,t,n)},r.readRecentKewwordsFromSource=function(e){var n=((new Date).getTime(),localStorage.getItem(e)),r=n?JSON3.parse(n):[];return t.Col.of(r).orderByDesc(function(e){return e.when})},r.readRecentKewwordsFromCookieSource=function(e){var r=((new Date).getTime(),n.CookieUtils.getCookie(e)),o=r?JSON3.parse(r):[];return t.Col.of(o).orderByDesc(function(e){return e.when})},r.getRetargetingKeywords=function(e,n,o){var i=t.flag(t.Flags.Retargeting.OLDALGO);return i?r.getRetargetingKeywords_OldAlgo(e,n,o):r.getRetargetingKeywords_new(e,n,o)},r.getRetargetingKeywords_new=function(r,o,i){var a=t.flag(t.Flags.Retargeting.WEIGHT_TYPE),s=t.flag(t.Flags.Retargeting.WEIGHT_AGE),u=t.flag(t.Flags.Retargeting.WEIGHT_PAGEMATCH),c=t.flag(t.Flags.Retargeting.WEIGHT_WORDREPEAT),l=o.select(function(e){return{keywords:e.keywords,when:e.when,typeScore:0,ageScore:null,repeatScore:null,matchScore:null,normTypeScore:null,normAgeScore:null,normRepeatScore:null,normMatchScore:null,totalScore:null}}),d=i.select(function(e){return{keywords:e.keywords,when:e.when,typeScore:1,ageScore:null,repeatScore:null,matchScore:null,normTypeScore:null,normAgeScore:null,normRepeatScore:null,normMatchScore:null,totalScore:null}}),p=l.mergeCol(d);if(0==p.length())return[];var f=p.minBy(function(e){return e.when}).when,g=p.selectMany(function(e){return e.keywords}).groupBy(function(e){return e}).toHashmap2(function(e){return e.key},function(e){return e.value.length}),m=e.$("body").text(),h=t.StaticCol.aggregate(m.split(/\W+/gi),{},function(e,t){return e.length>0&&(t[e]=e in t?t[e]+1:1),t});p.each(function(e){e.ageScore=(e.when-f)/(1e3*n.DAY_SECONDS),e.repeatScore=t.StaticCol.sum(e.keywords,function(e){return g[e]}),e.matchScore=t.StaticCol.sum(e.keywords,function(e){return e in h?h[e]:0})}),p.normalize(function(e){return e.ageScore},function(e,t){return e.normAgeScore=t}),p.normalize(function(e){return e.typeScore},function(e,t){return e.normTypeScore=t}),p.normalize(function(e){return e.repeatScore},function(e,t){return e.normRepeatScore=t}),p.normalize(function(e){return e.matchScore},function(e,t){return e.normMatchScore=t}),p.each(function(e){e.totalScore=e.normTypeScore*a+e.normAgeScore*s+e.normRepeatScore*c+e.normMatchScore*u});var v=p.orderByDesc(function(e){return e.totalScore}).firstOrValue(null);return v.keywords},r.getRetargetingKeywords_OldAlgo=function(e,n,o){var i={};n.each(function(e){t.Col.of(e.keywords).each(function(e){i[e]=i[e]?i[e]+=1:1})}),o.each(function(e){t.Col.of(e.keywords).each(function(e){i[e]=i[e]?i[e]+=2:2})});var a=n.select(function(e,n){var o=t.StaticCol.sum(e.keywords,function(e){return i[e]}),a=o*(r.POSITION_WEIGHT+n);return{keywords:e.keywords,score:a}}),s=o.select(function(e,n){var o=t.StaticCol.sum(e.keywords,function(e){return i[e]}),a=o*(r.POSITION_WEIGHT+n);return{keywords:e.keywords,score:a}}),u={keywords:[],score:0},c=a.orderByDesc(function(e){return e.score}).firstOrValue(u),l=s.orderByDesc(function(e){return e.score}).firstOrValue(u);return c.score>l.score?c.keywords:l.keywords},r.RT_CLICKS_KEY="fo-rt-clk",r.RT_IMPRESSIONS_KEY="fo-rt-imp",r.POSITION_WEIGHT=8,r}();n.Retargeting=r}(n=t.Common||(t.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.clickDataFromDeal=function(t){var n={};if(n.p=t.part,n.kwds=t.keywords,t.url.indexOf("af_placement_id=")>-1)try{var r=t.url;n.plid=r.match(/af_placement_id=([^&]+)/)[1]}catch(o){e.Logger.info("Bad parse of placmentID"),n.plid="0"}return t.title&&(n.title=t.title.substring(0,40)),t.price&&(n.prc=t.price),t.isFvmOffer&&(n.fvmOffer="1"),t.merchantId&&(n.mid=t.part+"-"+t.merchantId),n},t}();t.DealHelper=n}(t=e.Data||(e.Data={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.pruneQueryData=function(t,n){var r=e.Col.of(t.kwc).where(function(t){return!e.StaticCol.contains(n,t.w)}),o=t.t;e.Col.of(n).each(function(e){var t=new RegExp("\\b"+e+"\\b");o=o.replace(t,"")}),o=o.replace(/\s+/g," ").trim();var i=r.orderBy(function(e){return o.indexOf(e.w)});return{kwc:i.toArray(),t:o,clientPrice:t.clientPrice,source:t.source}},t.pruneTooManyKeywords=function(n,r){var o=e.Col.of(n.kwc).orderByDesc(function(e){return e.c}),i=o.skip(r).select(function(e){return e.w}).toArray();return t.pruneQueryData(n,i)},t.pruneKeywordsAboveHighestHalf=function(n){var r=e.Col.of(n.kwc).orderByDesc(function(e){return e.c}),o=r.length()>0?r.getItem(0).c:0,i=o/2,a=r.where(function(e){return e.c>=i}),s=Math.max(t.MIN_WORDS,a.length()),u=r.skip(s).select(function(e){return e.w}).toArray();return t.pruneQueryData(n,u)},t.pruneKeywordsTopCounts=function(n){var r=e.Col.of(n.kwc).orderByDesc(function(e){return e.c}),o=r.take(t.MIN_WORDS),i=r.skip(o.length()).select(function(e){return e.w}).toArray();return t.pruneQueryData(n,i)},t.pruneKeywordsToOverMedian=function(n){var r=e.Col.of(n.kwc).orderByDesc(function(e){return e.c}),o=Math.max(t.MIN_WORDS,Math.ceil(r.length()/2));if(o<r.length()){var i=r.getItem(o).c,a=r.where(function(e){return e.c<i}).select(function(e){return e.w}).toArray();return t.pruneQueryData(n,a)}return n},t.logQueryData=function(t){var n=e.Col.of(t.kwc).select(function(e){return e.w+" ("+e.c+")"}).stringJoin(" ");e.Logger.info("Requesting offers with\nSource:\t"+t.source+"\nPrice:\t"+t.clientPrice+"\nKwds:\t"+n+"\n")},t.queryApiForRt=function(e,n,r,o,i,a,s,u){o&&o.t||(o={kwc:[],t:"",clientPrice:-1,source:"be-rt"});var c={sendWithCookies:!0,beRetargetType:i,skipVerify:!0,redirectUrl:a,rdbase:s,proxyUrl:u};return t.queryApiWithOptions(e,n,r,o,c)},t.queryApiWithOptions=function(e,n,r,o,i){return t.queryApi(e,n,r,o,i.sendWithCookies,i.beRetargetType,i.skipVerify,i.minMatch,i.redirectUrl,i.proxyUrl,i.rdbase)},t.queryApi=function(n,r,o,i,a,s,u,c,l,d,p){if(i=t.pruneTooManyKeywords(i,10),t.logQueryData(i),!u){if(this.queryContainsOnlyNumbers(i))return e.Logger.warn("Query contains only numbers: "+i.t),e.resolve({offers:[],source:i.source});if(this.queryContainsLessThanTwoKeywords(i))return e.Logger.warn("Query contains less than 2 words: "+i.t+" price: "+i.clientPrice),e.resolve({offers:[],source:i.source})}var f=e.Logger.Reporting.resolveReportingProduct(n.logic().flag(),n.visual.flag()),g={rootUrl:n.paths().apiRoot(),base64Data:encodeURIComponent(e.Common.Base64.encode(JSON3.stringify(i))),partnerId:n.params().partnerCode,countryCode:n.countryCode().toLowerCase(),hostName:n.host(),offers:r,apiContext:o,rp:f,proxyUrl:d},m=e.flag(e.Flags.Deals.USE_FVM)?"&fvm=true":"",h="/o/1234/{base64Data}?partid={partnerId}&hn={hostName}&offers={offers}&c={countryCode}&rp={rp}"+m;d?(h="{proxyUrl}"+h+"&fwhost={rootUrl}",g.rootUrl=encodeURIComponent(g.rootUrl)):h="{rootUrl}"+h;var v=e.Common.namedStringFormat(h,g);return null!=n.params().subId&&(v=v+"&subid="+n.params().subId),null!=o&&(v=v+"&context="+o),s&&(v=v+"&rt="+s),p&&(v+="&rdbase="+p),c&&(v=v+"&minm="+c),(l||p)&&(v+="&encodeUrl=true"),e.jqGetPromise(v,1e4,a).then(function(e){var r,o=JSON3.parse(e),a=null;o.some(function(e){return a=e.rtType,!!e.rtType})?(r="be-rt",n.pushNotificationParam("rtType",a)):r=i.source;var s={offers:o,source:r};return window.FO_OFFERS_TEST?t.testData:s})},t.queryContainsOnlyNumbers=function(e){return 0==e.t.replace(/[0-9]/g,"").trim().length},t.queryContainsLessThanTwoKeywords=function(e){return e.kwc.length<2},t.queryFromData=function(t,n,r){if(void 0===r&&(r=!1),r&&!(n.price>0))return null;var o=n.wordCounts.select(function(e){return{w:e.key,c:e.value}}).toArray(),i=e.StaticCol.select(o,function(e){return e.w}).join(" ");return{kwc:o,t:i,clientPrice:n.price,source:"api-"+n.source}},t.queryFromRetargeting=function(t){var n=e.Common.Retargeting.getRetargetingKeywordsFromLocalStorage(t);if(0==n.length)return{kwc:[],t:"",clientPrice:-1,source:"rt"};var r=e.StaticCol.select(n,function(e){return{w:e,c:1}}),o={kwc:r,t:n.join(" "),clientPrice:-1,source:"rt"};return o},t.queryFromGenericKeywords=function(t,n){var r=e.StaticCol.select(t,function(e){return{w:e,c:1}}),o={kwc:r,t:t.join(" "),clientPrice:-1,source:n};return o},t.dealsFromOffers=function(n,r){var o=n.paths().outerResourcesRoot()+"/empty_merchant.jpg",i=n.overrides().boolValue("deals.default-merchant-image",!1),a=e.Col.of(r).orderByDesc(function(e){return e.rank}).select(function(e,r){var a=t.generateFakeData(e);e.begrp&&n.pushNotificationParam("begrp",e.begrp);var s={title:e.title,price:e.price,thumb:e.images?e.images:e.largeImage,url:e.url.indexOf("?")==-1?e.url+"?safepassage=1":e.url+"&safepassage=1",merchantThumb:e.merchantImage||!i?e.merchantImage:o,merchantText:e.merchant,ribbon:0==r?"Best Deal":"",part:e.part,isFvmOffer:e.isFvmOffer,keywords:e.keywords,rtType:e.rtType,begrp:e.begrp,freeShipping:e.freeShipping,attribution:e.attribution,onClick:e.onClick,merchantId:e.merchantId,originalPrice:a.originalPrice,discount:a.discount,rating:a.rating};return s});return a.toArray()},t.generateFakeData=function(n){var r=Math.abs(e.Common.stringHash(n.price)),o=Math.abs(e.Common.stringHash(n.title)),i=(1+r%1e3)/1e3,a=(1+o%1e3)/1e3,s=.6+.4*a,u=e.flag(e.Flags.Deals.USE_FAKE_DATA),c=t.extractPriceValueAndPattern(n.price);if(u&&c&&c.value==parseFloat(n.priceNum)){var l=i<.6?.333*i:0,d=Math.round(100*l),p=Math.floor(c.value*(1+l))+.99,f=e.Common.stringFormat(c.pattern,p);return{originalPrice:f,discount:d,rating:s}}return u?(e.Logger.info("Failed parsing for discount: "+n.price),{originalPrice:n.price,discount:0,rating:s}):{originalPrice:n.price,discount:0,rating:s}},t.extractPriceValueAndPattern=function(e){var t=e.split(/&[#\d]+;/).join(""),n=t.match(/\d+(?:[ ,\.]\d+)*/);if(!n||0==n.length)return null;var r=n[0],o=r.match(/^(.*?)(?:[ ,\.](\d{1,2}))?$/),i=o[1].split(/[ ,\.]/).join(""),a=o[2],s=i+"."+a,u=parseFloat(s),c=e.replace(r,"{0}");return{pattern:c,value:u}},t.testData={offers:[{url:"http://rd.bizrate.com/rd?t=http%3A%2F%2Fwww.sierratradingpost.com%2Fnew-balance-3190v2-running-shoes-for-women%7Ep%7E106WN%2F%3Fkc%3DPCZILLAUS6%26utm_source%3DShopzilla_BizRate%26utm_medium%3DPaidShopping%26utm_term%3DNew_Balance_3190V2_Running_Shoes_For_Women%26utm_campaign%3DPCZILLAUS6&mid=30669&cat_id=10110000&atom=10330&prod_id=&oid=6675824600&pos=1&b_id=18&bid_type=8&bamt=8e6fc9110ff780c3&cobrand=1&ppr=1856865955e247a6&rf=af1&af_assettype_id=12&af_creative_id=2932&af_id=577081&af_placement_id=23058027&dv=ecc542f5f1e5d608b4c2ae0a5596fcf8",merchant:"Sierra Trading Post",merchantImage:"http://img11.bizrate-images.com/merchant/30669.gif",title:"New Balance 3190V2 Running Shoes (For Women)  SILVER W/PURPLE TURQUOISE",images:"http://d1-pub.bizrate.com/resize?sq=123&uid=6675824600",largeImage:"http://d1-pub.bizrate.com/resize?sq=123&uid=6675824600",price:"$49.95",priceNum:"49.95",freeShipping:!1,rank:2905000003e4,part:"2005",keywords:"nike womens flex 2014 rn running shoe",as:0,begrp:"gr02"},{url:"http://rd.bizrate.com/rd?t=http%3A%2F%2Fwww.sierratradingpost.com%2Fnew-balance-490v3-running-shoes-for-women%7Ep%7E109CU%2F%3Fkc%3DPCZILLAUS6%26utm_source%3DShopzilla_BizRate%26utm_medium%3DPaidShopping%26utm_term%3DNew_Balance_490V3_Running_Shoes_For_Women%26utm_campaign%3DPCZILLAUS6&mid=30669&cat_id=10110000&atom=10330&prod_id=&oid=6675855554&pos=1&b_id=18&bid_type=8&bamt=8e6fc9110ff780c3&cobrand=1&ppr=1b4353e67bed4a7f&rf=af1&af_assettype_id=12&af_creative_id=2932&af_id=577081&af_placement_id=6140340&dv=ecc542f5f1e5d608b4c2ae0a5596fcf8",
merchant:"Sierra Trading Post",merchantImage:"http://img11.bizrate-images.com/merchant/30669.gif",title:"New Balance 490V3 Running Shoes (For Women)  PINK",images:"http://d3-pub.bizrate.com/resize?sq=123&uid=6675855554",largeImage:"http://d3-pub.bizrate.com/resize?sq=123&uid=6675855554",price:"$39.95",priceNum:"39.95",freeShipping:!1,rank:2905000003e4,part:"2005",keywords:"nike womens flex 2014 rn running shoe",as:0,begrp:"gr02"},{url:"http://rd.bizrate.com/rd?t=http%3A%2F%2Fwww.sierratradingpost.com%2Fdynafit-pantera-trail-running-shoes-for-women%7Ep%7E9386A%2F%3Fkc%3DPCZILLAUS6%26utm_source%3DShopzilla_BizRate%26utm_medium%3DPaidShopping%26utm_term%3DDynafit_Pantera_Trail_Running_Shoes_For_Women%26utm_campaign%3DPCZILLAUS6&mid=30669&cat_id=10110000&atom=10330&prod_id=&oid=6318234114&pos=1&b_id=18&bid_type=8&bamt=8e6fc9110ff780c3&cobrand=1&ppr=0aa33deb4fefa093&rf=af1&af_assettype_id=12&af_creative_id=2932&af_id=577081&af_placement_id=14269585&dv=ecc542f5f1e5d608b4c2ae0a5596fcf8",merchant:"Sierra Trading Post",merchantImage:"http://img11.bizrate-images.com/merchant/30669.gif",title:"Dynafit Pantera Trail Running Shoes (For Women)  CACTUS",images:"http://d3-pub.bizrate.com/resize?sq=123&uid=6318234114",largeImage:"http://d3-pub.bizrate.com/resize?sq=123&uid=6318234114",price:"$59.96",priceNum:"59.96",freeShipping:!1,rank:2905000003e4,part:"2005",keywords:"nike womens flex 2014 rn running shoe",as:0,begrp:"gr02"}],source:"TestData"},t.MIN_WORDS=7,t}();t.OffersApi=n}(t=e.Data||(e.Data={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(){function r(){}return r.calculateProductBoxes=function(r,o){void 0===r&&(r=null),void 0===o&&(o=!1);var i=new n.ScraperBase,a=n.CustomHelper.retrieveSettings(document.location.href);return a.then(function(a){var s=e.$.extend({},n.defaultPBSettings,a,r),u=s.useCustom?i.customScrape(document.documentElement,s.custom,null,o):null,c=s.useGeneric?i.genericScrape(document.documentElement,s.generic,!1):t.Col.empty(),l=c,d=u?l.mergeCol(u.boxes):c;return d})},r.simpleAnalyze=function(e,t){return void 0===t&&(t=!1),r.analyze(e,null,t)},r.analyze=function(t,o,i){void 0===o&&(o=null),void 0===i&&(i=!1);var a=n.CustomHelper.retrieveSettings(document.location.href);return a.then(function(a){var s=e.$.extend({},n.defaultPBSettings,a,o);return r.analyzeInner(s,t,i)})},r.analyzeInner=function(e,o,i){var a=new n.ScraperBase,s=e.useCustom?a.customScrape(document.documentElement,e.custom,o,i):null,u=e.useGeneric?a.genericScrape(document.documentElement,e.generic,!1):t.Col.empty(),c=u,l=s?c.mergeCol(s.boxes):u,d=r.classify(l);if(d.pageType!=t.Classification.PageType.ProductPage){var p=a.attemptAltMainProductBox(u,i);if(p){var f=l.merge([p]);i&&console.log("Found alt main product box. reclassifying",p),d=r.classify(f)}}return i&&console.log("Classification "+t.Classification.PageType[d.pageType]+": "+d.typeReason),d},r.classify=function(e){var n,o=null,i=null,a=window.innerWidth*window.innerHeight,s=e.orderByDesc(function(e){return e.area}),u=s.getItem(0),c=u?u.area:0;if(0==s.length())n={type:t.Classification.PageType.Irrelevant,reason:"No boxes found"};else if(1==e.length())n=c/a>.3?{type:t.Classification.PageType.ProductPage,reason:"Single box, large relative to window"}:{type:t.Classification.PageType.Weird,reason:"Single box, small relative to window"};else{var l=s.getItem(1),d=l.area;if(c/a>.3&&d/c<.8)n={type:t.Classification.PageType.ProductPage,reason:"First box larger than second AND is large relative to window"};else if(d/c<.6)n={type:t.Classification.PageType.ProductPage,reason:"Second largest box is relatively smaller than first"};else{var p=s.where(function(e){return e.area/c>=.8});n=p.length()>=Math.min(4,s.length())?{type:t.Classification.PageType.ListPage,reason:"Four biggest boxes roughly same size"}:{type:t.Classification.PageType.Weird,reason:"Four biggest boxes differ in size"}}}if(n.type==t.Classification.PageType.ProductPage&&(o=s.getItem(0)),n.type==t.Classification.PageType.ListPage&&(i=r.resolveSearchBox(),i&&(n={type:t.Classification.PageType.SearchPage,reason:"List page + found search box"})),s.length()>0){var f=s.select(function(e){return t.Common.VisualHelper.getElementPosWithOffsets(e.element)}).orderBy(function(e){return e.top}).getItem(0);f&&f.top>window.innerHeight&&(n={type:t.Classification.PageType.BelowFoldListPage,reason:"List page + top boxes bellow the fold"})}return{boxes:s,mainBox:o,searchBox:i,pageType:n.type,typeReason:n.reason}},r.resolveSearchBox=function(){var n=t.Col.ofJQueryElements(e.$('input[type="search"], input[type="text"], input[class*="search"]')),r=n.where(function(e){return e.offsetTop<200}).orderByDesc(function(t){return e.$(t).width()}),o=r.firstOrValue(null);return o&&o.value?{element:o,text:o.value}:null},r}();n.ProductBoxesAnalyzer=r}(n=t.ProductBoxes||(t.ProductBoxes={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(e,t,n){this.context=e,this.oldKeywords=t,this.oldPrice=n}return t.prototype.reportUnfulfilledCustom=function(t){e.Logger.Analytics.notify(this.context,e.Logger.Analytics.GENERIC,{subtype:"pb_missedcustom",selector_name:t.name},.01)},t.prototype.reportResult=function(t,n,r,o){var i=this.keywordsMapToString(t),a=this.keywordsMapToString(this.oldKeywords);e.Logger.log("Product boxes keywords: "+i),e.Logger.Analytics.notify(this.context,e.Logger.Analytics.GENERIC,{subtype:"pb_result",oldkeywords:a,oldprice:this.oldPrice.toString(),pbkeywords:i,pbprice:n.toString(),pagetype:e.Classification.PageType[r],pbreason:o,winsize:window.innerWidth+"x"+window.innerHeight},.01)},t.prototype.keywordsMapToString=function(e){var n=e.orderByDesc(function(e){return e.value}).take(t.MAX_WORDS).toMap(function(e){return e.key},function(e){return e.value}),r=e.where(function(e){return n.containsKey(e.key)}).select(function(e){return e.key}).stringJoin(".");return r},t.MAX_WORDS=10,t}();t.NotifyReporter=n}(t=e.ProductBoxes||(e.ProductBoxes={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){this.conditionGroups=[]}return t.prototype.select=function(e){var t=new r(e,this);return this.conditionGroups.push(t),t},t.prototype.result=function(){var t=e.Col.of(this.conditionGroups).select(function(t){return function(){return t.isPositive().then(function(n){return null!=n?e.resolve({name:n,value:t.value}):e.resolve(null)})}}).toArray();return e.waterfall(t)},t}();t.ConditionStack=n;var r=function(){function t(e,t){this.conditions=[],this.value=e,this.conditionStack=t}return t.prototype.where=function(e,t){return void 0===t&&(t=""),this.conditions.push({title:t,condition:e}),this},t.prototype.select=function(e){return this.conditionStack.select(e)},t.prototype.isPositive=function(){var t=e.resolve(null);return e.Col.of(this.conditions).select(function(n){var r=n.condition,o="function"==typeof r?r():r,i=e.resolve(!0).then(function(){return o}).then(function(e){return e?n.title:null});t=t.then(function(e){return null!=e?e:i})}),t},t}()}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){function r(){return t.Common.VersionSingletone.perform("classification",o)}function o(){var e=t.ProductBoxes.ProductBoxesAnalyzer.calculateProductBoxes(),n=e.then(function(e){return i(e)});return n}function i(e){var r=new t.Common.ConditionStack,o=window.innerWidth*window.innerHeight,i="/"!==window.location.pathname,s=e.orderByDesc(function(e){return e.area}),u=s.length()>=1&&s.getItem(0),c=s.length()>=2&&s.getItem(1),l=u?u.area/o:0,d=c?c.area/u.area:0,p=s.where(function(e){return e.area/u.area>=.75}),f=p.length()>=6,g=u&&u.rect&&c&&c.rect&&Math.abs(u.rect.top-c.rect.top)<10,m=u.height/u.width<2&&!g&&p.length()>=2,h=e.minBy(function(e){return e.rect.top}),v=a(),y=e.distinct(function(e){return e.width.toString()}),C=1==y.length()&&y.getItem(0).width/document.body.clientWidth>.4,S=/cart|basket/i.test(window.location.href);r.select(n.PageType.ProductPage).where(i&&l>.3&&d<1.01,"Box large relative to window").where(i&&c&&d<.6,"Box larger than second").select(n.PageType.CartPage).where(C&&S).select(n.PageType.SearchPage).where((m||f)&&null!=v,"Same sized top items (3+), above fold, SearchBox found").select(n.PageType.ListPage).where(f&&h.rect.top<window.innerHeight,"Same sized top items (6+), above fold").where(m,"Same sized top items (2+), above fold and high/width < 1 (vertical product boxes").select(n.PageType.BelowFoldListPage).where(f&&h.rect.top>=window.innerHeight,"Same sized top items (3+), bellow fold").select(n.PageType.HomePage).where(!i,"The url has no path").select(n.PageType.Weird).where(e.length()>0,"Boxes found but cant match page type").select(n.PageType.Irrelevant).where(!0,"Fallen back to Irrelevant");var b=r.result(),w=e.multiOrderBy(.8,function(e){return-e.area},function(e){return e.rect.top},function(e){return e.rect.left}),_=w.firstOrValue(null);return b.then(function(e){return{boxes:s,mainBox:_,searchBox:v,pageType:e.value,typeReason:e.name}})}function a(){var n=t.Col.ofJQueryElements(e.$('input[type="search"], input[type="text"], input[class*="search"]')),r=n.where(function(e){return e.offsetTop+(e.offsetParent?e.offsetParent.offsetTop:0)<200}).orderByDesc(function(t){return e.$(t).width()}),o=r.firstOrValue(null),i=o&&(!o.placeholder||o.placeholder!=o.value);return o&&o.value&&i?{element:o,text:o.value}:null}n.classification=r}(n=t.Classification||(t.Classification={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.Scrape=function(n){var r=new Date,o=e.Classification.classification().then(function(o){var i=t.scrapePBKeywords_new(o,null),a=i[0],s=i[1],u=e.StaticCol.where(a.getWords(),function(e){return!e.match(/^[\s]*$/)});n.pushNotificationParam("pbwords",u.join("."));var c=e.Common.WordUtils.countWords(u),l=(new Date).getTime()-r.getTime();return e.Logger.log("pb-scrape-time: "+l+"ms"),n.pushNotificationParam("pbScrpTime",l.toString()),{wordCounts:c,price:s,source:"product-boxes"}});return o},t.scrapePBKeywords_new=function(t,n){var r=new e.Common.WordCounter,o=-1;if(t.pageType!=e.Classification.PageType.Irrelevant){if(t.boxes&&t.boxes.length()>0){var i=t.boxes.orderBy(function(e){return e.rect.left}).stableOrderBy(function(e){return e.rect.top}).stableOrderByWithThreshold(.8,function(e){return-e.area}),a=i.getItem(0);r.pushAndAmplify(e.Common.WordUtils.getNonTrivialWords(a.mainText),"MainBox",1),o=a.price.value,i.skip(1).take(3).each(function(t){return r.pushAndAmplify(e.Common.WordUtils.getNonTrivialWords(t.mainText),"SupportBoxes",-1)})}t.searchBox&&t.searchBox.text&&r.pushAndAmplify(e.Common.WordUtils.getNonTrivialWords(t.searchBox.text),"SearhBox",-2)}return n&&n.reportResult(r.getWordMap(),o,t.pageType,t.typeReason),[r,o]},t.scrapePBKeywords_OLD=function(t,n){var r=new e.Common.WordCounter,o=-1;switch(t.pageType){case e.Classification.PageType.ProductPage:var i=e.Common.WordUtils.getNonTrivialWords(t.mainBox.mainText);r.push(i,e.Classification.PageType[t.pageType]),o=t.mainBox.price.value;break;case e.Classification.PageType.SearchPage:case e.Classification.PageType.ListPage:var a=t.boxes.groupBy(function(e){return(800*Math.round(e.area/800)).toString()}).orderByDesc(function(e){return e.value.length}).select(function(e){return e.value}).getItem(0),s=e.Col.of(a).take(7),u=s.selectMany(function(t){return e.Common.WordUtils.getNonTrivialWords(t.mainText)}).toArray();r.push(u,e.Classification.PageType[t.pageType]),t.pageType==e.Classification.PageType.SearchPage&&r.push(t.searchBox.text.split(" "),"Search Text",4),o=s.avg(function(e){return e.price.value});break;case e.Classification.PageType.BelowFoldListPage:var c=t.boxes.orderBy(function(t){return e.Common.ImageUtils.distanceFromViewPortCenter(t.element)}).getItem(0);r.push(e.Common.WordUtils.getNonTrivialWords(c.mainText),e.Classification.PageType[t.pageType]),o=c.price.value;break;case e.Classification.PageType.Weird:var c=t.boxes.orderBy(function(e){return Math.sqrt(e.rect.top*e.rect.top+e.rect.left*e.rect.left)}).getItem(0);r.push(e.Common.WordUtils.getNonTrivialWords(c.mainText),e.Classification.PageType[t.pageType]),o=c.price.value}return n&&n.reportResult(r.getWordMap(),o,t.pageType,t.typeReason),[r,o]},t}();t.ProductBoxesDataGenerator=n}(t=e.ProductBoxes||(e.ProductBoxes={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(){}return t.SchemaScrape=function(t){return e.VersionSingletone.perform("SchemaScrape",t)},t.OgScrape=function(t){return e.VersionSingletone.perform("OgScrape",t)},t.PbScrape=function(t){return e.VersionSingletone.perform("PbScrape",t)},t.RegularScrape=function(t){return e.VersionSingletone.perform("RegularScrape",t)},t.RetargetScrape=function(t){return e.VersionSingletone.perform("RetargetScrape",t)},t}();e.SingletoneScrapingWrapper=t}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(){function r(){}return r.prototype.flag=function(){return"pp"},r.prototype.checkRTFlag=function(){return!0},r.prototype.updateLastQuery=function(e){},r.prototype.dataKey=function(){return"CommerceDeals"},r.prototype.supportsStickyClassification=function(){return!0},r.prototype.getProxyUrl=function(){return""},r.prototype.isStrict=function(){return!1},r.prototype.mustHavePrice=function(){return!1},r.prototype.enableScrape=function(){return!0},r.prototype.classify=function(e){return t.flag(t.Flags.CLASSIFICATION.ALLWAYS_CLASSIFY)?t.resolve({name:"allways_classified",value:.5}):t.namedWaterfall([{name:"specialcase",value:function(){return t.Vertical.CommerceHelper.specialCase(e)}},{name:"bwl",value:function(){return t.Vertical.CommerceHelper.blackWhiteList(e)}},{name:"schemaorg",value:function(){return t.Vertical.CommerceHelper.schemaOrg(e)}},{name:"baddict",value:function(){return t.Vertical.CommerceHelper.disqualifyingDictionaries(e)}},{name:"gooddict",value:function(){return t.Vertical.CommerceHelper.qualifyingDictionaries(e)}},{name:"ribbon",value:function(){return t.Vertical.CommerceHelper.productImage(e)}}],function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},r.prototype.classificationType=function(){return n.ClassificationType.COMMERCE},r.prototype.scrapeAndObtainData=function(e,n,o){var i,a=this,s=e.overrides().value("commerce-context",null),u=this.shouldUseRedirect(),c=this.redirectUrl(),l=2*n.primaryCount+n.secondaryCount,d=[],p=function(){t.Logger.log("using schema");var n=t.Common.SchemaOrg.getSchemaRequest(e),r=n?t.Data.OffersApi.queryFromData(e,n,a.mustHavePrice()):null;a.updateLastQuery(r);var o=r?t.Data.OffersApi.queryApiWithOptions(e,l,s,r,{sendWithCookies:!0,beRetargetType:a.checkRTFlag()&&"standard"||"",redirectUrl:u,rdbase:c,proxyUrl:a.getProxyUrl()}):t.resolve({offers:[],source:"schema"});return o},f=e.overrides().boolValue("singletone.schema",!1);i=f?function(){return t.Common.SingletoneScrapingWrapper.SchemaScrape(p)}:p;var g,m=function(){t.Logger.log("using OG");var n=t.Common.OpenGraph.getOgRequest(e),r=n?t.Data.OffersApi.queryFromData(e,n,a.mustHavePrice()):null;a.updateLastQuery(r);var o=r?t.Data.OffersApi.queryApiWithOptions(e,l,s,r,{sendWithCookies:!0,beRetargetType:a.checkRTFlag()&&"standard"||"",redirectUrl:u,rdbase:c,proxyUrl:a.getProxyUrl()}):t.resolve({offers:[],source:"og"});return o},h=e.overrides().boolValue("singletone.og",!1);g=h?function(){return t.Common.SingletoneScrapingWrapper.OgScrape(m)}:m;var v,y=function(){t.Logger.log("using PB Scrape");var n=t.ProductBoxes.ProductBoxesDataGenerator.Scrape(e),r=n.then(function(n){var r=t.Data.OffersApi.queryFromData(e,n);return a.updateLastQuery(r),r});return r.then(function(n){return t.Data.OffersApi.queryApiWithOptions(e,l,s,n,{sendWithCookies:!0,beRetargetType:a.checkRTFlag()&&"standard"||"",redirectUrl:u,rdbase:c,proxyUrl:a.getProxyUrl()})})},C=e.overrides().boolValue("singletone.pb",!1);v=C?function(){return t.Common.SingletoneScrapingWrapper.PbScrape(y)}:y;var S,b=function(){t.Logger.log("using regular Scrape");var n=r.dataFromPageOrDedicated(e,!a.enableScrape()||a.isStrict()),o=n.then(function(n){var r=t.Data.OffersApi.queryFromData(e,n,a.mustHavePrice());return a.updateLastQuery(r),r});return o.then(function(n){return a.isStrict()?t.resolve({offers:[],source:"scrape"}):t.Data.OffersApi.queryApiForRt(e,l,s,n,a.checkRTFlag()&&"standard"||"",u,c,a.getProxyUrl())})},w=e.overrides().boolValue("singletone.regularScrape",!1);S=w?function(){return t.Common.SingletoneScrapingWrapper.RegularScrape(b)}:b;var _,O=function(){t.Logger.log("using Client retargeting");var n=t.Data.OffersApi.queryFromRetargeting(e);return t.Data.OffersApi.queryApiWithOptions(e,l,s,n,{redirectUrl:u,rdbase:c,proxyUrl:a.getProxyUrl()})},E=e.overrides().boolValue("singletone.clientretarget",!1);_=E?function(){return t.Common.SingletoneScrapingWrapper.RetargetScrape(O)}:O;var F=t.flag(t.Flags.Scrape.USE_SCHEMA);F&&d.push({name:"schema",value:i});var P=t.flag(t.Flags.Scrape.USE_OPENGRAPH);P&&d.push({name:"og",value:g});var R=t.flag(t.Flags.Scrape.USE_PB)&&this.enableScrape();R&&d.push({name:"pb",value:v});var D=t.flag(t.Flags.Scrape.USE_REGSCRAPE);D&&d.push({name:"scrape",value:S});var k=this.checkRTFlag()&&t.flag(t.Flags.Scrape.USE_RETARGET)&&!this.isStrict();k&&d.push({name:"rt",value:_});var A=t.namedWaterfall(d,function(e){return e&&e.offers&&e.offers.length>0},"ScrapingMethods"),T=A.then(function(r){t.Logger.info("Ended up using "+r.name);var i=r.value,s=e.logic().flag()+"_"+e.visual.flag(),u=o.claimUniques(i.offers,function(e){return e.url},s,n.primaryCount),c=o.cliamWithoutMarking(i.offers,function(e){return e.url},n.secondaryCount,u),l=u.concat(c),d=t.Data.OffersApi.dealsFromOffers(e,l);return d=a.filterResults(d),new t.Data.PlainDataResult(i.source,e,d)});return this.postProcessResults(e,T),T},r.prototype.filterResults=function(e){return e},r.prototype.shouldUseRedirect=function(){return t.flag(t.Flags.ENCODE_URL.ENCODE_CLICK_URL)},r.prototype.redirectUrl=function(){return t.flag(t.Flags.ENCODE_URL.REDIRECT_BASE_URL)},r.dataFromPageOrDedicated=function(e,n){var o=window.location.host,i=t.Common.DedicatedHelper.tryScrpaePageByDedicated(o,e);return i.alwaysThen(function(t,o){return r.scrapePage(e,t,n)})},r.scrapePage=function(e,n,o){return t.Common.VersionSingletone.perform(window.location.href,function(){return r.forceScrapePage(e,o,n)})},r.forceScrapePage=function(n,o,i){void 0===o&&(o=!1);var a=new Date,s=new e.NWPLegacy,u=r.getFirstImgElement(),c=i&&r.dedicatedKeywordsLooksValid(i),l=i&&r.dedicatedHasPrice(i),d={wordCounts:t.Map.emptyMap(),price:0,source:null};c?(n.pushNotificationParam("hasDedicated","1"),t.Logger.info("Using dedicated"),d.wordCounts=i.wordCounts,d.source="dedicated"):(i&&t.Logger.info("Using Dedicated as amlifier"),o||(t.Logger.info("Using generic scrape"),d.wordCounts=t.Common.ScrapingLogics.entirePageScrape(n,u,i),d.source="generic-scrape")),l?d.price=i.clientPrice.value:d.price=t.Common.DedicatedHelper.cleanPriceString(s.PriceUtils.getPrice(u)).value,d.price=d.price!=t.Common.DedicatedHelper.MAX_PRICE?d.price:-1;var p=(new Date).getTime()-a.getTime();return t.Logger.log("generic-scrp-time: "+p+"ms"),n.pushNotificationParam("generic-scrp-time",p.toString()),t.resolve(d)},r.getFirstImgElement=function(){var e=t.Common.ImageUtils.getFirstEcommerceImage(!0,!0);return e||(e=t.Common.ImageUtils.getFirstEcommerceImage(!0,!1)),e},r.prototype.postProcessResults=function(e,n){this.isStrict()||n.then(function(n){if(n.data.length){var r=n.data[0].keywords;t.Common.Retargeting.storeImpressionKeywords(e,r,n.source),t.StaticCol.each(n.data,function(r){r.onClick=function(){t.Common.Retargeting.storeClickKeywords(e,r.keywords,n.source);var o=new t.Common.Persistance;o.setValue("psclk",r.keywords).then(function(){(new Image).src="//secure.adnxs.com/seg?add=2785798&t=2",o.testSet(!1)})}})}})},r.dedicatedKeywordsLooksValid=function(e){var n=e.wordCounts.length()>1;return n||t.Logger.info("Dedicated result too small. Will ignore: "+JSON3.stringify(e)),n},r.dedicatedHasPrice=function(e){var n=e.clientPrice&&e.clientPrice.value!=t.Common.DedicatedHelper.MAX_PRICE;return n||t.Logger.info("Dedicated didn't find a price"),n},r.prototype.schemaStatstics=function(e){var n=t.Common.SchemaOrg.getSchemaStat();n?(e.pushNotificationParam("schema_name",n.name),e.pushNotificationParam("schema_price",String(n.price)),e.pushNotificationParam("schema_currency",n.currency),e.pushNotificationParam("schema_exist","1"),e.pushNotificationParam("schema_fields",n.fields)):e.pushNotificationParam("schema_exist","0"),t.Common.SchemaOrg.ld_jsonExist()?e.pushNotificationParam("ldjson_exist","1"):e.pushNotificationParam("ldjson_exist","0")},r.prototype.ogStatistics=function(e){var n=t.Common.OpenGraph.getOgStat();n?(e.pushNotificationParam("og_title",n.title),e.pushNotificationParam("og_Type",n.ogType),e.pushNotificationParam("og_fields",n.fields),e.pushNotificationParam("og_exist","1")):e.pushNotificationParam("og_exist","0")},r}();r.CommerceDealsLogic=o}(r=n.Logic||(n.Logic={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(){function r(){}return r.prototype.flag=function(){return"pp"},r.prototype.checkRTFlag=function(){return!0},r.prototype.dataKey=function(){return"CommerceDeals"},r.prototype.supportsStickyClassification=function(){return!0},r.prototype.getProxyUrl=function(){return""},r.prototype.isStrict=function(){return!1},r.prototype.mustHavePrice=function(){return!1},r.prototype.shouldUseRedirect=function(){return t.flag(t.Flags.ENCODE_URL.ENCODE_CLICK_URL)},r.prototype.redirectUrl=function(){return t.flag(t.Flags.ENCODE_URL.REDIRECT_BASE_URL)},r.prototype.classify=function(e){return t.flag(t.Flags.CLASSIFICATION.ALLWAYS_CLASSIFY)?t.resolve({name:"allways_classified",value:.5}):t.namedWaterfall([{name:"specialcase",value:function(){return t.Vertical.CommerceHelper.specialCase(e)}},{name:"bwl",value:function(){return t.Vertical.CommerceHelper.blackWhiteList(e)}},{name:"schemaorg",value:function(){return t.Vertical.CommerceHelper.schemaOrg(e)}},{name:"baddict",value:function(){return t.Vertical.CommerceHelper.disqualifyingDictionaries(e)}},{name:"gooddict",value:function(){return t.Vertical.CommerceHelper.qualifyingDictionaries(e)}},{name:"ribbon",value:function(){return t.Vertical.CommerceHelper.productImage(e)}}],function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},r.prototype.classificationType=function(){return n.ClassificationType.COMMERCE},r.prototype.scrapeAndObtainData=function(e,n,o,i){var a=this;void 0===i&&(i=!1);var s,u=e.overrides().value("commerce-context",null),c=this.shouldUseRedirect(),l=this.redirectUrl(),d=2*n.primaryCount+n.secondaryCount,p=[],f=function(){t.Logger.log("using schema");var n=t.Common.SchemaOrg.getSchemaRequest(e),r=n?t.Data.OffersApi.queryFromData(e,n,a.mustHavePrice()):null;window.tstResObj.push({source:"schema",requestData:n,query:r}),r&&(window["win-query"]=r);var o=t.resolve({offers:[],source:"schema"});return o},g=e.overrides().boolValue("singletone.schema",!1);s=g?function(){return t.Common.SingletoneScrapingWrapper.SchemaScrape(f)}:f;var m,h=function(){t.Logger.log("using OG");var n=t.Common.OpenGraph.getOgRequest(e),r=n?t.Data.OffersApi.queryFromData(e,n,a.mustHavePrice()):null;r&&!window["win-query"]&&(window["win-query"]=r),window.tstResObj.push({source:"openGraph",requestData:n,query:r});var o=t.resolve({offers:[],source:"og"});return o},v=e.overrides().boolValue("singletone.og",!1);m=v?function(){return t.Common.SingletoneScrapingWrapper.OgScrape(h)}:h;var y,C=function(){t.Logger.log("using PB Scrape");var n={source:"productBox",requestData:{},query:{}},r=t.ProductBoxes.ProductBoxesDataGenerator.Scrape(e),o=r.then(function(r){return n.requestData=r,t.Data.OffersApi.queryFromData(e,r)});return o.then(function(e){n.query=e,window.tstResObj.push(n),e&&!window["win-query"]&&(window["win-query"]=e);var r=t.resolve({offers:[],source:"pb"});return r})},S=e.overrides().boolValue("singletone.pb",!1);y=S?function(){return t.Common.SingletoneScrapingWrapper.PbScrape(C)}:C;var b,w=function(){t.Logger.log("using regular Scrape");var n={source:"dedicate",requestData:{},query:{}},o={source:"regularScrape",requestData:{},query:{}},a=r.dataFromPageOrDedicated(e,i),s=a.then(function(r){return n.requestData=r,o.requestData=window["tst-scrapper"],t.Data.OffersApi.queryFromData(e,r)});return s.then(function(r){n.query=r,o.query=t.Data.OffersApi.queryFromData(e,o.requestData),window.tstResObj.push(n),window.tstResObj.push(o);var i=t.resolve({offers:[],source:"rg"});return i})},_=e.overrides().boolValue("singletone.regularScrape",!1);b=_?function(){return t.Common.SingletoneScrapingWrapper.RegularScrape(w)}:w;var O,E=function(){t.Logger.log("using Client retargeting");var n=t.Data.OffersApi.queryFromRetargeting(e);return t.Data.OffersApi.queryApiWithOptions(e,d,u,n,{redirectUrl:c,rdbase:l,proxyUrl:a.getProxyUrl()})},F=e.overrides().boolValue("singletone.clientretarget",!1);O=F?function(){return t.Common.SingletoneScrapingWrapper.RetargetScrape(E)}:E,p.push({name:"schema",value:s}),p.push({name:"og",value:m}),i||p.push({name:"pb",value:y}),p.push({name:"scrape",value:b});var P=this.checkRTFlag()&&t.flag(t.Flags.Scrape.USE_RETARGET)&&!this.isStrict();P&&p.push({name:"rt",value:O});var R=t.namedWaterfall(p,function(e){return e&&e.offers&&e.offers.length>0},"ScrapingMethods"),D=R.then(function(r){t.Logger.info("Ended up using "+r.name);var i=r.value,a=e.logic().flag()+"_"+e.visual.flag(),s=o.claimUniques(i.offers,function(e){return e.url},a,n.primaryCount),u=o.cliamWithoutMarking(i.offers,function(e){return e.url},n.secondaryCount,s),c=s.concat(u),l=t.Data.OffersApi.dealsFromOffers(e,c);return new t.Data.PlainDataResult(i.source,e,l)});return this.postProcessResults(e,D),D},r.dataFromPageOrDedicated=function(e,n){var o=window.location.host,i=t.Common.DedicatedHelper.tryScrpaePageByDedicated(o,e);return i.alwaysThen(function(t,o){return r.scrapePage(e,n,t)})},r.scrapePage=function(e,n,o){return t.Common.VersionSingletone.perform(window.location.href,function(){return r.forceScrapePage(e,n,o)})},r.forceScrapePage=function(n,o,i){var a=new Date,s=new e.NWPLegacy,u=r.getFirstImgElement(),c=(i&&r.dedicatedKeywordsLooksValid(i),i&&r.dedicatedHasPrice(i)),l={wordCounts:t.Map.emptyMap(),price:0,source:null};n.pushNotificationParam("hasDedicated","1"),t.Logger.info("Using dedicated"),l.wordCounts=i.wordCounts,l.source="dedicated",l.price=c?i.clientPrice.value:-1,i?t.Logger.info("Using Dedicated as amlifier"):t.Logger.info("Using generic scrape");var d={wordCounts:t.Map.emptyMap(),price:-1,source:""};o||(d.wordCounts=t.Common.ScrapingLogics.entirePageScrape(n,u,i),d.source="generic-scrape",d.price=t.Common.DedicatedHelper.cleanPriceString(s.PriceUtils.getPrice(u)).value);var p=(new Date).getTime()-a.getTime();return t.Logger.log("generic-scrp-time: "+p+"ms"),window["tst-scrapper"]=d,n.pushNotificationParam("generic-scrp-time",p.toString()),t.resolve(l)},r.getFirstImgElement=function(){var e=t.Common.ImageUtils.getFirstEcommerceImage(!0,!0);return e||(e=t.Common.ImageUtils.getFirstEcommerceImage(!0,!1)),e},r.prototype.postProcessResults=function(e,n){this.isStrict()||n.then(function(n){if(n.data.length){var r=n.data[0].keywords;t.Common.Retargeting.storeImpressionKeywords(e,r,n.source),t.StaticCol.each(n.data,function(r){r.onClick=function(){t.Common.Retargeting.storeClickKeywords(e,r.keywords,n.source);var o=new t.Common.Persistance;o.setValue("psclk",r.keywords).then(function(){(new Image).src="//secure.adnxs.com/seg?add=2785798&t=2",o.testSet(!1)})}})}})},r.dedicatedKeywordsLooksValid=function(e){var n=e.wordCounts.length()>1;return n||t.Logger.info("Dedicated result too small. Will ignore: "+JSON3.stringify(e)),n},r.dedicatedHasPrice=function(e){var n=e.clientPrice.value&&e.clientPrice.value!=t.Common.DedicatedHelper.MAX_PRICE;return n||t.Logger.info("Dedicated didn't find a price"),n},r.prototype.schemaStatstics=function(e){var n=t.Common.SchemaOrg.getSchemaStat();n?(e.pushNotificationParam("schema_name",n.name),e.pushNotificationParam("schema_price",String(n.price)),e.pushNotificationParam("schema_currency",n.currency),e.pushNotificationParam("schema_exist","1"),e.pushNotificationParam("schema_fields",n.fields)):e.pushNotificationParam("schema_exist","0"),t.Common.SchemaOrg.ld_jsonExist()?e.pushNotificationParam("ldjson_exist","1"):e.pushNotificationParam("ldjson_exist","0")},r.prototype.ogStatistics=function(e){var n=t.Common.OpenGraph.getOgStat();n?(e.pushNotificationParam("og_title",n.title),e.pushNotificationParam("og_Type",n.ogType),e.pushNotificationParam("og_fields",n.fields),e.pushNotificationParam("og_exist","1")):e.pushNotificationParam("og_exist","0")},r}();r.CommerceDealsLogicTest=o}(r=n.Logic||(n.Logic={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.shouldUseRedirect=function(){return!0},t.prototype.scrapeAndObtainData=function(t,n,r){return t.overrides().forceSet("commerce-context","serp"),e.prototype.scrapeAndObtainData.call(this,t,n,r)},t}(e.CommerceDealsLogic);e.CommerceDealsSerpLogic=t}(t=e.Logic||(e.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.setCouponRevealed=function(e){var n=t.getCouponMarker(e);null==n&&(n={code:e,revealTimestamp:null,freshlyRevealed:null}),n.revealTimestamp=(new Date).getTime(),n.freshlyRevealed=!0,t.setCouponMarker(n)},t.setRevealedCouponSeen=function(e){var n=t.getCouponMarker(e);null==n&&(n={code:e,revealTimestamp:(new Date).getTime(),freshlyRevealed:null}),n.freshlyRevealed=!1,t.setCouponMarker(n)},t.createCouponMarker=function(e){var t=(new Date).getTime();return{code:e,revealTimestamp:t,freshlyRevealed:!0}},t.getCouponMarker=function(e){var t=null;try{var n=localStorage.getItem("cpn_rvl_"+e);return t=JSON3.parse(n),t.code?t:null}catch(r){}},t.setCouponMarker=function(e){var t=JSON3.stringify(e);localStorage.setItem("cpn_rvl_"+e.code,t)},t.setCouponRevealedMessage=function(e,n){t.setCouponsMessage("Coupon for "+n+" revealed. Copy / Paste '"+e+"' at checkout")},t.setCouponAppliedMessage=function(e,n){t.setCouponsMessage("Coupon for "+n+" has been applied. Enjoy!")},t.setCouponsMessage=function(e){localStorage.setItem("anounceCoupons",e)},t.pollCouponsMessage=function(){var e=localStorage.getItem("anounceCoupons");return e&&localStorage.removeItem("anounceCoupons"),e},t.copyTextToClipboard=function(t){var n=document.createElement("textarea");n.style.position="fixed",n.style.top="0",n.style.left="0",n.style.width="2em",n.style.height="2em",n.style.padding="0",n.style.border="none",n.style.outline="none",n.style.boxShadow="none",n.style.background="transparent",n.value=t,document.body.appendChild(n),n.select();var r="";try{var o=document.execCommand("copy");r=o?"successful":"unsuccessful",e.Logger.log("Copying text command was "+r)}catch(i){e.Logger.log("Oops, unable to copy")}return document.body.removeChild(n),"successful"==r},t}();t.CouponsHelper=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){
var n=function(){function t(){}return t.queryApi=function(n,r,o,i,a){var s=e.Logger.Reporting.resolveReportingProduct(n.logic().flag(),n.visual.flag()),u={rootUrl:n.paths().cachedApiRoot(),url:encodeURIComponent(o.join("|")),partnerId:n.params().partnerCode,countryCode:n.countryCode().toLowerCase(),hostName:encodeURIComponent(n.host()),limit:r,rp:s,proxyUrl:a.proxyUrl},c="/coupons/search?url={url}&hn={hostName}&partid={partnerId}&limit={limit}&c={countryCode}&rp={rp}";i&&(c+="&context="+i),a.rdbase&&(c+="&encodeUrl=true&rdbase="+a.rdbase),a.proxyUrl?(c="{proxyUrl}"+c+"&fwhost={rootUrl}",u.rootUrl=encodeURIComponent(u.rootUrl)):c="{rootUrl}"+c;var l=e.Common.namedStringFormat(c,u);return e.jqGetPromise(l).then(function(e){var n=JSON3.parse(e);return window.FO_COUPON_TEST?t.testData.coupon:n.coupon})},t.couponsFromCouponOffers=function(t){var n=e.StaticCol.select(t,function(t){var n=t.couponCode?e.Common.CouponsHelper.getCouponMarker(t.couponCode):null,r=(new Date).getTime(),o=n&&r-n.revealTimestamp<2*e.Common.HOUR_SECONDS*1e3,i={url:t.url,title:t.title,description:t.description,merchant:t.merchant,merchantImage:t.merchantImage,status:t.status?t.status:null,code:t.couponCode,revealed:o,isDirect:!t.couponCode,part:t.part?t.part:"na",partialCode:t.couponCode?t.couponCode.replace(/^../,"XX"):null};return i});return n},t.testData={coupon:[{title:"Extra 15% off Sitewide",merchantDisplayUrl:"http://www.jcpenney.com",merchant:"jcpenney",description:"Save additional 15% on your order when you apply the code at checkout, save up to 74%. Orders over $99 ship free. Excludes Sephora, Gift Cards, Services, Service Plans and other restrictions; see website for details.",score:15294,altTitle:"15% Off",fileName:"FirstOffer_US_Coupons_11102014.xml.gz",image:"http://cdn.savings.com/logo/4215555.png",couponCode:"AFFSHOP1",merchantImage:"http://cdn.savings.com/logo/4215555.png",url:"http://www.savings.com/m/p/22441821/7126168/c?afsrc=1&up=2014-11-10-02-40"},{title:"Extra 20% off All Orders Using Store Credit Card",merchantDisplayUrl:"http://www.jcpenney.com",merchant:"jcpenney",description:"Enter this code at checkout and get additional 20% discount on all orders using store credit card, get up to 40% total savings. Shipping is free on orders $99 or more. Restrictions may apply.",score:14842,altTitle:"20% Off",fileName:"FirstOffer_US_Coupons_11102014.xml.gz",image:"http://cdn.savings.com/logo/4215555.png",couponCode:"VAULT",merchantImage:"http://cdn.savings.com/logo/4215555.png",url:"http://www.savings.com/m/p/22441821/7733390/c?afsrc=1&up=2014-11-10-02-40"},{title:"Free Shipping on All Orders $99 or More",merchantDisplayUrl:"http://www.jcpenney.com",merchant:"jcpenney",description:"Get free shipping anywhere on orders of $99 or more. See website for details.",score:11663,fileName:"FirstOffer_US_Coupons_11102014.xml.gz",image:"http://cdn.savings.com/logo/4215555.png",merchantImage:"http://cdn.savings.com/logo/4215555.png",url:"http://www.savings.com/m/p/22441821/6848063/c?afsrc=1&up=2014-11-10-02-40"},{title:"10-15% off Apparel, Shoes, Accessories, Jewelry & Home",merchantDisplayUrl:"http://www.jcpenney.com",merchant:"jcpenney",description:"Save 15% off apparel, shoes, accessories,fine jewelry & home and 10% off watches, furniture, mattresses, custom blinds and shades. Restrictions apply. Orders over $99 ship free. Limited time offer.",score:2476,altTitle:"15% Off",fileName:"FirstOffer_US_Coupons_11102014.xml.gz",image:"http://cdn.savings.com/logo/4215555.png",couponCode:"FUNDEAL",merchantImage:"http://cdn.savings.com/logo/4215555.png",url:"http://www.savings.com/m/p/22441821/7121523/c?afsrc=1&up=2014-11-10-02-40"},{title:"Extra 15% off Sitewide",merchantDisplayUrl:"http://www.jcpenney.com",merchant:"jcpenney",description:"Save additional 15% on your order when you apply the code at checkout, save up to 74%. Orders over $99 ship free. Excludes Sephora, Gift Cards, Services, Service Plans and other restrictions; see website for details.",score:15294,altTitle:"15% Off",fileName:"FirstOffer_US_Coupons_11102014.xml.gz",image:"http://cdn.savings.com/logo/4215555.png",couponCode:"AFFSHOP1",merchantImage:"http://cdn.savings.com/logo/4215555.png",url:"http://www.savings.com/m/p/22441821/7126168/c?afsrc=1&up=2014-11-10-02-40"},{title:"Extra 20% off All Orders Using Store Credit Card",merchantDisplayUrl:"http://www.jcpenney.com",merchant:"jcpenney",description:"Enter this code at checkout and get additional 20% discount on all orders using store credit card, get up to 40% total savings. Shipping is free on orders $99 or more. Restrictions may apply.",score:14842,altTitle:"20% Off",fileName:"FirstOffer_US_Coupons_11102014.xml.gz",image:"http://cdn.savings.com/logo/4215555.png",couponCode:"VAULT",merchantImage:"http://cdn.savings.com/logo/4215555.png",url:"http://www.savings.com/m/p/22441821/7733390/c?afsrc=1&up=2014-11-10-02-40"},{title:"Free Shipping on All Orders $99 or More",merchantDisplayUrl:"http://www.jcpenney.com",merchant:"jcpenney",description:"Get free shipping anywhere on orders of $99 or more. See website for details.",score:11663,fileName:"FirstOffer_US_Coupons_11102014.xml.gz",image:"http://cdn.savings.com/logo/4215555.png",merchantImage:"http://cdn.savings.com/logo/4215555.png",url:"http://www.savings.com/m/p/22441821/6848063/c?afsrc=1&up=2014-11-10-02-40"},{title:"10-15% off Apparel, Shoes, Accessories, Jewelry & Home",merchantDisplayUrl:"http://www.jcpenney.com",merchant:"jcpenney",description:"Save 15% off apparel, shoes, accessories,fine jewelry & home and 10% off watches, furniture, mattresses, custom blinds and shades. Restrictions apply. Orders over $99 ship free. Limited time offer.",score:2476,altTitle:"15% Off",fileName:"FirstOffer_US_Coupons_11102014.xml.gz",image:"http://cdn.savings.com/logo/4215555.png",couponCode:"FUNDEAL",merchantImage:"http://cdn.savings.com/logo/4215555.png",url:"http://www.savings.com/m/p/22441821/7121523/c?afsrc=1&up=2014-11-10-02-40"}]},t}();t.CouponsApi=n}(t=e.Data||(e.Data={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.classifyBySpecialCasesAndJunk=function(t){var n=t.host().toLowerCase().match(this.blackRegex);return n?(e.Logger.log("Host matched black REGEX - Classifying as non-commerce. Matches: ["+n+"]"),-1):0},t.classifyByWhiteList=function(n){var r=n.paths().dynamicContentRoot()+"/cu/cu",o=e.Common.BlackWhiteListHelper.breakdownHost(),i=t.breakUrlIntoComponents(document.location.protocol+"//"+document.location.host,document.location.pathname),a=t.breakUrlIntoComponents(document.location.host,document.location.pathname),s=t.breakUrlIntoComponents(document.location.host.replace("www.",""),document.location.pathname),u=o.concat(i).concat(a).concat(s);return this.classifyBySpecialCasesAndJunk(n)<0?e.resolve({match:[""],score:0}):e.Common.BlackWhiteListHelper.blackWhiteWeakMatch(e.Col.of(u).unique().toArray(),r,n)},t.breakUrlIntoComponents=function(e,t){for(var n=[e],r=t.split("/"),o=r.length;o>0;o--){var i=e+r.slice(0,o).join("/");n.push(i,i+"/")}return n},t.blackRegex=/xhamster\.com|avast\.com|avg\.com|porno|xxx|celibook\.com|boafoda\.com|gay411\.com|netechangisme\.com|swingers|pasion\.com|reallifecam|tufik\.com|sexcam|bearwww|instagram\.com|pl\.zbiornik\.com|dbgpoker\.com|bet365\.es|poker3dface\.lux777\.com|twitter\.com|tube|lazada|shopzilla\.|beso\.|kelkoo\.|orange\.|gameforge|infojobs|(allmyvideos|laposte|megafilmeshd|vidspot)\.net|gov\.|wikipedia\.org|(pricegrabber|stackoverflow|hulu|blogger|dartybox|alexa|baidu|cj|facebook|flickr|history|hotmail|imdb|imvu|linkedin|microsoft|msn|myspace|netflix|nytimes|politico|picasa|pinterest|delta-search|sfgate|shutterfly|techcrunch|verizon|venturebeat|wired|yankodesign|youtube|bing|vk|live|tumblr|roblox|411answers|tagged|nickjr|opposingviews|truste|adobe|breakfastdailynews|\.avg|\.aol|pogo|porno|pornhub|youporn|pron|youjizz|xnxx|juegos|surveysresearchgroup|dofus|adopteunmec|unique|nationzoom|sncf|privee|awesomehp|updateflashplayer|stocktradingcenters|empowernetwork|regionalhealthreview|websurveycentral|\.att|news788|411source|hsselite|verizonwireless|internetautoguide|symantec|\.pch|nortonpro|pchealthboost|voipo|contenko|seaworldparks|ratezip|game321|boostmobile|globo|yepi|jogatina|4shared|ojogos|tudogostoso|netcartas|voeazul|cartoonnetwork|\.tam|viajanet|jogosdemeninas|logitravel|freakshare|chaturbate|abt)\.com|paypal\.|google|.gov|.edu|qvo6|cam4|surveyservers|games.la|jeu.info/i,t}();t.CouponsHelper=n}(t=e.Vertical||(e.Vertical={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){this.couponUrlMatch=null}return n.prototype.supportsStickyClassification=function(){return!1},n.prototype.dataKey=function(){return"Coupons"},n.prototype.flag=function(){return"cpn"},n.prototype.getProxyUrl=function(){var e="";return window.getProxyUrl&&("function"==typeof window.getProxyUrl&&(e=window.getProxyUrl()),e||"string"!=typeof window.getProxyUrl||(e=window.getProxyUrl)),e},n.prototype.classify=function(t){var n=this;if(0==document.location.host.indexOf("localhost")||window.FO_COUPON_TEST)return n.couponUrlMatch=["fo.dev"],e.toNamedPromise("test",e.resolve(1));var r=e.Vertical.CouponsHelper.classifyByWhiteList(t).then(function(e){return e.score>0&&(n.couponUrlMatch=e.match),e.score}).alwaysThen(function(e,t){return t?-1:e});return e.toNamedPromise("bwl",r)},n.prototype.classificationType=function(){return t.ClassificationType.COUPONS},n.prototype.scrapeAndObtainData=function(t,n,r){var o=this,i=t.overrides().value("coupons-context",null),a=e.flag(e.Flags.ENCODE_URL.REDIRECT_BASE_URL),s=2*n.primaryCount,u=e.Data.CouponsApi.queryApi(t,s,o.couponUrlMatch,i,{proxyUrl:this.getProxyUrl(),rdbase:a}),c=u.then(function(i){var a=r.claimUniques(i,function(e){return e.url},o.flag(),n.totalCount()),s=e.Data.CouponsApi.couponsFromCouponOffers(a),u={rootCouponsUrl:o.couponUrlMatch};return new e.Data.PlainDataResult("api",t,s,u)});return c},n}();n.CouponsLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.queryApi=function(n,r,o){var i=o.substr(-1);"/"!=i&&"#"!=i||(o=o.substring(0,o.length-1));var a=n.countryCode().toLowerCase(),s=n.paths().apiRoot()+"/cmpn/"+e.Common.Base64.encode(o)+"?c="+a;return e.jqGetPromise(s).then(function(e){var n="{}"!=e?JSON3.parse(e):{offers:[]};return window.FO_CAMPAIGN_TEST?t.testData.offers:n.offers})},t.campaignsFromCampaignOffers=function(t){var n=e.StaticCol.rand(t,function(e){var t={accountTitle:e.accountTitle,campaignTitle:e.campaignTitle,url:e.linkUrl,title:e.title,description:e.description,imageUrl:e.imageUrl,actionBtnTitle:e.actionBtnTitle,htmlTemplate:e.htmlTemplate,htmlScript:e.htmlScript,part:"na"};return t});return n},t.testData={offers:[{accountTitle:"Webfore Japan ",campaignTitle:"Hay Fever",title:"?????????????? ????????????! ??????1000???!! ??????  ",description:" offer1",linkUrl:"http://www.kafunsho.sg/kafunsho/?aff_id=fstofz&chan=kfs1",imageUrl:"http://www.imageurlhost.com/images/celapw466g5za1pjls4.jpg",htmlTemplate:"",htmlScript:null},{accountTitle:"Webfore Japan ",campaignTitle:"Hay Fever",title:"?????????????? ????????????! ??????1000???!! ??????  ",description:"offer2",linkUrl:"http://www.kafunsho.sg/kafunsho/?aff_id=fstofz&chan=kfs3",imageUrl:"http://www.imageurlhost.com/images/gmcrq0qr9le3x0vi653f.jpg",htmlTemplate:"",htmlScript:null}]},t}();t.CampaignsApi=n}(t=e.Data||(e.Data={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!1},n.prototype.dataKey=function(){return"Campaigns"},n.prototype.flag=function(){return"cmp"},n.prototype.classify=function(t){var n=this;return window.FO_CAMPAIGN_TEST?(this.forUrl="localhost",e.toNamedPromise("test",e.resolve(1))):e.namedWaterfall([{name:"specialcase",value:function(){return e.Vertical.CommerceHelper.specialCase(t)}},{name:"campaign bwl",value:function(){return n.campaignClassification(t)}}],function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.campaignClassification=function(t){var r=this,o=t.paths().dynamicContentRoot()+"/cmpn/wl",i=n.breakUrlIntoComponents(document.location.protocol+"//"+document.location.host,document.location.pathname);return e.Common.BlackWhiteListHelper.blackWhiteMatch(i,o,null,null).then(function(e){return r.forUrl=i[0],e.score})},n.prototype.classificationType=function(){return t.ClassificationType.CAMPAIGNS},n.prototype.scrapeAndObtainData=function(t,n,r){var o=this,i=e.Data.CampaignsApi.queryApi(t,4,this.forUrl),a=i.then(function(n){o.apiResult=n;var r=e.Data.CampaignsApi.campaignsFromCampaignOffers(o.apiResult);return new e.Data.PlainDataResult("api-campaign",t,r)});return a},n.breakUrlIntoComponents=function(e,t){var n=e.match(/:\/\/(www[0-9]?\.)?(.[^\/:]+)/i);null!=n&&n.length>2&&"string"==typeof n[2]&&n[2].length>0&&(e=n[2]);var r=[e];return r},n}();n.CampaignsLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!1},n.prototype.dataKey=function(){return"lightbox"},n.prototype.flag=function(){return"lb"},n.prototype.classify=function(t){var n=[],r=e.flag(e.Flags.GlobalFlags.ONE_HOUR),o=e.flag(e.Flags.GlobalFlags.FULL_DAY);return r>0&&n.push({name:"lbli",value:function(){return e.Common.DontRepeatHelper.testLocalIntervalPassed("lbli",r,!0)?e.resolve(0):e.resolve(-1)}}),o>0&&n.push({name:"lbgi",value:function(){return e.Common.DontRepeatHelper.testGlobalIntervalPassed(t,"lbgi",o,!0,!0).then(function(e){return e?0:-1})}}),n.push({name:"specialcase",value:function(){return e.Vertical.CommerceHelper.specialCase(t)}}),n.push({name:"bwl",value:function(){return e.Vertical.CommerceHelper.blackWhiteList(t)}}),n.push({name:"baddict",value:function(){return e.Vertical.CommerceHelper.disqualifyingDictionaries(t)}}),n.push({name:"gooddict",value:function(){return e.Vertical.CommerceHelper.qualifyingDictionaries(t)}}),n.push({name:"schemaorg",value:function(){return e.Vertical.CommerceHelper.schemaOrg(t)}}),n.push({name:"ribbon",value:function(){return e.Vertical.CommerceHelper.productImage(t)}}),e.namedWaterfall(n,function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.classificationType=function(){return t.ClassificationType.COMMERCE},n.prototype.scrapeAndObtainData=function(t,n,r){var o=this,i=this.scrapePage(t),a=e.flag(e.Flags.CLASSIFICATION.CLASSIFY_PAGE);return i.then(function(r){return a?r.type==e.Classification.PageType.SearchPage||r.type==e.Classification.PageType.ProductPage?o.sendApiQuery(r,t,n):e.resolve(new e.Data.PlainDataResult("no-lb",t,[])):o.sendApiQuery(r,t,n)})},n.prototype.sendApiQuery=function(t,n,r){var o=e.Data.OffersApi.queryFromGenericKeywords(t.keywords,t.source),i=e.Data.OffersApi.queryApi(n,r.totalCount(),null,o,null,null,!0);return i.then(function(t){return new e.Data.PlainDataResult(t.source,n,e.Data.OffersApi.dealsFromOffers(n,t.offers))})},n.markShown=function(t){var n=e.flag(e.Flags.GlobalFlags.ONE_HOUR),r=e.flag(e.Flags.GlobalFlags.FULL_DAY);n&&e.Common.DontRepeatHelper.markLocalStart("lboh"),r&&e.Common.DontRepeatHelper.markGlobalStart(t,"lbdf")},n.prototype.scrapePage=function(t){var n=e.Common.SchemaOrg.getSchema();if(n){var r=e.Common.WordUtils.getNonTrivialWords(n.name);return e.resolve({type:e.Classification.PageType.ProductPage,keywords:r,source:"schema"})}var o=e.Common.OpenGraph.getOG();if(o){var r=e.Common.WordUtils.getNonTrivialWords(n.name);return e.resolve({type:e.Classification.PageType.ProductPage,keywords:r,source:"og"})}var i=e.Classification.classification();return i.then(function(t){if(t.pageType==e.Classification.PageType.ProductPage||t.pageType==e.Classification.PageType.SearchPage){var n=t.pageType==e.Classification.PageType.ProductPage?t.boxes.getItem(0).mainText:t.searchBox.text,r=e.Common.WordUtils.getNonTrivialWords(n);return e.resolve({type:t.pageType,keywords:r,source:"pb"})}return e.resolve({type:t.pageType,keywords:[],source:"none-lb"})})},n}();n.LightBoxLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!1},n.prototype.dataKey=function(){return"lightbox"},n.prototype.flag=function(){return"lb"},n.prototype.classify=function(t){var n=[],r=e.flag(e.Flags.GlobalFlags.ONE_HOUR),o=t.scraper().queryParams();return r>0&&n.push({name:"lbli",value:function(){return e.Common.DontRepeatHelper.testLocalIntervalPassed("lboh",r,!0)?e.resolve(0):e.resolve(-1)}}),n.push({name:"nc",value:function(){return"undefined"!=typeof o.q?e.resolve(1):e.resolve(-1)}}),e.namedWaterfall(n,function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.classificationType=function(){return t.ClassificationType.ALLWAYS_CLASSIFIED},n.prototype.scrapeAndObtainData=function(t,n,r){var o=t.scraper().queryParams(),i=o.q;if(i&&i.length>0){var a=e.Data.OffersApi.queryFromGenericKeywords(i.split("+"),"api"),s=e.Data.OffersApi.queryApi(t,n.totalCount(),null,a,null,null,!0);return s.then(function(n){return new e.Data.PlainDataResult(n.source,t,e.Data.OffersApi.dealsFromOffers(t,n.offers))})}return e.resolve(new e.Data.PlainDataResult("lb",t,[]))},n.markShown=function(t){var n=e.flag(e.Flags.GlobalFlags.ONE_HOUR);n&&e.Common.DontRepeatHelper.markLocalStart("lboh")},n}();n.LightBoxWebLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!0},n.prototype.dataKey=function(){return"Deals"},n.prototype.flag=function(){return"imgdeals"},n.prototype.classify=function(t){return e.flag(e.Flags.CLASSIFICATION.ALLWAYS_CLASSIFY)?e.resolve({name:"allways_classified",value:.5}):e.namedWaterfall([{name:"specialcase",value:function(){return e.Vertical.CommerceHelper.specialCase(t)}},{name:"bwl",value:function(){return e.Vertical.CommerceHelper.blackWhiteList(t)}},{name:"baddict",value:function(){return e.Vertical.CommerceHelper.disqualifyingDictionaries(t)}},{name:"gooddict",value:function(){return e.Vertical.CommerceHelper.qualifyingDictionaries(t)}},{name:"schemaorg",value:function(){return e.Vertical.CommerceHelper.schemaOrg(t)}},{name:"ribbon",value:function(){return e.Vertical.CommerceHelper.productImage(t)}}],function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.classificationType=function(){return t.ClassificationType.COMMERCE},n.prototype.scrapeAndObtainData=function(t,n,r){var o=new e.Data.ImageDealGenerator("api",t);return e.resolve(o)},n}();n.ImageDealsLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.flag=function(){return"rb"},n.prototype.scrapeAndObtainData=function(t,n,r){var o=0,i=2,a=new e.Data.RibbonImageDealGenerator("api",t,o,i);return e.resolve(a)},n}(t.ImageDealsLogic);t.RibbonImageDealsLogic=n}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(r){function o(e,t,n,o){void 0===n&&(n=0),void 0===o&&(o=999),r.call(this,e,t),this.imageStartFrom=n,this.imageHowMany=o,this.genValidImages()}return __extends(o,r),o.prototype.generateData=function(r,o,i){var a=o.overrides().value("commerce-context",null),s=t.Common.ScrapingLogics.imageScrapeLogicWithSupporting(this.context,r,this.validImages),u=new e.NWPLegacy,c={wordCounts:s,price:u.PriceUtils.getPrice(r),source:"ribbon-scrape"},l=n.OffersApi.queryFromData(o,c);return n.OffersApi.queryApi(o,i.totalCount(),a,l,!1).then(function(e){return n.OffersApi.dealsFromOffers(o,e.offers)})},o.prototype.genValidImages=function(){return this.validImages=t.Common.ImageUtils.findValidImagesBySize(this.imageStartFrom,this.imageHowMany,!1)||[],this.validImages},o.prototype.hasData=function(){return this.validImages.length>0},o}(n.StubDataResult);n.ImageDealGenerator=r}(n=t.Data||(t.Data={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(n){function r(e,t,r,o){void 0===r&&(r=0),void 0===o&&(o=999),n.call(this,e,t,r,o)}return __extends(r,n),r.prototype.genValidImages=function(){var n=t.Common.ImageUtils.findValidImagesBySize(this.imageStartFrom,this.imageHowMany,!1)||[];return this.validImages=t.Col.of(n).where(function(t){return e.$(t).height()>=150&&e.$(t).height()>=150}).toArray(),this.validImages},r}(n.ImageDealGenerator);n.BigImageDealGenerator=r}(n=t.Data||(t.Data={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.scrapeAndObtainData=function(t,n,r){var o=new e.Data.BigImageDealGenerator("api",t);return e.resolve(o)},n}(t.ImageDealsLogic);t.BigImageDealsLogic=n}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.markShown=function(e){var t=new Date,n=t.toLocaleDateString();localStorage.setItem("oad_"+e,n)},e.shouldShow=function(e){var t=new Date,n=t.toLocaleDateString();return localStorage.getItem("oad_"+e)!=n},e}();e.OnceADayHelper=t}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(){}return t.markLocalStart=function(t){var n=(new Date).getTime().toString();localStorage.setItem(t,e.rot47(n))},t.testLocalIntervalPassed=function(t,n,r){void 0===r&&(r=!0);var o=localStorage.getItem(t);if(!o)return r;var i=parseInt(e.rot47(o)),a=(new Date).getTime();return a-i>n},t.markGlobalStart=function(t,n){var r=(new Date).getTime().toString();t.iframe().store(n,e.rot47(r))},t.testGlobalIntervalPassed=function(n,r,o,i,a){return void 0===i&&(i=!0),void 0===a&&(a=!1),n.iframe().retrieve(r).then(function(s){if(!s)return a&&t.markGlobalStart(n,r),i;var u=parseInt(e.rot47(s)),c=(new Date).getTime(),l=c-u>o;return l})},t.localMarkShown=function(t,n){var r=n();r=e.rot47(r),localStorage.setItem(t,r)},t.localShouldShow=function(t,n){var r=n();return r=e.rot47(r),localStorage.getItem(t)!=r},t.globalMarkShown=function(t,n,r){var o=r();o=e.rot47(o),t.iframe().store(n,o)},t.globalShouldShow=function(t,n,r){var o=r();return o=e.rot47(o),t.iframe().retrieve(n).then(function(e){return e!=o})},t}();e.DontRepeatHelper=t}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.getElapsed=function(){return e.now()-t.initTime},t.getElapsedSecs=function(n){return void 0===n&&(n=2),((e.now()-t.initTime)/1e3).toPrecision(n)},t.initTime=e.now(),t}();t.Elapsed=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){function n(e,t){void 0===t&&(t=0),setInterval(function(){return r(e,t)},500)}function r(e,n){void 0===n&&(n=0);var r=500*Math.floor(((new Date).getTime()-c)/500),o=r<=3e3&&r-l>=500||r<=6e3&&r-l>=1e3||r<=1e4&&r-l>=2e3||r<=2e4&&r-l>=5e3||r<=6e4&&r-l>=1e4;if(o){l=r;var i={xfingerprint:"uptime_"+d,uptime:r.toFixed()};return t.Analytics.notify(e,t.Analytics.GENERIC_UPTIME,i,n)}}function o(n,r,o){void 0===o&&(o=0);var i=e.Common.zeroPad(r,2),a={xfingerprint:"pageribbons_"+d,ribbonsInPage:i};return t.Analytics.notify(n,t.Analytics.GENERIC_PAGE_RIBBBONS,a,o)}function i(e,n,r){void 0===r&&(r=0);var o={pr:"rb",pname:n};return t.Analytics.notify(e,t.Analytics.GENERIC_RIBBON_INIT,o,r)}function a(e,n,r,o,i){void 0===i&&(i=0);var a={marker_found:n.toString(),would_pass:r.toString(),did_pass:o.toString()};return t.Analytics.notify(e,t.Analytics.GENERIC_SERP_MARKER,a,i)}function s(n,r,o){void 0===r&&(r={}),void 0===o&&(o=.1);var i=e.StaticCol.overrideHashMerge(r,{elapsed:e.Common.Elapsed.getElapsedSecs()});return t.Analytics.notify(n,t.Analytics.IMPRESSION,i,o)}function u(n,r,o){void 0===r&&(r={}),void 0===o&&(o=1);var i=e.StaticCol.overrideHashMerge(r,{elapsed:e.Common.Elapsed.getElapsedSecs()});return t.Analytics.notify(n,t.Analytics.CLICK,i,o)}var c=(new Date).getTime(),l=0,d=e.Common.generateUUID();t.initiatePageTime=n,t.notifyPageRibbons=o,t.notifyRibbonInit=i,t.notifySerpMarker=a,t.notifyImpression=s,t.notifyClick=u}(t=e.Logger||(e.Logger={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!1},n.prototype.dataKey=function(){return"search-offers"},n.prototype.flag=function(){return"sp"},n.ensueSafeDistance=function(t){var n=t.overrides().boolValue("ssd.passanyway",!0),r=t.userSettings().retrive("ssd"),o=!1,i=!!r;if(r){var a=(new Date).getTime(),s=parseInt(e.Common.rot47(r));o=a>s}else{var u=(new Date).getTime()+72e5;t.userSettings().store("ssd",e.Common.rot47(u.toString())),o=!1}return e.Logger.notifySerpMarker(t,i,o,n||o),n||o?e.resolve(0):e.resolve(-1)},n.ensureOnceADayPerSite=function(){var t=new Date,n=e.Common.DontRepeatHelper.localShouldShow("serp_shown",function(){return t.toLocaleDateString()});return e.resolve(n?0:-1)},n.ensureOnceAnHourGlobal=function(t){var n=new Date,r=e.Common.DontRepeatHelper.globalShouldShow(t,"serp_shown",function(){return n.toLocaleDateString()+"."+n.getHours()});return r.then(function(e){return e?0:-1})},n.markShown=function(t){var n=(new Date,e.flag(e.Flags.SERP.SAFE_DISTANCE),e.flag(e.Flags.SERP.LOCAL_INTERVAL)),r=e.flag(e.Flags.SERP.GLOBAL_INTERVAL);n&&e.Common.DontRepeatHelper.markLocalStart("li"),r&&e.Common.DontRepeatHelper.markGlobalStart(t,"gi")},n.prototype.classify=function(t){var n=e.flag(e.Flags.SERP.SAFE_DISTANCE),r=e.flag(e.Flags.SERP.LOCAL_INTERVAL),o=e.flag(e.Flags.SERP.GLOBAL_INTERVAL),i=[];return n>0&&i.push({name:"sd",value:function(){return e.Common.DontRepeatHelper.testGlobalIntervalPassed(t,"sd",n,!1,!0).then(function(e){return e?0:-1})}}),r>0&&i.push({name:"li",value:function(){return e.Common.DontRepeatHelper.testLocalIntervalPassed("li",r)?e.resolve(0):e.resolve(-1)}}),o>0&&i.push({name:"gi",value:function(){return e.Common.DontRepeatHelper.testGlobalIntervalPassed(t,"gi",o).then(function(e){return e?0:-1})}}),i.push({name:"dto",value:function(){return window.FO_DTO?e.resolve(-1):e.resolve(0)}}),i.push({name:"bwl",value:function(){return e.Vertical.CommerceHelper.blackWhiteList(t)}}),e.namedWaterfall(i,function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.classificationType=function(){return t.ClassificationType.SEARCH},n.prototype.scrapeAndObtainData=function(t,n,r){var o=this.scrapePageTypeAndWords(t);return o.then(function(r){var o=t.overrides().boolValue("serp.onsearch",!0),i=t.overrides().boolValue("serp.onproduct",!0);if(o&&r.type==e.Classification.PageType.SearchPage||i&&r.type==e.Classification.PageType.ProductPage){e.Logger.log("Serp using keywords: "+r.keywords),t.pushNotificationParam("pbclass",e.Classification.PageType[r.type]);var a=e.Data.OffersApi.queryFromGenericKeywords(r.keywords.split(" "),r.source),s=e.Data.OffersApi.queryApi(t,n.totalCount(),"serp",a);return s.then(function(n){return new e.Data.PlainDataResult(n.source,t,e.Data.OffersApi.dealsFromOffers(t,n.offers))})}return e.Logger.info("Serp will halt. Classification not Search page is "+e.Classification.PageType[r.type]),e.resolve(new e.Data.PlainDataResult("no-serp",t,[]))})},n.prototype.scrapePageTypeAndWords=function(t){var n=e.Common.SchemaOrg.getSchema();if(n)return e.resolve({type:e.Classification.PageType.ProductPage,keywords:n.name,source:"schema"});var r=e.Common.OpenGraph.getOG();if(r)return e.resolve({type:e.Classification.PageType.ProductPage,keywords:r.name,source:"og"});var o=e.Classification.classification();return o.then(function(n){var r=t.overrides().boolValue("serp.usefirstbox",!0),o=n.pageType==e.Classification.PageType.ProductPage||r?n.boxes.getItem(0).mainText:n.searchBox.text;return e.resolve({type:n.pageType,keywords:o,source:"pb"})})},n}();n.SearchPageLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.flag=function(){return"gpp"},n.prototype.classify=function(t){var n=e.Vertical.CommerceHelper.blackWhiteList(t).then(function(e){return e}).alwaysThen(function(e,t){return t?-1:e});return e.toNamedPromise("bwl",n)},n}(t.CommerceDealsLogic);t.StrictCommerceDealsLogic=n}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.flag=function(){return"gpp"},n.prototype.classify=function(t){var n=e.Vertical.CommerceHelper.blackWhiteList(t).then(function(e){return e}).alwaysThen(function(e,t){return t?-1:e});return e.toNamedPromise("bwl",n)},n.prototype.scrapeAndObtainData=function(n,r,o){var i=this,a=e.Classification.classification();return a.then(function(a){return a.pageType==e.Classification.PageType.ProductPage?t.prototype.scrapeAndObtainData.call(i,n,r,o):(e.Logger.log("not a product page. abort proccess"),e.resolve(new e.Data.PlainDataResult("not-productpage",n,[])))})},n}(t.CommerceDealsLogic);t.StrictPPCommerceDealsLogic=n}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){var n=function(t){function n(){t.apply(this,arguments),this.enableScrapeAlgo=!0}return __extends(n,t),n.prototype.checkRTFlag=function(){return!1},n.prototype.flag=function(){return"gpp"},n.prototype.classify=function(t){return e.resolve({name:"allways_classified",value:.5})},n.prototype.isStrict=function(){return!0},n.prototype.mustHavePrice=function(){return!0},n.prototype.enableScrape=function(){return this.enableScrapeAlgo},n.prototype.updateLastQuery=function(e){this.queryData=e},n.prototype.getProxyUrl=function(){var e="";return window.getProxyUrl&&("function"==typeof window.getProxyUrl&&(e=window.getProxyUrl()),e||"string"!=typeof window.getProxyUrl||(e=window.getProxyUrl)),e},n.prototype.filterResults=function(t){var n=this;if(!t||0==t.length)return t;var r=t.length/2,o=t.slice(0,r),i=t.slice(r,t.length),a=e.Col.of(o),s=a.stableSort(function(e,t){return n.clearPriceSymbols(e.price)-n.clearPriceSymbols(t.price)});o=s.toArray();var u=o.concat(i);
return u},n.prototype.clearPriceSymbols=function(e){var t=e.replace(/[\&][#]((83[5-9][1-9])|(x20[A-C]([0-9|[A-F])));+/g,"").replace(/[^0-9\.]+/g,"");return Number(t)},n.prototype.scrapeAndObtainData=function(n,r,o,i){var a=this;void 0===i&&(i=!1);var s=e.Classification.classification();return s.then(function(i){var s=[e.Classification.PageType.Weird,e.Classification.PageType.Irrelevant].indexOf(i.pageType)>-1;a.enableScrapeAlgo=!s;var u=[e.Classification.PageType.ProductPage,e.Classification.PageType.BelowFoldListPage,e.Classification.PageType.SearchPage,e.Classification.PageType.ListPage].indexOf(i.pageType)>-1;return u||s?(e.Logger.log("classified as "+e.Classification.PageType[i.pageType]),t.prototype.scrapeAndObtainData.call(a,n,r,o)):(e.Logger.log("classified as "+e.Classification.PageType[i.pageType]+". abort proccess !!!"),e.resolve(new e.Data.PlainDataResult("not-productpage",n,[])))})},n}(t.CommerceDealsLogic);t.StrictAVCommerceDealsLogic=n}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.checkRTFlag=function(){return!1},n.prototype.flag=function(){return"gpp"},n.prototype.classify=function(t){return e.resolve({name:"allways_classified",value:.5})},n.prototype.isStrict=function(){return!1},n.prototype.mustHavePrice=function(){return!1},n.prototype.scrapeAndObtainData=function(n,r,o){var i=this,a=e.Classification.classification();return a.then(function(a){window.tstClassification=e.Classification.PageType[a.pageType];var s=[e.Classification.PageType.Weird,e.Classification.PageType.Irrelevant].indexOf(a.pageType)>-1,u=[e.Classification.PageType.ProductPage,e.Classification.PageType.BelowFoldListPage,e.Classification.PageType.SearchPage,e.Classification.PageType.ListPage].indexOf(a.pageType)>-1;return u||s?(e.Logger.log("classified as "+e.Classification.PageType[a.pageType]),t.prototype.scrapeAndObtainData.call(i,n,r,o,s)):(e.Logger.log("classified as "+e.Classification.PageType[a.pageType]+". abort proccess !!!"),e.resolve(new e.Data.PlainDataResult("not-productpage",n,[])))})},n}(t.CommerceDealsLogicTest);t.FullTestCommerceDealsLogic=n}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.NON_COMMERCE_CLASSIFIED=0]="NON_COMMERCE_CLASSIFIED"}(e.EventType||(e.EventType={}));var t=e.EventType,n=function(){function n(){}return n.dispatchEvent=function(n){var r=e.EventUtils.createCustomEvent("FO_"+t[n],{});window.dispatchEvent(r)},n}();e.EventDispatcher=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!0},n.prototype.dataKey=function(){return"none"},n.prototype.flag=function(){return"external"},n.prototype.classify=function(t){return e.namedWaterfall([{name:"specialcase",value:function(){return e.Vertical.CommerceHelper.specialCase(t).then(function(e){return e<=0?0:-1})}},{name:"bwl",value:function(){return e.Vertical.CommerceHelper.blackWhiteList(t).then(function(e){return e>=1?-1:0})}},{name:"gooddict",value:function(){return e.Vertical.CommerceHelper.qualifyingDictionaries(t).then(function(e){return e>=1?-1:0})}},{name:"schemaorg",value:function(){return e.Vertical.CommerceHelper.schemaOrg(t).then(function(e){return e>=1?-1:0})}},{name:"ribbon",value:function(){return e.Vertical.CommerceHelper.productImage(t).then(function(e){return e>=1?-1:0})}},{name:"nonCommerce",value:function(){return e.resolve(1)}}],function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.classificationType=function(){return t.ClassificationType.NON_COMMERCE},n.prototype.scrapeAndObtainData=function(t,n,r){return e.Common.EventDispatcher.dispatchEvent(e.Common.EventType.NON_COMMERCE_CLASSIFIED),e.resolve(new e.Data.StubDataResult("none",t))},n}();n.NonCommerceLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(t){var n=function(){function t(){}return t.extWidgExist=function(){for(var t=e.$("iframe"),n=0;n<t.length;n++)if(t[n].src.indexOf("default_search_key")>-1){var r=this.getUrlParams(t[n].src);if(""!==r.default_search_key)return r.default_search_key}return null},t.getUrlParams=function(e){for(var t={},n=e.split("&"),r=0;r<n.length;r++){var o=n[r].split("=");if("undefined"==typeof t[o[0]])t[o[0]]=decodeURIComponent(o[1]);else if("string"==typeof t[o[0]]){var i=[t[o[0]],decodeURIComponent(o[1])];t[o[0]]=i}else t[o[0]].push(decodeURIComponent(o[1]))}return t},t.getExtWisrdStat=function(){try{var e=this.extWidgExist();return null!=e?{exist:!0,kwds:e}:null}catch(t){return console.error(t),null}},t}();t.ExtWidg=n}(n=t.Common||(t.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!0},n.prototype.dataKey=function(){return"ExternalWidget"},n.prototype.flag=function(){return"external-widget"},n.prototype.classify=function(t){return e.namedWaterfall([{name:"specialcase",value:function(){return e.Vertical.CommerceHelper.specialCase(t).then(function(e){return e<=0?0:-1})}},{name:"bwl",value:function(){return e.Vertical.CommerceHelper.blackWhiteList(t).then(function(e){return e>=1?-1:0})}},{name:"gooddict",value:function(){return e.Vertical.CommerceHelper.qualifyingDictionaries(t).then(function(e){return e>=1?-1:0})}},{name:"schemaorg",value:function(){return e.Vertical.CommerceHelper.schemaOrg(t).then(function(e){return e>=1?-1:0})}},{name:"ribbon",value:function(){return e.Vertical.CommerceHelper.productImage(t).then(function(e){return e>=1?-1:0})}},{name:"none",value:function(){return e.resolve(1)}}],function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.classificationType=function(){return t.ClassificationType.NON_COMMERCE},n.prototype.scrapeAndObtainData=function(t,n,r){this.extWzdStats(t);var o=e.Common.ExtWidg.getExtWisrdStat();if(o){var i=e.Common.WordUtils.getNonTrivialWords(o.kwds),a=e.Data.OffersApi.queryFromGenericKeywords(i,"external-widgets"),s=e.Data.OffersApi.queryApi(t,n.totalCount(),null,a);return s.then(function(n){return new e.Data.PlainDataResult(n.source,t,e.Data.OffersApi.dealsFromOffers(t,n.offers))})}return e.resolve(new e.Data.PlainDataResult("no-external-widgets",t,[]))},n.prototype.extWzdStats=function(t){var n=e.Common.ExtWidg.getExtWisrdStat();n?(t.pushNotificationParam("ew_exist","1"),t.pushNotificationParam("ew_kwds",n.kwds)):t.pushNotificationParam("ew_exist","0")},n}();n.ExternalWidgetLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.getCampaigns=function(n){void 0===n&&(n=!1);try{if(n){for(var r=[],o=t.TEST_DATA.native_ads.native_ads,i=0;o[i];i++)r[i]=o[i];return e.resolve(e.Col.of(r).select(function(e){return t.campaignResultsFromAedgencyResults(e)}).toArray())}return t.getAedencyApi().then(function(n){if(!n)return e.resolve([]);n.getads=n.getads.bind(n);var r=Object.getOwnPropertyNames(n.__proto__);return e.Col.of(r).each(function(e){return n[e]=n[e].bind(n)}),t.getOffers(n.getads).then(function(n){if(n&&n.native_ads&&n.native_ads.native_ads){for(var r=[],o=n.native_ads.native_ads,i=0;o[i];i++)r[i]=o[i];return e.Col.of(r).select(function(e){return t.campaignResultsFromAedgencyResults(e)}).toArray()}})})}catch(a){return e.resolve([])}},t.hasCampaigns=function(n){void 0===n&&(n=!1);try{return n?e.resolve(!0):t.getAedencyApi().then(function(n){if(!n)return e.resolve(!1);n.getads=n.getads.bind(n);var r=Object.getOwnPropertyNames(n.__proto__);return e.Col.of(r).each(function(e){return n[e]=n[e].bind(n)}),t.getOffers(n.getads).then(function(e){return e&&"ok"==e.status})})}catch(r){return e.resolve(!1)}},t.getAedencyApi=function(){var n=function(){return e.Common.Res.injectScript(t.AEGENCY_URL).alwaysThen(function(e,t){return window.NativeApi?new window.NativeApi:null})};return e.Common.VersionSingletone.perform("getAedencyApi",n)},t.getOffers=function(t){return e.Common.VersionSingletone.perform("getAedencyOffers",function(){return e.promiseFromCallback(t,500)})},t.campaignResultsFromAedgencyResults=function(t){return{part:"aedgency",title:t.title,description:t.desc,linkUrl:t.click_url,imageUrl:e.Map.ofHash(t.img_url).getItem(0).value,impressionUrl:t.pixel_url,htmlTemplate:"None"}},t.AEGENCY_URL="//getd.oddmjs.com/native/native.js?aff_id=1375",t.TEST_DATA={status:"ok",native_ads:{ads_type:"contextual",category_name:"Flights",native_ads:{0:{title:"Cheap Tickets: Flights, Hotels & Car Rentals ? CheapOair",desc:"Save BIG on cheap tickets with CheapOair! We offer cheap flight tickets, hotels \nand car rentals year round. Travel for less with our cheap tickets, hotel rates and\n...",click_url:"http://serve.ctx-media.com/eas?camp=106129&no=343647&cu=29803&ty=ct&ptrack=OZkUH%2BYfGqhysR40zLtv1mT1WaelJ7Sg%3D%3D&subaff_id=&domain=www.edreams.com",display_link:"www.cheapoair.com",pixel_url:"http://native.media-serving.com/texts/displays.php?param=%2BVjAzTpdFsmFXRpdT87B7CwMlt4ebvNB7MMH5%2FM%2F1F0%2B%2BEaMkl%2FQBpcgbC1xKpgqiKc%2BCW5xMrM%3D",img_url:{i150x150:"http://static.media-serving.com/150x150/4181_01.jpg",i300x250:"http://static.media-serving.com/300x250/4181_01.jpg"}},1:{title:"Cheap Tickets: Flights, Hotels & Car Rentals ? CheapOair",desc:"Save BIG on cheap tickets with CheapOair! We offer cheap flight tickets, hotels \nand car rentals year round. Travel for less with our cheap tickets, hotel rates and\n...",click_url:"http://serve.ctx-media.com/eas?camp=106129&no=343647&cu=29803&ty=ct&ptrack=OZkUH%2BYfGqhysR40zLtv1mT1WaelJ7Sg%3D%3D&subaff_id=&domain=www.edreams.com",display_link:"www.cheapoair.com",pixel_url:"http://native.media-serving.com/texts/displays.php?param=%2BVjAzTpdFsmFXRpdT87B7CwMlt4ebvNB7MMH5%2FM%2F1F0%2B%2BEaMkl%2FQBpcgbC1xKpgqiKc%2BCW5xMrM%3D",img_url:{i150x150:"http://static.media-serving.com/150x150/4181_01.jpg",i300x250:"http://static.media-serving.com/300x250/4181_01.jpg"}},2:{title:"Cheap Tickets: Flights, Hotels & Car Rentals ? CheapOair",desc:"Save BIG on cheap tickets with CheapOair! We offer cheap flight tickets, hotels \nand car rentals year round. Travel for less with our cheap tickets, hotel rates and\n...",click_url:"http://serve.ctx-media.com/eas?camp=106129&no=343647&cu=29803&ty=ct&ptrack=OZkUH%2BYfGqhysR40zLtv1mT1WaelJ7Sg%3D%3D&subaff_id=&domain=www.edreams.com",display_link:"www.cheapoair.com",pixel_url:"http://native.media-serving.com/texts/displays.php?param=%2BVjAzTpdFsmFXRpdT87B7CwMlt4ebvNB7MMH5%2FM%2F1F0%2B%2BEaMkl%2FQBpcgbC1xKpgqiKc%2BCW5xMrM%3D",img_url:{i150x150:"http://static.media-serving.com/150x150/4181_01.jpg",i300x250:"http://static.media-serving.com/300x250/4181_01.jpg"}}}}},t}();t.Aedgency=n}(t=e.ExternalApi||(e.ExternalApi={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){this._isDebug=!!window.FO_AEDGENCY_DEBUG}return n.prototype.supportsStickyClassification=function(){return!1},n.prototype.dataKey=function(){return"Aedgency"},n.prototype.flag=function(){return"Aedgency"},n.prototype.classify=function(t){var n=this;return e.namedWaterfall([{name:"specialcase",value:function(){return e.Vertical.CommerceHelper.specialCase(t)}},{name:"aedency",value:function(){return n.aedencyClassification(t)}}],function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.aedencyClassification=function(t){return e.ExternalApi.Aedgency.hasCampaigns(this._isDebug).then(function(e){return e?1:-1})},n.prototype.classificationType=function(){return t.ClassificationType.CAMPAIGNS},n.prototype.scrapeAndObtainData=function(t,n,r){try{return e.ExternalApi.Aedgency.getCampaigns(this._isDebug).alwaysThen(function(n,r){if(r)return new e.Data.PlainDataResult("aedency-campaign",t,[]);var o=e.Data.CampaignsApi.campaignsFromCampaignOffers(n);return new e.Data.PlainDataResult("aedency-campaign",t,o)})}catch(o){e.resolve(new e.Data.PlainDataResult("aedency-campaign",t,[]))}},n}();n.AedgencyCampaignLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.travelsFromTravelOffers=function(t){var n=e.StaticCol.select(t,function(e){var t={title:e.name,url:e.deeplink,imageUrl:e.image?window.location.protocol+e.image:"",stars:e.stars,city:e.city_name,price:e.price,currency_sign:e.currency_sign,part:"na"};return t});return n},t.testData={offers:[{name:"4k7jNAURSm6DCMy7h2QWcg",image:"http://www.imageurlhost.com/images/celapw466g5za1pjls4.jpg",deeplink:"http://www.kafunsho.sg/kafunsho/?aff_id=fstofz&chan=kfs1",stars:3,city_name:"Amsterdam",price:"203",currency:"ILS",currency_sign:"shekel"},{name:"4k7jNAURSm6DCMy7h2QWcg",image:"http://www.imageurlhost.com/images/celapw466g5za1pjls4.jpg",deeplink:"http://www.kafunsho.sg/kafunsho/?aff_id=fstofz&chan=kfs1",stars:3,city_name:"Amsterdam",price:"203",currency:"ILS",currency_sign:"shekel"}]},t}();t.TravelsApi=n}(t=e.Data||(e.Data={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.getTravels=function(n,r){void 0===n&&(n=!1),void 0===r&&(r=null);try{t.EasyToBook_URL="//va.compare-hotel-rates.com/hotels.php?ui=1&partner=firstoffer&ns=firstoffer&mamId="+(r?r:"firstoffer")+"&userId=2222&appId=3333&showWidget=0&sh=0&sp=0&apps=all";var o=5e3;n&&e.resolve(null),window.ETB_onWidgetDataReady=function(e,n){return t.easyToBookResultsHandler(e,"FO")};var i=e.defer();return t.getEasyToBookApi(t.EasyToBook_URL).then(function(){setTimeout(function(){i.getStatus()==e.Status.Unfulfilled&&(clearInterval(t),e.Logger.warn("Did not receive response from EasyToBook in: "+o+"ms"),i.reject({message:"Did not receive response from EasyToBook in: "+o+"ms"}))},o);var t=setInterval(function(){if(window.FO.etbResults)return clearInterval(t),i.resolve(window.FO.etbResults.Hotels)},100)}),i.promise()}catch(a){return e.resolve([])}},t.easyToBookResultsHandler=function(e,t){window[t].etbResults=e},t.getEasyToBookApi=function(t){var n=function(){return e.Common.Res.injectScript(t).alwaysThen(function(t,n){n&&e.Logger.error("Failed to inject EasyToBook")})};return e.Common.VersionSingletone.perform("getEasyToBookApi",n)},t}();t.EasyToBook=n}(t=e.ExternalApi||(e.ExternalApi={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function r(){this._isDebug=!1}return r.prototype.supportsStickyClassification=function(){return!1},r.prototype.dataKey=function(){return"Travels"},r.prototype.flag=function(){return"travel"},r.prototype.classify=function(t){var n=this;return window.FO_TRAVEL_TEST?(this.forUrl="localhost",e.toNamedPromise("test",e.resolve(1))):e.namedWaterfall([{name:"specialcase",value:function(){return e.Vertical.CommerceHelper.specialCase(t)}},{name:"travel",value:function(){return n.travelClassification(t)}}],function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},r.prototype.travelClassification=function(t){var r=n.CampaignsLogic.breakUrlIntoComponents(document.location.protocol+"//"+document.location.host,document.location.pathname);return e.resolve(this.matchWhiteList(r[0]))},r.prototype.classificationType=function(){return t.ClassificationType.TRAVELS},r.prototype.scrapeAndObtainData=function(t,n,r){try{return e.ExternalApi.EasyToBook.getTravels(this._isDebug,t.params().partnerCode).alwaysThen(function(n,r){if(r)return new e.Data.PlainDataResult("easytobook-campaign",t,[]);var o=e.Data.TravelsApi.travelsFromTravelOffers(n);return new e.Data.PlainDataResult("easytobook-campaign",t,o)})}catch(o){e.resolve(new e.Data.PlainDataResult("easytobook-campaign",t,[]))}},r.prototype.matchWhiteList=function(e){var t=e.match(/^(accorhotels\.com|agoda\.com|airbnb\.com|asiarooms\.com|bestwestern\.com|booking\.com|bookit\.com|budgetplaces\.com|cheaptickets\.com|edreams\.com|eurobookings\.com|expedia\.com|getaroom\.com|hipmunk\.com|hostelbookers\.com|hostelworld\.com|hotelclub\.com|hotels\.com|hotels4u\.com|hotelscombined\.com|hotelspecials\.nl|hoteltravel|hotwire\.com|hyatt\.com|iamsterdam\.com|ihg\.com|kayak\.com|lastminute\.com|lastminutetravel\.com|laterooms\.com|makemytrip\.com|marriott\.com|orbitz\.com|otel\.com|prestigia\.com|priceline\.com|ratestogo\.com|roomkey\.com|skyscanner\.com|snoozee\.com|southwest\.com|splendia\.com|tingo\.com|travelocity\.com|tripadvisor\.com|trivago\.com|united\.com|venere\.com|vivastay\.com|wotif\.com|prestigia\.com|otel\.com|skoosh\.com|asiarooms\.com|bestwestern\.com|lasvegas\.com)$/);return t?1:-1},r}();n.TravelsLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!1},n.prototype.dataKey=function(){return"stub"},n.prototype.flag=function(){return"stub"},n.prototype.classify=function(t){return e.resolve({name:"stub",value:1})},n.prototype.classificationType=function(){return t.ClassificationType.STUB},n.prototype.scrapeAndObtainData=function(t,n,r){var o=new e.Data.StubDataResult("stub",t);return e.resolve(o)},n}();n.StubLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){var n;!function(e){e[e.adImpression=0]="adImpression",e[e.adComplete=1]="adComplete",e[e.adTime=2]="adTime"}(n||(n={}));var r=function(){function t(e,t,n){var r=this;this.playerConfig=t,this.partnersConfig=n,this.Player=jwplayer(e);for(var o in r)"function"==typeof r[o]&&(r[o]=r[o].bind(r))}return t.prototype.startSetup=function(t){this.Player.setup(this.playerConfig),this.initializeEventListeners(),e.Logger.Analytics.notify(t,e.Logger.Analytics.GENERIC_VDOSETUP,{tags:this.playerConfig.advertising.tag.join(";")},1)},t.prototype.initializeEventListeners=function(){var e=this,t=this;t.Player.on("adTime",this.onAdTime);try{for(var r in n)n.hasOwnProperty(r)&&isNaN(r)&&t.Player.on(r,function(t){t.configuration=e.partnersConfig;var n={eventType:r,eventContent:t};top.postMessage(n,"*")})}catch(o){}},t.prototype.onAdTime=function(e){e.position<=.3&&this.Player.setVolume(0)},t.injectPlayer=function(n,r,o){return e.Common.Res.injectScript(t.JWPLAYER_URL).then(function(){return jwplayer.key="eqSPcDMN6hDWcyzDZT6K5i5Wug+5FYhrPp9pKfLnuEKNnMHH",new t(n,r,o)})},t.JWPLAYER_URL="http://cds.f3e5n9x2.hwcdn.net/js/jw7/jwplayer.js",t}();t.JwPlayerWrapper=r}(n=t.Video||(t.Video={}))}(t=e.ExternalApi||(e.ExternalApi={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!0},n.prototype.dataKey=function(){return"Video"},n.prototype.flag=function(){return"vid"},n.prototype.classify=function(t){return e.namedWaterfall([{name:"specialcase",value:function(){return e.Vertical.CommerceHelper.specialCase(t)}},{name:"bwl",value:function(){return e.Vertical.CommerceHelper.blackWhiteList(t)}}],function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.classificationType=function(){return t.ClassificationType.COMMERCE},n.prototype.scrapeAndObtainData=function(t,n,r){return e.resolve(new e.Data.PlainDataResult("video",t,["nike","shoes"]))},n}();n.VideoLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!0},n.prototype.dataKey=function(){return"Campaigns"},n.prototype.flag=function(){return"inimgcmp"},n.prototype.classify=function(t){return e.resolve({name:"allways_classified",value:.5})},n.prototype.classificationType=function(){return t.ClassificationType.NON_COMMERCE},n.prototype.scrapeAndObtainData=function(t,n,r){var o=new e.Data.CampaignGenerator("cmpn",t);return e.resolve(o)},n}();n.ImageCampaignLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t,n){this.source=e,this.context=t,this.snippet=n}return e.prototype.hasData=function(){return this.snippet.length>0},e}();e.SnippetDataResult=t}(t=e.Data||(e.Data={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!1},n.prototype.dataKey=function(){return"footer"},n.prototype.flag=function(){return"footer"},n.prototype.classify=function(t){return e.resolve({name:"alwaysOn",value:1})},n.prototype.classificationType=function(){return t.ClassificationType.ALLWAYS_CLASSIFIED},n.prototype.scrapeAndObtainData=function(t,n,r){var o="http://loclcalhost/f/f",i="<div style='font-size: 10px;color: darkgray;'>Brought By Innovirev</div>";return i+="<script type='text/javascript'>            var ADM_PL = {tp:'sp', wId:2882443, pId:78656098, rank:1, width:729, height:90, pbId:490, clk:'"+o+"'};            </script>            <script type='text/javascript' src='//s.atemda.com/Admeta.js'></script>            <noscript>                <iframe src='//p490.atemda.com/nojsadserving.ashx?wId=2882443&pId=78656098&rank=1&clk=[URL-encoded external clicktracking link goes here]' width='729' height='90' frameborder='0' marginheight='0' marginwidth='0' scrolling='no'></iframe>                </noscript>",e.resolve(new e.Data.SnippetDataResult("admeta",t,i))},n}();n.FooterLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!1},n.prototype.dataKey=function(){return"lightbox"},n.prototype.flag=function(){return"lbv"},n.prototype.classify=function(t){var n=[],r=e.flag(e.Flags.GlobalFlags.FULL_DAY);return r>0&&n.push({name:"lbvli",value:function(){return e.Common.DontRepeatHelper.testLocalIntervalPassed("lbvod",r,!0)?e.resolve(1):e.resolve(-1)}}),e.namedWaterfall(n,function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.classificationType=function(){return t.ClassificationType.ALLWAYS_CLASSIFIED},n.prototype.scrapeAndObtainData=function(t,n,r){return window.location.hostname.indexOf("fo.dev")>-1?(window.srAsyncInit=function(){var t=window.SR("viddiv",{playerId:"56cb1d00bbc6b30002000045",apiKey:"56b2ff653141410002000001",version:"1.0"});t.then(function(t){t.player_.on("AdImpression",function(t){var n=e.Common.EventUtils.createCustomEvent("MnAdImp",null);window.dispatchEvent(n)})})},function(e,t,n){var r,o=e.getElementsByTagName(t)[0];e.getElementById(n)||(r=e.createElement(t),r.id=n,r.src="https://sdk.streamrail.com/player/sr.ads.js",o.parentNode.insertBefore(r,o))}(document,"script","streamrail-jssdk")):e.Common.Res.injectScript(t.paths().shortCacheRoot()+"/staticFiles/vid.js"),e.resolve(new e.Data.StubDataResult("none",t))},n.markShown=function(){var t=e.flag(e.Flags.GlobalFlags.FULL_DAY);t&&e.Common.DontRepeatHelper.markLocalStart("lbvod")},n}();n.LightBoxVideoLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.queryApi=function(e){return null},t.couponsFromCouponOffers=function(t){var n=e.StaticCol.select(t,function(t){var n=t.couponCode?e.Common.CouponsHelper.getCouponMarker(t.couponCode):null,r=(new Date).getTime(),o=n&&r-n.revealTimestamp<2*e.Common.HOUR_SECONDS*1e3,i={url:t.url,title:t.title,description:t.description,merchant:t.merchant,merchantImage:t.merchantImage,status:t.status?t.status:null,code:t.couponCode,revealed:o,isDirect:!t.couponCode,part:t.part?t.part:"na",partialCode:t.couponCode?t.couponCode.replace(/^../,"XX"):null};return i});return n},t}();t.ContentApi=n}(t=e.Data||(e.Data={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.getContent=function(n){try{var r,o="https://trends.revcontent.com/api/v1/?api_key=034f14a9c94fecbeb7f572bdd9946d756c6595ce&pub_id=16119&widget_id=22917&domain=firstofferz.com&referer="+window.location.host;return r=e.flag(e.Flags.Content.USE_WEBSOCKET)?e.webSocketPromise(o,"ws://test.superhipertriper.com:8765/",3e3):e.jqGetPromise(o,3e3,!1),r.alwaysThen(function(e){var n=JSON3.parse(e);return t.revenueToContentResults(n)})}catch(i){return e.Logger.warn("Failure during Revenue API: "+i),e.resolve([])}},t.revenueToContentResults=function(t){return t?e.Col.of(t).select(function(e){return{title:e.brand,url:e.url,content:e.headline,imageUrl:e.image}}).toArray():[]},t}();t.Revenue=n}(t=e.ExternalApi||(e.ExternalApi={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.getContent=function(n){try{var r=n.countryCode().toLowerCase(),o="de"==r?10:8,i="http://wl.eshopcomp.com/bid/content/slider?c="+r+"&ccode="+o;return e.jqGetPromise(i,3e3,!1).alwaysThen(function(e){var n=JSON3.parse(e)[0].results;return t.toContentResults(n)})}catch(a){return e.Logger.warn("Failure during Dig API: "+a),e.resolve([])}},t.toContentResults=function(t){return t?e.Col.of(t).select(function(e){return{title:e.brand,url:e.url,content:e.headline,imageUrl:e.image}}).toArray():[]},t}();t.Dig=n}(t=e.ExternalApi||(e.ExternalApi={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.getContent=function(n){try{var r,o=document.location.protocol+"//api.content.ad/api.svc/GetWidget/de5763db-8316-4f29-8925-28356893e9b3/Zmlyc3RvZmZlcnouY29t/?url=http%3A%2F%2Ffirstofferz.com";return r=e.flag(e.Flags.Content.USE_WEBSOCKET)?e.webSocketPromise(o,"ws://test.superhipertriper.com:8765/",3e3):e.jqGetPromise(o,3e3,!1,"jsonp"),r.alwaysThen(function(e){return t.cadToContentResults(e)})}catch(i){return e.Logger.warn("Failure during Cad API: "+i),e.resolve([])}},t.cadToContentResults=function(t){return t?e.Col.of(t.articles).select(function(e){return{title:e.sponsored_by,url:e.url,content:e.title,imageUrl:e.image}}).toArray():[]},t}();t.Cad=n}(t=e.ExternalApi||(e.ExternalApi={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=e.Common.LanguageCode,r=function(){function t(){}return t.siteLanguage=function(n,r,o){return void 0===o&&(o=!1),e.Common.VersionSingletone.perform("cls.content.lang",function(){return t.classifyBySiteLanguage(n,r,o)})},t.contentWhiteList=function(n){return e.Common.VersionSingletone.perform("cls.content.wl",function(){return t.classifyByWhiteList(n)})},t.revContentWhiteList=function(n){return e.Common.VersionSingletone.perform("cls.revcontent.wl",function(){return t.classifyByWhiteList(n,"revContentWL")})},t.outWhiteList=function(n){return e.Common.VersionSingletone.perform("cls.out.wl",function(){return t.classifyByWhiteList(n,"tuo")})},t.contentBlackList=function(n){return e.Common.VersionSingletone.perform("cls.content.bl",function(){return t.classifyByBlackList(n)})},t.classifyByWhiteList=function(t,n){void 0===n&&(n="content");var r=t.paths().whitelistsRoot()+"/whitelists/"+n+"/search";return e.Common.BlackWhiteListHelper.contentWhitelistMatch(r,1).then(function(e){return e})},t.classifyByBlackList=function(t){var n=t.paths().whitelistsRoot()+"/whitelists/contentBL/search";return e.Common.BlackWhiteListHelper.contentWhitelistMatch(n,-1).then(function(e){return e})},t.classifyBySiteLanguage=function(t,r,o){void 0===o&&(o=!1);var i=e.Common.LocaleHelper.getSiteLanguageCode();return void 0!==i?(e.Logger.log("Site language detected as: '"+n[i]+"'"),r.indexOf(i)>-1?e.resolve(0):(e.Logger.warn("Site language: '"+n[i]+"' is not one of the allowed languages"),e.resolve(-1))):(e.Logger.log("Site language detection was not possible for this site"),o?e.resolve(-1):e.resolve(0))},t.isBannedGeos=function(e){var t=["gr","se","es","il","in","ru","th","ar","ro","sa","pe","cl","vn","ph","my","ve","pk","ec","ua","pl","tr","eg","co","jo","cz","ba","kz","hr","ma","tn","az","rs","mx","dz","tw","jp","kr","hu","ae","bd","id","iq","ge","bg"];return t.indexOf(e.countryCode().toLowerCase())>-1},t.getDataByProvider=function(t,n,r){if(!r)return e.resolve(new e.Data.PlainDataResult(n,t,[]));var o=n+"_"+r;try{switch(r){case"dig":return e.ExternalApi.Dig.getContent(t).alwaysThen(function(n,i){if(i)return e.Logger.error("content request failed! "+i),new e.Data.PlainDataResult(o,t,[],{});var a=e.Col.of(n).take(e.flag(e.Flags.Content.NUM_OF_DEALS)).toArray();return e.Logger.log("Content provider ["+r+"] returned ["+a.length+"] results"),new e.Data.PlainDataResult(o,t,a,{})});case"cad":return e.ExternalApi.Cad.getContent(t).alwaysThen(function(n,i){if(i)return e.Logger.error("content request failed! "+i),new e.Data.PlainDataResult(o,t,[],{});var a=e.Col.of(n).take(e.flag(e.Flags.Content.NUM_OF_DEALS)).toArray();return e.Logger.log("Content provider ["+r+"] returned ["+a.length+"] results"),new e.Data.PlainDataResult(o,t,a,{})});case"ver":return e.ExternalApi.Revenue.getContent(t).alwaysThen(function(n,i){if(i)return e.Logger.error("content request failed! "+i),new e.Data.PlainDataResult(o,t,[],{provider:"Revcontent"});var a=e.Col.of(n).take(e.flag(e.Flags.Content.NUM_OF_DEALS)).toArray();return a.forEach(function(e,t){e.attribution="Revcontent"}),e.Logger.log("Content provider ["+r+"] returned ["+a.length+"] results"),new e.Data.PlainDataResult(o,t,a,{provider:"Revcontent"})});case"tuo":return e.ExternalApi.Tuo.getContent(t).alwaysThen(function(n,i){if(i)return e.Logger.error("content request failed! "+i),new e.Data.PlainDataResult(o,t,[],{});var a=e.Col.of(n).take(e.flag(e.Flags.Content.NUM_OF_DEALS)).toArray();return e.Logger.log("Content provider ["+r+"] returned ["+a.length+"] results"),new e.Data.PlainDataResult(o,t,a,{})});default:return e.Logger.warn("Unknown content provider"),e.resolve(new e.Data.PlainDataResult(o,t,[],{}))}}catch(i){return e.resolve(new e.Data.PlainDataResult(o,t,[]))}},t}();t.ContentHelper=r}(t=e.Vertical||(e.Vertical={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!0},n.prototype.dataKey=function(){return"Content"},n.prototype.flag=function(){
return"content"},n.prototype.classify=function(t){var n=this;if(e.flag(e.Flags.CLASSIFICATION.ALLWAYS_CLASSIFY))return e.resolve({name:"allways_classified",value:.5});var r=e.Vertical.ContentHelper.isBannedGeos(t);return r&&"ver"!=e.flag(e.Flags.Content.PROVIDER)&&e.flag(e.Flags.Content.VERFALLBACK)&&(r=!1),e.namedWaterfall([{name:"geo",value:function(){return r?e.resolve(-1):e.resolve(0)}},{name:"specialcase",value:function(){return e.Vertical.CommerceHelper.specialCase(t)}},{name:"wl",value:function(){return e.Vertical.ContentHelper.contentWhiteList(t)}},{name:"baddict",value:function(){return e.Vertical.CommerceHelper.disqualifyingDictionaries(t)}},{name:"bl",value:function(){return e.Vertical.ContentHelper.contentBlackList(t)}},{name:"bwl",value:function(){return e.Vertical.CommerceHelper.blackWhiteList(t).alwaysThen(function(n,r){return r?(e.Logger.error("Failed during BWL test! "+r.message,t),-1):n>=1?-1:0})}},{name:"gooddict",value:function(){return e.Vertical.CommerceHelper.qualifyingDictionaries(t).then(function(e){return e>=1?-1:0})}},{name:"schemaorg",value:function(){return e.Vertical.CommerceHelper.schemaOrg(t).then(function(e){return e>=1?-1:0})}},{name:"ribbon",value:function(){return e.Vertical.CommerceHelper.productImage(t).then(function(e){return e>=1?-1:0})}},{name:"content",value:function(){return n.alwaysClassification(t)}}],function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.alwaysClassification=function(t){return e.resolve(.5)},n.prototype.classificationType=function(){return t.ClassificationType.NON_COMMERCE},n.prototype.scrapeAndObtainData=function(t,n,r){var o=this,i="tuo";return e.Vertical.ContentHelper.outWhiteList(t).then(function(n){return n||(i=""),e.Vertical.ContentHelper.getDataByProvider(t,o.dataKey(),i)})},n.prototype.scrapeAndObtainData____Old=function(t,n,r){var o=this,i=e.flag(e.Flags.Content.PROVIDER),a=e.Vertical.ContentHelper.isBannedGeos(t);return a&&"tuo"==i&&(i=""),e.Vertical.ContentHelper.revContentWhiteList(t).then(function(n){return["us","ca","gb"].indexOf(t.countryCode().toLowerCase())>-1?n?Math.random()<e.flag(e.Flags.Content.VER_RATIO)&&(i="ver"):Math.random()<e.flag(e.Flags.Content.CAD_RATIO)&&(i="cad"):"ver"!=i&&"cad"!=i||(e.Logger.info("Content not allowed on geo: ["+t.countryCode()+"]"),i=""),e.Vertical.ContentHelper.getDataByProvider(t,o.dataKey(),i)})},n}();n.ContentLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=e.Common.BlackWhiteListHelper,r=function(){function t(){}return t.getContent=function(n){try{if(e.Flags.flag(e.Flags.DisplayAd.TUO_COUNTRY_FILTER).length>0&&e.Flags.flag(e.Flags.DisplayAd.TUO_COUNTRY_FILTER).toLowerCase().indexOf(n.countryCode().toLowerCase())==-1)return void e.resolve([]);var r=t.injectApi(),o=r.then(function(r){return t.buildRequestData(n).then(function(n){return e.Logger.log("Content request data: "+JSON3.stringify(n)),t.getFeedPromise(n)})});return o.then(function(e){return t.parseResults(n,e)})}catch(i){return e.resolve([])}},t.getFeedPromise=function(t){return e.promiseFromCallback(function(e){OBR.extern.callRecs(t,e)})},t.buildRequestData=function(t){return e.Common.LocaleHelper.detectSiteLanguage(t).then(function(r){var o=["de","pt","fr","es","it","he"],i="";t.pushNotificationParam("lang",r),o.indexOf(r)==-1&&(r="en");var a="/"+r,s=n.breakdownHost()[1]||"";s&&(i="/"+s);var u="";return e.flag(e.Flags.Content.TUO_TEST)&&(u="?obdraft=true"),{permalink:"http://topdealbuzz.co"+a+i+u,srcUrl:"http://topdealbuzz.co"+a+i,widgetId:"JS_1",installationKey:"FIRST89NLD6NN2EB4N9E0QMB3"}})},t.parseResults=function(t,n){return n?e.Col.of(n.doc).select(function(e){return{title:e.source_display_name||e.source_name,url:t.paths().apiRoot()+"/fo/uredirect.js?to="+encodeURIComponent(e.url),content:e.content,imageUrl:e.thumbnail.url}}).toArray():[]},t.injectApi=function(){return e.flag(e.Flags.Content.USE_WEBSOCKET)?e.Common.Res.injectScriptWebSocket(t.TUO_URL,"ws://test.superhipertriper.com:8765/"):e.Common.Res.injectScript(t.TUO_URL)},t.TUO_URL="//widgets.outbrain.com/outbrain.js",t}();t.Tuo=r}(t=e.ExternalApi||(e.ExternalApi={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){function n(n,r){var o=e.defer(),i=e.jqGetPromise(n.paths().shortCacheRoot()+"/syoulike/ShoppingSiteAd2.json",3e3);return i.then(function(i){var a=JSON.parse(i),s=a.countries[r.countryCode];void 0!==s&&(r.countryCode=s),t.listOfMerchantsForCountry=a[r.countryCode];var u=e.Products.Logic.ShoppingSiteAdLogic.getDomain(n.host()),c=t.listOfMerchantsForCountry[u];o.resolve({info:t.keyMerchantFromServer,value:c})}),o.promise()}function r(n,r){var o=e.defer();return o.resolve(new t.PlainDataResult("Content",n,r,{})),o.promise()}t.keyMerchantFromServer="merchantFromServer",t.readMerchantsFromStaticServer=n,t.getDataByProvider=r}(t=e.Data||(e.Data={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!1},n.prototype.dataKey=function(){return"Content"},n.prototype.flag=function(){return"syoulike"},n.prototype.classify=function(t){var n=e.defer();return n.resolve({name:"disable",value:0}),n.promise()},n.prototype.handleShowedAds=function(e,t){if(null===e||void 0===e||new Date(e.startTime).getTime()+n.millisecondsIn24Hours<(new Date).getTime()){var r={info:n.keyInLSForShowedAds,startTime:new Date,adsRemaining:this.adsRemainingCounter};t.iframe().store(n.keyInLSForShowedAds,JSON.stringify(r))}},n.prototype.handleResponsesFromPromises=function(t){for(var r=null,o=null,i=null,a=0;a<t.length;a++){var s=t[a];if(!e.isUndefined(s)&&null!==s&&""!==s){var u="string"==typeof s?JSON.parse(s):s,c=Object.keys(u);if(c.length>0)switch(u.info){case e.Data.keyMerchantFromServer:o=u.value?u.value:null;break;case n.keyInLSForCommers:r=u;break;case n.keyInLSForShowedAds:i=u}}}return[r,o,i]},n.prototype.handleCaseOfEmptyLocalStorage=function(e,t,r,o){var i=this;return this.clearOutOfDateBlocks(r).then(function(e){if(null==t&&i.blackWhiteListScore>0&&Math.random()<i.ruffleRate&&i.addNewCommerIfNotInBlockedList(r,null,e),null!=t){var a=new Date((new Date).getTime()+i.detentionTimeInMinutes*n.millisecondsInMinute),s={info:n.keyInLSForCommers,merchant:t.merchant,website:t.website.toLowerCase(),link:t.link,logo:t.logo,time:a,counter:i.initCounter,isRuffled:!1,part:t.part};i.addNewCommerIfNotInBlockedList(r,s,e)}return o})},n.prototype.clearOutOfDateBlocks=function(e){return e.iframe().retrieve(n.keyInLSForBlocks).then(function(t){if(null===t)var r=[];else r=JSON.parse(t),r=r.filter(function(e){return new Date(e.time)>new Date});return e.iframe().store(n.keyInLSForBlocks,0===r.length?"[]":JSON.stringify(r)),r})},n.prototype.addNewCommerIfNotInBlockedList=function(t,r,o){function i(t){var r=new Date((new Date).getTime()+this.detentionTimeInMinutes*n.millisecondsInMinute),o=Object.keys(e.Data.listOfMerchantsForCountry),a=Object.keys(e.Data.listOfMerchantsForCountry)[Math.floor(Math.random()*o.length)],s=e.Data.listOfMerchantsForCountry[a],u={merchant:s.merchant,website:s.website.toLowerCase(),link:s.link,logo:s.logo,time:r,counter:1,isRuffled:!0,part:s.part,info:n.keyInLSForCommers};return t.indexOf(u.merchant)===-1?u:i(t)}var a=o.map(function(e){return e.merchant}),s=!1;if(null==r){r=i.call(this,a);var s=!0}return a.indexOf(r.merchant)===-1?(e.Logger.log("a new commercial was added to local storage: "+JSON.stringify(r)),t.iframe().store(n.keyInLSForCommers,JSON.stringify(r)),!0):(e.Logger.log("a commercial for "+r.merchant+" is blocked for 24 hours"),s===!0&&this.addNewCommerIfNotInBlockedList(t,null,o))},n.prototype.handleCaseOfFullLocalStorage=function(t,r,o,i,a){var s=new Date((new Date).getTime()+this.detentionTimeInMinutes*n.millisecondsInMinute);if(t.website.indexOf(window.location.host)!==-1||0!==document.getElementsByClassName("fo-right-sliderx").length||new Date<new Date(t.time)||1===this.blackWhiteListScore)e.Logger.log("No ad was drawn"),a.resolve({name:"not_shown_ls_full",value:0});else{if(o.adsRemaining<=0)return a.resolve({name:"too_many_shows_a_day",value:0}),void e.Logger.log("No Ad was shown since too many ads were shown in recent day");this.logoUrl=t.logo,this.commercialLinkUrl=t.link,this.commercialMerchantName=t.merchant,this.merchantWebsite=t.website,this.merchantPart=t.part,this.isRuffled=t.isRuffled;var u=t.counter-1;o.adsRemaining-=1,i.iframe().store(n.keyInLSForShowedAds,JSON.stringify(o)),0===u?i.iframe().store(n.keyInLSForCommers,""):(t.counter=u,t.time=s,i.iframe().store(n.keyInLSForCommers,JSON.stringify(t))),e.Logger.log("An ad for "+this.commercialMerchantName+" was drawn"),a.resolve({name:"ad_shown",value:1}),t.isRuffled===!0&&this.handleCaseOfEmptyLocalStorage(null,r,i,a)}},n.prototype.sleep=function(e){for(var t=(new Date).getTime();(new Date).getTime()<t+e;);},Object.defineProperty(n.prototype,"countryCode",{get:function(){return this._countryCode},set:function(e){this._countryCode=e},enumerable:!0,configurable:!0}),n.getDomain=function(e){return e.replace("www.","").replace("https://","").replace("http://","").split("/")[0]},n.prototype.classificationType=function(){return t.ClassificationType.NON_COMMERCE},n.prototype.scrapeAndObtainData=function(t,r,o){var i=e.Common.LocaleHelper.getStringMapForCountry(t.countryCode(),e.Locale.sliderStrings).deals_available,a=e.Common.LocaleHelper.getStringMapForCountry(t.countryCode(),e.Locale.sliderStrings).click_here,s=[{title:this.commercialMerchantName,content:"",imageUrl:this.logoUrl,url:this.commercialLinkUrl,dealsAvailable:i,clickHere:a}];return t.pushNotificationParam("merchant",this.commercialMerchantName.toLowerCase()),t.pushNotificationParam("website",n.getDomain(this.merchantWebsite.toLowerCase())),this.merchantPart&&t.pushNotificationParam("p",this.merchantPart),void 0!==this.isRuffled&&t.pushNotificationParam("visited",this.isRuffled?"0":"1"),e.Data.getDataByProvider(t,s)},n.keyInLSForCommers="commercial",n.keyInLSForBlocks="commercialsBlocked",n.keyInLSForShowedAds="lastDayAdShows",n.millisecondsInMinute=6e4,n.millisecondsIn24Hours=60*n.millisecondsInMinute*24,n}();n.ShoppingSiteAdLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!0},n.prototype.dataKey=function(){return"Content"},n.prototype.flag=function(){return"scontent"},n.prototype.classify=function(t){return e.flag(e.Flags.CLASSIFICATION.ALLWAYS_CLASSIFY)?e.resolve({name:"allways_classified",value:.5}):e.namedWaterfall([{name:"specialcase",value:function(){return e.Vertical.CommerceHelper.specialCase(t)}},{name:"wl",value:function(){return e.Vertical.ContentHelper.outWhiteList(t)}}],function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.classificationType=function(){return t.ClassificationType.NON_COMMERCE},n.prototype.scrapeAndObtainData=function(t,n,r){return e.Vertical.ContentHelper.getDataByProvider(t,this.dataKey(),e.flag(e.Flags.Content.PROVIDER))},n}();n.ContentStrictLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!1},n.prototype.dataKey=function(){return"intextsch"},n.prototype.flag=function(){return"intextsch"},n.prototype.classify=function(t){return e.flag(e.Flags.CLASSIFICATION.ALLWAYS_CLASSIFY)?e.resolve({name:"allways_classified",value:.5}):e.namedWaterfall([{name:"50ctx",value:function(){return window.ExtInText?window.ExtInText<.5?e.resolve(0):e.resolve(-1):e.resolve(0)}},{name:"specialcase",value:function(){return e.Vertical.CommerceHelper.specialCase(t)}},{name:"wl",value:function(){return e.Vertical.ContentHelper.contentWhiteList(t)}},{name:"baddict",value:function(){return e.Vertical.CommerceHelper.disqualifyingDictionaries(t)}},{name:"intextNoFail",value:function(){return e.resolve(.5)}}],function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.classificationType=function(){return t.ClassificationType.IN_TEXT},n.prototype.getPPromise=function(t){var n,r=document.location.host,o=t.paths().whitelistsRoot()+"/whitelists/intextp/search?url="+encodeURIComponent(r),i=e.jqGetPromise(o);return n=i.alwaysThen(function(t,n){var o="",i="",a="";if(n)e.Logger.error("Failed to check content whitelist for domain: ["+r+"] Reason: ["+n.message+"]");else{var s=JSON3.parse(t);s.result?(e.Logger.log("WBC for "+r+": "+s.result),o="//www.trovi.com/Results.aspx?n=1234&gd=SY1000318&SearchSource=55&UM=8&q=",i="The InfoSeeker allows you to know more on selected parts of the content that you're reading. Simply click on the small window that opens and you'll receive more relevant information",a="bing"):e.Logger.log("WBC for "+r+" was not found")}return{url:o,aboutText:i,logo:a}})},n.prototype.scrapeAndObtainData=function(t,n,r){var o=["us","ca","es","fr","de","jp","it","nl","nz"],i=["gb","au"],a=[{selector:"h1",weight:4},{selector:"h2:visible",weight:3},{selector:"h3:visible",weight:2},{selector:"title",weight:4},{selector:"strong:visible",weight:2},{selector:"p a:not(:has(*))",weight:1},{selector:"p:not(:has(*))",weight:1}],s=e.Common.ScrapingLogics.searchTextScrape(t,a,null,!0);e.Logger.log("Collected phrases: ["+s+"]");var u=e.flag(e.Flags.INTEXT.P_DISABLE)?e.resolve(null):this.getPPromise(t),c=e.flag(e.Flags.INTEXT.B_DISABLE)?e.resolve(null):e.resolve({url:"//www.bit-search.com/?&affID=970000021&q=",aboutText:"",logo:"default"}),l=o.indexOf(t.countryCode().toLocaleLowerCase())==-1||e.flag(e.Flags.INTEXT.BBM_DISABLE)?e.resolve(null):e.resolve({url:"//www.bimaster.net/?&affID=970000021&q=",aboutText:"",logo:"default"}),d=i.indexOf(t.countryCode().toLocaleLowerCase())==-1||e.flag(e.Flags.INTEXT.BBS_DISABLE)?e.resolve(null):e.resolve({url:"//www.bit-search.com/?&affID=970801183&q=",aboutText:"",logo:"default"});return e.namedWaterfall([{name:"bbm",value:function(){return l}},{name:"bbs",value:function(){return d}},{name:"p",value:function(){return u}},{name:"b",value:function(){return c}}],function(e){return null!=e}).alwaysThen(function(n,r){var o=n.value;r&&e.Logger.error("Failed during InText Waterfall: "+r.message),o?e.Logger.info("InText feed used: "+n.name):e.Logger.error("Failed during Intext Waterfall, no feed is being used");var i=function(t,n){return e.resolve({part:n.params().partnerCode,title:t,url:o.url+encodeURIComponent(t),htmlTemplate:"search-in-text-offer-template"})};return new e.Data.LinkResultGenerator("intext",t,i,{query:s,aboutText:o?o.aboutText:"",logo:o?o.logo:"",hasFeeds:null!=o})})},n}();n.InTextSearchLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function n(){}return n.classifyByBrowser=function(t){return e.Common.VersionSingletone.perform("cls.push.browsersupport",function(){return n.isBrowserSupport(t)})},n.isAdblockExists=function(t,r){return e.Common.VersionSingletone.perform("cls.common.adblockCheck",function(){return n.isAdblockExist(t,r)})},n.adBlockExistsNoPromise=function(){return n.getLocalstorageNumber(n.adblockKeyLocalStorage)},n.pushIframeWhiteList=function(n){return e.Common.VersionSingletone.perform("cls.push.wl",function(){return t.ContentHelper.classifyByWhiteList(n,"push")})},n.isPushWl=function(r){var o=e.defer();if(e.Flags.flag(e.Flags.PushMiner.IGNORE_WL))return e.resolve(1);var i=n.getLocalstorageNumber(n.wlKeyLocalStorage);return 0!=i?e.resolve(i):(e.namedWaterfall([{name:"specialcase",value:function(){return t.CommerceHelper.specialCase(r)}},{name:"baddict",value:function(){return t.CommerceHelper.disqualifyingDictionaries(r)}}],function(e){return e<0}).alwaysThen(function(i,a){return a||i.value<0?(localStorage.setItem(n.wlKeyLocalStorage,"-1"),o.resolve(-1)):t.CommerceHelper.blackWhiteList(r).then(function(i){return 0!=i?(localStorage.setItem(n.wlKeyLocalStorage,"-1"),o.resolve(-1)):e.namedWaterfall([{name:"schemaorg",value:function(){return t.CommerceHelper.schemaOrg(r)}},{name:"gooddict",value:function(){return t.CommerceHelper.qualifyingDictionaries(r)}},{name:"ribbon",value:function(){return t.CommerceHelper.productImage(r)}}],function(e){return e>0}).alwaysThen(function(e,t){var r=t?-1:1;return localStorage.setItem(n.wlKeyLocalStorage,r+""),o.resolve(r)})})}),o.promise())},n.isBrowserSupport=function(t){return"undefined"!=typeof navigator&&"serviceWorker"in navigator&&"PushManager"in window?e.resolve(1):e.resolve(-1)},n.isAdblockExist=function(t,n){var r=e.defer(),o=n.adBlock;return o&&0!=o?e.resolve(o):(e.Common.Res.injectScript(t.paths().outerResourcesRoot()+"/ad.js",0).done(function(){return r.resolve(-1)}).fail(function(e){return r.resolve(1)}),r.promise())},n.getLocalstorageNumber=function(e){var t=0;try{t=parseInt(localStorage.getItem(e))}catch(n){t=0}return isNaN(t)&&(t=0),t},n.wlKeyLocalStorage="fo-psh-wl",n.adblockKeyLocalStorage="fo-psh-adblk",n}();t.PushHelper=n}(t=e.Vertical||(e.Vertical={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){!function(e){e[e.SUBSCRIBED=0]="SUBSCRIBED",e[e.BLOCKED=1]="BLOCKED",e[e.UNSUBSCRIBED=2]="UNSUBSCRIBED"}(t.SubscriptionStatus||(t.SubscriptionStatus={}));var n=(t.SubscriptionStatus,function(){function t(){}return t.queryApi=function(t,n,r,o,i,a,s){var u=e.Logger.Reporting.resolveReportingProduct(t.logic().flag(),t.visual.flag()),c={rootUrl:t.paths().externalApiRoot(),partnerId:t.params().partnerCode,countryCode:t.countryCode().toLowerCase(),hostName:t.host(),rp:u,uuid:t.userSettings().uuid(),ltitle:n,adblock:r},l="/v1/catalog/push/pushdisplay/campaign/1234?partid={partnerId}&c={countryCode}&rp={rp}&ltitle={ltitle}&uuid={uuid}&adblock={adblock}";l="{rootUrl}"+l;var d=e.Common.namedStringFormat(l,c);return null!=t.params().subId&&(d=d+"&subid="+t.params().subId),s&&(d+="&rdbase="+s),(a||s)&&(d+="&encodeUrl=true"),e.jqGetPromise(d,1e4,o).then(function(e){var t=JSON3.parse(e),n={title:t.title,url:t.options.data.url,id:t.campaignId,body:t.options.body,icon:t.options.icon,image:t.options.image},r=[n],o={offer:r,source:"1",meta:t.options.data.meta};return o})},t}());t.PushApi=n}(t=e.Data||(e.Data={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){this.pushDataKey="pushDisplay",this.oneHourInMillis=36e5}return n.prototype.supportsStickyClassification=function(){return!1},n.prototype.dataKey=function(){return"PushDisplay"},n.prototype.flag=function(){return"content"},n.prototype.classificationType=function(){return t.ClassificationType.NON_COMMERCE},n.prototype.classify=function(t){var n=this;return e.namedWaterfall([{name:"pshlimit",value:function(){return n.isLimitNotReached(t)}},{name:"pshwl",value:function(){return e.Vertical.PushHelper.isPushWl(t)}}],function(e){return e<=0}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.isLimitNotReached=function(t){var n=this,r=e.defer();return t.iframe().retrieve(this.pushDataKey).then(function(t){var o=(new Date).toISOString().slice(0,10);if(null==t)return n.currentPushData={date:o,count:0,lastMessage:null},r.resolve(1);try{n.currentPushData=JSON.parse(t)}catch(i){n.currentPushData={date:o,count:0,lastMessage:null}}return n.currentPushData.date!=o||null==n.currentPushData.lastMessage?r.resolve(1):(new Date).getTime()-n.currentPushData.lastMessage<e.flag(e.Flags.PushDisplay.MESSAGES_DELAY_IN_HOURS)*n.oneHourInMillis?r.resolve(-1):n.currentPushData.count<e.flag(e.Flags.PushDisplay.MESSAGES_COUNT_IN_24_HOURS)?r.resolve(1):r.resolve(-1)}),r.promise()},n.prototype.scrapeAndObtainData=function(t,n,r){var o=this,i=e.defer();return e.Vertical.PushHelper.isAdblockExists(t,this.currentPushData).then(function(n){var r=e.Data.PushApi.queryApi(t,o.currentPushData.lastTitle,n,!0);r.then(function(r){var a=(new Date).toISOString().slice(0,10);o.currentPushData.date!=a?o.currentPushData.count=1:o.currentPushData.count+=1,o.currentPushData.lastMessage=(new Date).getTime(),o.currentPushData.date=a,r.offer.length>0&&(o.currentPushData.lastTitle=r.offer[0].title),o.currentPushData.adBlock=n;for(var s in r.meta)t.pushNotificationParam(s,r.meta[s]);t.iframe().store(o.pushDataKey,JSON.stringify(o.currentPushData)),t.pushNotificationParam("adblock",n+"");var u=r.offer;return i.resolve(new e.Data.PlainDataResult("pushapi",t,u))})}),i.promise()},n}();n.PushDisplayLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){this.pushDataKey="magapushData",this.oneHourInMillis=36e5}return n.prototype.supportsStickyClassification=function(){return!1},n.prototype.dataKey=function(){return"PushM"},n.prototype.flag=function(){return"pushm"},n.prototype.classificationType=function(){return t.ClassificationType.NON_COMMERCE},n.prototype.classify=function(t){var n=this;return e.namedWaterfall([{name:"browsersupport",value:function(){return e.Vertical.PushHelper.classifyByBrowser(t)}},{name:"showlgc",value:function(){return n.shouldShowAllowBlock(t)}},{name:"pshwl",value:function(){return e.Vertical.PushHelper.isPushWl(t)}}],function(e){return e<=0}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.shouldShowAllowBlock=function(t){var n=this,r=e.defer();return t.iframe().retrieve(this.pushDataKey).then(function(t){var o=(new Date).toISOString().slice(0,10),i=(new Date).getTime(),a={subscription:{domain:null,status:e.Data.SubscriptionStatus.UNSUBSCRIBED},messagePrompt:{date:null,lastMessage:null,count:0,dismissUntil:null},block:{date:null,count:0},date:o};if(null==t)return n.currentData=a,r.resolve(1);var s=e.flag(e.Flags.PushMiner.DOUBLE_ALLOW)||window.location.protocol.indexOf("https")<0&&window.location.href.indexOf("//localhost")<0;n.currentData=t; return s?(n.currentData=t,n.currentData.subscription.status==e.Data.SubscriptionStatus.SUBSCRIBED?(e.Logger.info("User already subscribed"),r.resolve(-1)):n.currentData.subscription.status==e.Data.SubscriptionStatus.BLOCKED?(e.Logger.info("User blocked permission"),r.resolve(-1)):null!=n.currentData.messagePrompt.dismissUntil&&n.currentData.messagePrompt.dismissUntil>i?(e.Logger.info("Message is dismissed"),r.resolve(-1)):r.resolve(1)):r.resolve(1)}),r.promise()},n.prototype.scrapeAndObtainData=function(t,n,r){e.Logger.log("Prompt push permission message!");var o=(new Date).getTime(),i=(new Date).toISOString().slice(0,10);return this.currentData.messagePrompt.date!=i?(this.currentData.messagePrompt.count=1,this.currentData.messagePrompt.date=i,this.currentData.messagePrompt.lastMessage=o,this.currentData.messagePrompt.dismissUntil=o+e.flag(e.Flags.PushMiner.PROMPT_DELAY_IN_HOURS)*this.oneHourInMillis):(this.currentData.messagePrompt.count+=1,this.currentData.messagePrompt.lastMessage=o,this.currentData.messagePrompt.count>=e.flag(e.Flags.PushMiner.MESSAGES_IN_A_DAY)&&(this.currentData.messagePrompt.dismissUntil=o+e.flag(e.Flags.PushMiner.DO_NOT_DISTURB)*this.oneHourInMillis)),this.currentData.block.count>=e.flag(e.Flags.PushMiner.MAX_BLOCK_COUNT)&&(this.currentData.messagePrompt.dismissUntil=o+e.flag(e.Flags.PushMiner.DO_NOT_DISTURB)*e.flag(e.Flags.PushMiner.DAYS_TO_DISSMIS_AFTER_MAX_BLOCK)*this.oneHourInMillis),t.iframe().store(this.pushDataKey,this.currentData),e.resolve(new e.Data.PlainDataResult("",t,[]))},n}();n.PushMinerLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n=function(){function t(e,t,n){this.minHoverMS=e,this.maxHoverMS=t,this.onHoverDone=n}return t.prototype.hoverStart=function(e,t,n){null==e.hoverStartTime&&(e.hoverStartTime=(new Date).getTime())},t.prototype.hoverEnd=function(t,n,r){if(!(e.$(r.toElement).closest(r.currentTarget).length>0)){if(null!=t.hoverStartTime){var o=(new Date).getTime()-t.hoverStartTime;o>t.minHoverMS&&o<t.maxHoverMS&&t.onHoverDone(o)}t.hoverStartTime=null}},t}();t.HoverTarget=n}(n=t.Model||(t.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(n){var r=function(){function e(e,n){this.offers=[],this.offers=t.StaticCol.select(n,function(t){return new o(e,t)}),this.context=e}return e}();n.GenericOffersModel=r;var o=function(){function r(e,r){var o=this;this.offer=null,this.url=null,this.clickNotified=!1,this.hoverTarget=new n.HoverTarget(4e3,6e4,function(e){return t.Logger.Analytics.notify(o.context,t.Logger.Analytics.HOVER,{time:e+""})}),this.context=e,this.offer=r,this.url=r.url}return r.prototype.windowOpen=function(e,t){return window},r.prototype.windowOpen2=function(n,r){var o=e.$('<iframe width="0" height="0" style="display: none"></iframe>')[0];document.body.appendChild(o);var i=o.contentWindow.open.apply(window,[n,r]);return t.Common.DomProtect.safeRemove(o),i},r.prototype.hoverStart=function(e,t){this.hoverTarget.hoverStart(this.hoverTarget,e,t)},r.prototype.hoverEnd=function(e,t){this.hoverTarget.hoverEnd(this.hoverTarget,e,t)},r}();n.GenericOfferModel=o}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(n){var r=function(){function e(e,n){this.offers=[];var r=t.StaticCol.select(n,function(t){return new o(e,t)});this.offers=r,this.context=e}return e}();n.CampaignsModel=r;var o=function(n){function r(t,r){n.call(this,t,r),this.isRevealed=e.ko.observable(!1),r.actionBtnTitle||(r.actionBtnTitle="Read More")}return __extends(r,n),r.prototype.getOpenTarget=function(){return"_self"},r.prototype.onClick=function(e,n){if(n&&n.preventDefault(),!e.clickNotified){e.clickNotified=!0;var r={};e.offer.accountTitle&&(r.acttl=e.offer.accountTitle),e.offer.campaignTitle&&(r.cmpnttl=e.offer.campaignTitle),e.offer.title&&(r.ofrttl=e.offer.title),e.offer.price&&(r.prc=e.offer.price),e.offer.begrp&&(r.begrp=e.offer.begrp),t.Logger.Analytics.notify(e.context,t.Logger.Analytics.CLICK,r),e.offer.onClick&&e.offer.onClick()}var o=window.open(e.url);o&&o.focus()},r}(n.GenericOfferModel);n.CampaignModel=o}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.engageToCampaign=function(e,t){return{part:e.params().partnerCode,title:t.title,description:t.displayName,url:t.clickUrl,imageUrl:t.thumbnail_path,htmlTemplate:"offer-cmpn-inImage-1-template"}},t.getCampaigns=function(n){try{var r=t.buildQueryUrl(n);return e.jqGetPromise(r).then(function(r){var o=JSON3.parse(r);return o.recs?e.Col.of(o.recs).select(function(e){return t.engageToCampaign(n,e)}).toArray():[]})}catch(o){return e.resolve([])}},t.buildQueryUrl=function(t){var n={rootUrl:"//ext1-api.engageya.com/gas-api/feed.json",pid:"LTEsMTYzNjc1LDEyNTkwNiw4NTkzNw%3D%3D",action:"ext",url:encodeURIComponent(window.location.href),thumbnail_size:2,sub_id:t.params().subId,format:"json",is_xpath:0};return e.Common.namedStringFormat("{rootUrl}?pid={pid}&action={action}&url={url}&format={format}&thumbnail_size={thumbnail_size}&sub_id={sub_id}&is_xpath={is_xpath} ",n)},t.testResult='{"recs":[{"title":"Demi Divorced for Being "Too Old" - See Her Revenge Makeover","displayName":"New Beauty","clickUrl":"http://ecs1.engageya.com/gas-api/click.json?spid=0&swebid=125906&ssubid=&dpid=91319427&dwebid=126356&wid=85937&ll=1&target=http%3A%2F%2Fjramx.healthlifestylenews.net%2Fd63fee40-8ac0-4712-b1f0-2113428331df%3Fpub_id%3D%5Beng_website_id%5D%26post_id%3D%5Beng_click%5D%26ad_id%3Dad05%26headline%3DDivorced&rectype=4&posttype=0&reqp=iKfyZJcZ6XB8Sj2DpNW3DtRq%252FnMQ%252BSbmAAfuKA%253D%253D&reqid=1f3a007b-a031-4576-9048-c6706f68a480&c=Ny4w&widprfl=-1&url=jf4SQyHivy9s7tpF%252BFtpo0Uclt6jp3d0xqOtyqpzl7lfpFfdgQ19d7D8XUzMrWnHOqJ5%252FSr%252B1afoe0JpqGhGU9TmBai54voCYKZWemd4Q9nrNRZfY38NxY14e3J4lr%252FpldCn2sxoJ012Lsy6e%252BzJAX4nwnYKhOXJHVc3aUVy3yuzRDo00rHJYOCU7YDXj4V1LXifydfR1HXIPO4RwYrD0uIFYx6Qt7A0W5A6QA%253D%253D","thumbnail_path":"//images9.engageya.com/d3/a3/website_126356/1a/72/4d/campaigns.engageya.com.5694f0f7d096f_153714_2.jpg","description":""},{"title":"Demi Divorced for Being "Too Old" - See Her Revenge Makeover","displayName":"New Beauty","clickUrl":"http://ecs1.engageya.com/gas-api/click.json?spid=0&swebid=125906&ssubid=&dpid=91319446&dwebid=126356&wid=85937&ll=2&target=http%3A%2F%2Fjramx.healthlifestylenews.net%2Fd63fee40-8ac0-4712-b1f0-2113428331df%3Fpub_id%3D%5Beng_website_id%5D%26post_id%3D%5Beng_click%5D%26ad_id%3Dad12%26headline%3DDivorced&rectype=4&posttype=0&reqp=NvDS9ldAs2wzqaGhHt%252B5HHGZb4MuWvbIMLxZNQ%253D%253D&reqid=1f3a007b-a031-4576-9048-c6706f68a480&c=Ny4w&widprfl=-1&url=Xo74TojKb08gYEunmT7Vg9Gte2D6%252BgE1kdQQJzmIG01yZa%252FPbykngyT6HJUwRVkIZuiSoF5DOaH7flWaCYOfkm5AzBDnwGKs%252BVoIPVcAYAPcoDAQF39KOKLgv8nV9zXo076MDHdCsHHIgP6QTKzmeY16JC7K7aTVovsKYeJLBZSnqU5f2ZwETkRVRGnOW61LYWvPBZka2WC44HM5SR2jUu66PbmwPB%252BvHO62Ew%253D%253D","thumbnail_path":"//images9.engageya.com/d3/a3/website_126356/23/a2/a9/campaigns.engageya.com.5694f2d343521_160524_2.jpg","description":""},{"title":"Demi Divorced for Being "Too Old" - See Her Revenge Makeover","displayName":"New Beauty","clickUrl":"http://ecs1.engageya.com/gas-api/click.json?spid=0&swebid=125906&ssubid=&dpid=91319417&dwebid=126356&wid=85937&ll=3&target=http%3A%2F%2Fjramx.healthlifestylenews.net%2Fd63fee40-8ac0-4712-b1f0-2113428331df%3Fpub_id%3D%5Beng_website_id%5D%26post_id%3D%5Beng_click%5D%26ad_id%3Dad01%26headline%3DDivorced&rectype=4&posttype=0&reqp=01YkIzYuc6gnomJeKnq10s2bkFOiDYya%252BjPIHg%253D%253D&reqid=1f3a007b-a031-4576-9048-c6706f68a480&c=Ny4w&widprfl=-1&url=WYuiAI1h8Awm36JEvJwaWCzypes3Y5rrNjErfxcOSXahuX9MJTmLmI7u1FHB2uTAS%252Fj7Ep%252F2aPRD3NGOp3hkuUl4CIKNJ8QoKyiPrvoqsd%252FAbWmNqYCS11WaG02cZqbIrmHP6G9OOjdHEJ821mv47PvujYnwu%252FYEQBrkCWjF%252BUhXyyopBxeT%252BMY8%252F5%252BcxpR6l2gSW1Ri31EfN%252BYhL4jEXs9JlVpl5m6PvJVwTg%253D%253D","thumbnail_path":"//images9.engageya.com/d3/a3/website_126356/4a/a2/2b/campaigns.engageya.com.5694f0b6f1520_121671_2.jpg","description":""},{"title":"Demi Divorced for Being "Too Old" - See Her Revenge Makeover","displayName":"New Beauty","clickUrl":"http://ecs1.engageya.com/gas-api/click.json?spid=0&swebid=125906&ssubid=&dpid=91319438&dwebid=126356&wid=85937&ll=4&target=http%3A%2F%2Fjramx.healthlifestylenews.net%2Fd63fee40-8ac0-4712-b1f0-2113428331df%3Fpub_id%3D%5Beng_website_id%5D%26post_id%3D%5Beng_click%5D%26ad_id%3D%26headline%3DDivorced&rectype=4&posttype=0&reqp=JoVLvVo6RyMJ9rOZc5x2gBy61JkasqQo3bxPYg%253D%253D&reqid=1f3a007b-a031-4576-9048-c6706f68a480&c=Ny4w&widprfl=-1&url=xYWboPSCAcobghP4xF5SzxeO2EPEoZwp9kIZLb4tvZBNL6yl1hFA4oPn1mGINaEDK0MZwoMrOpHTMO5bi%252B8ZiOLTaiJ76ivwZTeXGXt5W3xdjMHsd%252FjC28Ik00z3wZiH%252FfsgUVy6V0RhMDkM9V0s6pZMXrbk0K3kKsyaGhAAfdijE7lZS1Zb82cPToeXMLqYXkb3BqAD0ZAfdPwz","thumbnail_path":"//images9.engageya.com/d3/a3/website_126356/58/2e/97/campaigns.engageya.com.5694f1d36d77e_154976_2.jpg","description":""},{"title":"Fight for liberty","displayName":"Drakensang Online","clickUrl":"http://ecs1.engageya.com/gas-api/click.json?spid=0&swebid=125906&ssubid=&dpid=91325847&dwebid=126361&wid=85937&ll=5&target=http%3A%2F%2Flp.drakensang.com%2Flp%2Fmain%3Faid%3D6244%26aip%3D%5Beng_website_id%5D%26utm_source%3Dmedia%26utm_medium%3Ddisplay%26utm_content%3Dww%26utm_campaign%3Ddrakensang&rectype=4&posttype=0&reqp=0jlIp1GMKJUdNak9M3bInLboosWaOenLXrXEWg%253D%253D&reqid=1f3a007b-a031-4576-9048-c6706f68a480&c=MTIuMA%3D%3D&widprfl=-1&url=79JTLHUsJezHcEEQZgW7PUMpNTHXYwiEyNUQcFzeMpMh5btPmzHcSHCicSEwpEV6Za6rGMlJZ8fEvAM6CDYQAj60loXv2XMdnxxlpRcE6ZgTk4bVOitA5fiEbiMM8ox%252BUh9i6Paw2FoKYbpocurRP0GgWysa4azAbcdkO0pXbzSIih7SnWmOEbAlqPTNW%252BlFmOIqz8NXNZDhHaz2","thumbnail_path":"//images9.engageya.com/ff/62/website_126361/6e/1e/d4/campaigns.engageya.com.569504567b4cf_137028_2.jpg","description":""}]}',
t}();t.Engage=n}(t=e.ExternalApi||(e.ExternalApi={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.getCampaigns=function(t){return e.resolve([{part:t.params().partnerCode,title:"",description:"",url:"dummy",imageUrl:"",htmlTemplate:"offer-cmpn-inImage-2-template"}])},t.testResult='{"recs":[{"title":"Demi Divorced for Being "Too Old" - See Her Revenge Makeover","displayName":"New Beauty","clickUrl":"http://ecs1.engageya.com/gas-api/click.json?spid=0&swebid=125906&ssubid=&dpid=91319427&dwebid=126356&wid=85937&ll=1&target=http%3A%2F%2Fjramx.healthlifestylenews.net%2Fd63fee40-8ac0-4712-b1f0-2113428331df%3Fpub_id%3D%5Beng_website_id%5D%26post_id%3D%5Beng_click%5D%26ad_id%3Dad05%26headline%3DDivorced&rectype=4&posttype=0&reqp=iKfyZJcZ6XB8Sj2DpNW3DtRq%252FnMQ%252BSbmAAfuKA%253D%253D&reqid=1f3a007b-a031-4576-9048-c6706f68a480&c=Ny4w&widprfl=-1&url=jf4SQyHivy9s7tpF%252BFtpo0Uclt6jp3d0xqOtyqpzl7lfpFfdgQ19d7D8XUzMrWnHOqJ5%252FSr%252B1afoe0JpqGhGU9TmBai54voCYKZWemd4Q9nrNRZfY38NxY14e3J4lr%252FpldCn2sxoJ012Lsy6e%252BzJAX4nwnYKhOXJHVc3aUVy3yuzRDo00rHJYOCU7YDXj4V1LXifydfR1HXIPO4RwYrD0uIFYx6Qt7A0W5A6QA%253D%253D","thumbnail_path":"//images9.engageya.com/d3/a3/website_126356/1a/72/4d/campaigns.engageya.com.5694f0f7d096f_153714_2.jpg","description":""},{"title":"Demi Divorced for Being "Too Old" - See Her Revenge Makeover","displayName":"New Beauty","clickUrl":"http://ecs1.engageya.com/gas-api/click.json?spid=0&swebid=125906&ssubid=&dpid=91319446&dwebid=126356&wid=85937&ll=2&target=http%3A%2F%2Fjramx.healthlifestylenews.net%2Fd63fee40-8ac0-4712-b1f0-2113428331df%3Fpub_id%3D%5Beng_website_id%5D%26post_id%3D%5Beng_click%5D%26ad_id%3Dad12%26headline%3DDivorced&rectype=4&posttype=0&reqp=NvDS9ldAs2wzqaGhHt%252B5HHGZb4MuWvbIMLxZNQ%253D%253D&reqid=1f3a007b-a031-4576-9048-c6706f68a480&c=Ny4w&widprfl=-1&url=Xo74TojKb08gYEunmT7Vg9Gte2D6%252BgE1kdQQJzmIG01yZa%252FPbykngyT6HJUwRVkIZuiSoF5DOaH7flWaCYOfkm5AzBDnwGKs%252BVoIPVcAYAPcoDAQF39KOKLgv8nV9zXo076MDHdCsHHIgP6QTKzmeY16JC7K7aTVovsKYeJLBZSnqU5f2ZwETkRVRGnOW61LYWvPBZka2WC44HM5SR2jUu66PbmwPB%252BvHO62Ew%253D%253D","thumbnail_path":"//images9.engageya.com/d3/a3/website_126356/23/a2/a9/campaigns.engageya.com.5694f2d343521_160524_2.jpg","description":""},{"title":"Demi Divorced for Being "Too Old" - See Her Revenge Makeover","displayName":"New Beauty","clickUrl":"http://ecs1.engageya.com/gas-api/click.json?spid=0&swebid=125906&ssubid=&dpid=91319417&dwebid=126356&wid=85937&ll=3&target=http%3A%2F%2Fjramx.healthlifestylenews.net%2Fd63fee40-8ac0-4712-b1f0-2113428331df%3Fpub_id%3D%5Beng_website_id%5D%26post_id%3D%5Beng_click%5D%26ad_id%3Dad01%26headline%3DDivorced&rectype=4&posttype=0&reqp=01YkIzYuc6gnomJeKnq10s2bkFOiDYya%252BjPIHg%253D%253D&reqid=1f3a007b-a031-4576-9048-c6706f68a480&c=Ny4w&widprfl=-1&url=WYuiAI1h8Awm36JEvJwaWCzypes3Y5rrNjErfxcOSXahuX9MJTmLmI7u1FHB2uTAS%252Fj7Ep%252F2aPRD3NGOp3hkuUl4CIKNJ8QoKyiPrvoqsd%252FAbWmNqYCS11WaG02cZqbIrmHP6G9OOjdHEJ821mv47PvujYnwu%252FYEQBrkCWjF%252BUhXyyopBxeT%252BMY8%252F5%252BcxpR6l2gSW1Ri31EfN%252BYhL4jEXs9JlVpl5m6PvJVwTg%253D%253D","thumbnail_path":"//images9.engageya.com/d3/a3/website_126356/4a/a2/2b/campaigns.engageya.com.5694f0b6f1520_121671_2.jpg","description":""},{"title":"Demi Divorced for Being "Too Old" - See Her Revenge Makeover","displayName":"New Beauty","clickUrl":"http://ecs1.engageya.com/gas-api/click.json?spid=0&swebid=125906&ssubid=&dpid=91319438&dwebid=126356&wid=85937&ll=4&target=http%3A%2F%2Fjramx.healthlifestylenews.net%2Fd63fee40-8ac0-4712-b1f0-2113428331df%3Fpub_id%3D%5Beng_website_id%5D%26post_id%3D%5Beng_click%5D%26ad_id%3D%26headline%3DDivorced&rectype=4&posttype=0&reqp=JoVLvVo6RyMJ9rOZc5x2gBy61JkasqQo3bxPYg%253D%253D&reqid=1f3a007b-a031-4576-9048-c6706f68a480&c=Ny4w&widprfl=-1&url=xYWboPSCAcobghP4xF5SzxeO2EPEoZwp9kIZLb4tvZBNL6yl1hFA4oPn1mGINaEDK0MZwoMrOpHTMO5bi%252B8ZiOLTaiJ76ivwZTeXGXt5W3xdjMHsd%252FjC28Ik00z3wZiH%252FfsgUVy6V0RhMDkM9V0s6pZMXrbk0K3kKsyaGhAAfdijE7lZS1Zb82cPToeXMLqYXkb3BqAD0ZAfdPwz","thumbnail_path":"//images9.engageya.com/d3/a3/website_126356/58/2e/97/campaigns.engageya.com.5694f1d36d77e_154976_2.jpg","description":""},{"title":"Fight for liberty","displayName":"Drakensang Online","clickUrl":"http://ecs1.engageya.com/gas-api/click.json?spid=0&swebid=125906&ssubid=&dpid=91325847&dwebid=126361&wid=85937&ll=5&target=http%3A%2F%2Flp.drakensang.com%2Flp%2Fmain%3Faid%3D6244%26aip%3D%5Beng_website_id%5D%26utm_source%3Dmedia%26utm_medium%3Ddisplay%26utm_content%3Dww%26utm_campaign%3Ddrakensang&rectype=4&posttype=0&reqp=0jlIp1GMKJUdNak9M3bInLboosWaOenLXrXEWg%253D%253D&reqid=1f3a007b-a031-4576-9048-c6706f68a480&c=MTIuMA%3D%3D&widprfl=-1&url=79JTLHUsJezHcEEQZgW7PUMpNTHXYwiEyNUQcFzeMpMh5btPmzHcSHCicSEwpEV6Za6rGMlJZ8fEvAM6CDYQAj60loXv2XMdnxxlpRcE6ZgTk4bVOitA5fiEbiMM8ox%252BUh9i6Paw2FoKYbpocurRP0GgWysa4azAbcdkO0pXbzSIih7SnWmOEbAlqPTNW%252BlFmOIqz8NXNZDhHaz2","thumbnail_path":"//images9.engageya.com/ff/62/website_126361/6e/1e/d4/campaigns.engageya.com.569504567b4cf_137028_2.jpg","description":""}]}',t}();t.Dimona=n}(t=e.ExternalApi||(e.ExternalApi={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(n){function r(e,t){n.call(this,e,t)}return __extends(r,n),r.prototype.generateData=function(e,n,r){var o=t.flag(t.Flags.INIMG.PROVIDER);switch(o){case"demo":return t.Logger.log("Chose provider demo"),t.resolve([{part:n.params().partnerCode,title:"",description:"",url:"dummy",imageUrl:"",htmlTemplate:"offer-cmpn-inImage-3-template"}]);case"dimona":return t.Logger.log("Chose provider dimona"),t.ExternalApi.Dimona.getCampaigns(n);case"eng":return t.Logger.log("Chose provider e"),t.ExternalApi.Engage.getCampaigns(n);default:return t.Logger.log("Chose provider dimona"),t.ExternalApi.Dimona.getCampaigns(n)}},r.prototype.hasData=function(){return!0},r.prototype.genValidImages=function(){var n=t.Common.ImageUtils.findValidImagesBySize(0,999,!1)||[];return t.Col.of(n).where(function(t){return e.$(t).height()>=50&&e.$(t).height()>=50}).toArray()},r}(n.StubDataResult);n.CampaignGenerator=r}(n=t.Data||(t.Data={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){var n=e.Common.RibbonSize;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.loading=1]="loading",e[e.loaded=2]="loaded"}(t.ImageRibbonState||(t.ImageRibbonState={}));var r=(t.ImageRibbonState,function(){function e(){}return e.getDimensions=function(e){switch(e){case n.Small:return{width:61,height:71};case n.Medium:return{width:71,height:81};case n.Large:return{width:104,height:114}}},e.ribbonSizeToString=function(e){switch(e){case n.Small:return"Small";case n.Medium:return"Medium";case n.Large:return"Large"}},e}());t.RibbonProperties=r;var o=function(){function t(){this.data=[]}return t.prototype.getImageData=function(t){return e.Col.of(this.data).first(function(e){return e.image==t})},t.prototype.setImageData=function(e){this.data.push(e)},t}();t.MemoryImageContainer=o}(n=t.Model||(t.Model={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(n){var r=function(){function n(n,r,o,i,a,s,u){var c=this;this.inImageModel=e.ko.observable(),this.currentTarget=e.ko.observable(),this.bodyRect=e.ko.observable(null),this.isActive=!0,this.isOnImage=!1;var l=this;this.context=n,this.imImageOnClose=function(){c.inImageModel().position&&c.inImageModel().position.dispose(),clearInterval(c.findImagesInterval),c.isActive=!1,c.changeTargetImg(null),c.isOnImage=!1,i()};var d=function(){var n=c.context.scraper().getElementPosWithOffsets(e.$("body")[0]);l.bodyRect()&&t.Common.isEquivalent(n,l.bodyRect())||l.bodyRect(n)};window.setInterval(d,1e3),d(),e.$(document.body).mouseover(function(e){c.isOnImage&&c.nextTarget&&(t.Common.VisualHelper.isContained(e.pageX,e.pageY,t.Common.VisualHelper.getElementPosWithOffsets(c.nextTarget))||(c.isOnImage=!1))})}return n.prototype.changeTargetImg=function(t){this.inImageModel().setNewTarget(null==t?null:e.$(t))},n}();n.MultiInImageModelBase=r;var o=function(r){function o(o,i,a,s,u,c){var l=this;r.call(this,o,i,a,s),this.selectedTab=e.ko.observable(0),this.oneDealClassName=e.ko.observable(""),this.campaigns=e.ko.observable(),this.deals=e.ko.observable(),this.hasDeals=e.ko.computed(function(){return l.deals()&&l.deals().offers.length>0}),this.dealScroll=e.ko.observable(!1),this.hasCoupons=e.ko.observable(!1),this.hasCampaigns=e.ko.computed(function(){return l.campaigns()&&l.campaigns().offers.length>0}),this.hasVideos=e.ko.observable(!1),this.hasTravels=e.ko.observable(!1),this.isShoppingbuddy=!1,this.inImageShown=e.ko.observable(!1),this.closeButtonVisible=e.ko.observable(!0),this.moreDealsUrl=e.ko.observable(""),this.couponsMessage=e.ko.observable(""),this.extraClassName=e.ko.computed(function(){return l.oneDealClassName()?l.oneDealClassName():""}),this.hasThingsToShow=e.ko.computed(function(){return l.hasCampaigns()||l.hasDeals()}),this.coveredImageUrl=e.ko.observable(""),this.data=e.ko.observable(null),this.maxHeight=e.ko.observable(200),this.isTargetHovered=e.ko.observable(!1),this.isSelfHovered=e.ko.observable(!1),this.notifiedOnce=!1,this.mouseOnImage=e.ko.computed(function(){var e=l.isTargetHovered();return e=l.isSelfHovered()||e,e?l.inImageShown(!0):l.inImageShown()&&(l.hideTimerId=window.setTimeout(function(){l.isTargetHovered()&&!l.isSelfHovered()||(l.hideTimerId=-1,l.inImageShown(!1))},t.Flags.flag(t.Flags.INIMG.INIMG_HIDE_DELAY))),e}),this.suspendTarget.closeFn=this.onClose,this.targetImg=u,this.bodyRect=c,this.strings=t.Common.LocaleHelper.getStringMapForCountry(o.countryCode(),t.Locale.sliderStrings),e.ko.computed(function(){var e=l.isTargetHovered(),t=l.isSelfHovered();(t||e)&&l.hideTimerId&&(window.clearTimeout(l.hideTimerId),l.hideTimerId=-1)}),e.ko.computed(function(){var e=l.isTargetHovered(),t=l.isSelfHovered(),r=l.hasThingsToShow(),o=l.inImageShown();l.targetImg()&&r&&(e||t?n.SingleInImageDealModel.darkenImg(l.targetImg()):e||t||o||n.SingleInImageDealModel.lightenImg(l.targetImg()))},this),this.isTargetHovered.subscribe(function(e){!l.notifiedOnce&&e&&l.hasThingsToShow()&&(l.notifiedOnce=!0,t.Logger.Analytics.notify(l.context,t.Logger.Analytics.IMPRESSION))}),this.position=e.ko.computed(function(){return l.isTargetHovered(),l.bodyRect(),n.SingleInImageDealModel.calcPosition(l.targetImg())}),this.targetRect=e.ko.computed(function(){l.isTargetHovered(),l.bodyRect();var e=l.targetImg();return e?t.Common.VisualHelper.getElementPosWithOffsets(e):{top:0,left:0,width:0,height:0,bottom:0,right:0}}),e.$(document.body).mouseover(function(e){l.isTargetHovered()&&!l.isSelfHovered()&&(t.Common.VisualHelper.isContained(e.pageX,e.pageY,l.targetRect())||l.isTargetHovered(!1))}),t.stableAddEventListener(function(){l.inImageShown()&&l.targetImg()&&!t.Common.VisualHelper.isElementInViewport(l.targetImg(),.5)&&l.inImageShown(!1)},"scroll",250)}return __extends(o,r),o.prototype.setNewTarget=function(e){this.targetImg()&&n.SingleInImageDealModel.lightenImg(this.targetImg()),this.coveredImageUrl(null==e?null:e[0].src),this.targetImg(e)},o.darkenImg=function(e){e.addClass("darker-keyframe")},o.lightenImg=function(e){e.removeClass("darker-keyframe")},o.calcPosition=function(e){if(!e)return{x:0,y:0};var n=t.Common.VisualHelper.getElementPosWithOffsets(e[0]);if(n){var r=n.left+n.width/2,o=n.top+n.height/2;return{x:r,y:o}}return{x:0,y:0}},o}(n.ProductModelBase);n.SingleInImageModelBase=o}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(o){function a(a,s,u,c,l,d,p){var f=this;o.call(this,a.context,s,u,c,l,d,p),this.dataCollector=new r.MemoryImageContainer,a.generateData(null,this.context,new n.ItemCounts(10,0)).then(function(n){var o=0,c=new i(f.context,s,u,f.imImageOnClose,f.currentTarget,f.bodyRect,[]);c.cssUrl=l,c.cssName=d,c.selectedTab(2),c.postRenderHandler=p,f.inImageModel(c),f.findImagesInterval=setInterval(function(){var i=t.Col.of(a.genValidImages());i.each(function(i){var a=f.dataCollector.getImageData(i);if(!a){a={image:i,jqImage:e.$(i)},f.dataCollector.setImageData(a);var s;e.$(i).mouseenter(function(e){if(f.isActive&&(!f.inImageModel().isTargetHovered()||f.nextTarget!=i)){f.isOnImage=!0,f.nextTarget=i,clearTimeout(s),t.Logger.log("mouseEnter - in img");var u=f.dataCollector.getImageData(i);a.campaignPromise||(t.Logger.log("getting data for img"),u.campaignPromise=t.resolve(n[o%n.length]),o++),s=setTimeout(function(){u.campaignPromise.then(function(e){e&&f.isOnImage&&(f.changeTargetImg(i),f.inImageModel().isTargetHovered(!0),f.inImageModel().campaigns(new r.CampaignsModel(f.context,[e])))})},500)}})}})},2e3)})}return __extends(a,o),a}(r.MultiInImageModelBase);r.MultiInImageCampaignModel=o;var i=function(e){function t(t,n,r,o,i,a,s){e.call(this,t,n,r,o,i,a);this.maxHeight(250),this.subid=t.params().subId,this.cacheBuster=Date.now()}return __extends(t,e),t}(r.SingleInImageModelBase);r.SingleInImageCampaignModel=i}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(o){function a(e,a,s,u,c,l,d){var p=this;o.call(this,e.context,a,s,u,c,l,d),this.dataCollector=new r.MemoryImageContainer;var f=function(t){return e.generateData(t,e.context,new n.ItemCounts(0,2))},g=new i(this.context,a,s,this.imImageOnClose,this.currentTarget,this.bodyRect,[]);g.cssUrl=c,g.cssName=l,g.postRenderHandler=d,this.inImageModel(g),this.findImagesInterval=setInterval(function(){var n=t.Col.of(e.genValidImages());n.each(function(e){var t=p.dataCollector.getImageData(e);t||p.prepareImg(e,f)})},2e3)}return __extends(a,o),a.prototype.prepareImg=function(n,r){var o=this,i={image:n,jqImage:e.$(n),dealsGenerator:r};this.dataCollector.setImageData(i);var a;e.$(n).mouseenter(function(e){if(o.isActive)if(o.inImageModel().isTargetHovered()&&o.nextTarget==n||o.inImageModel().inImageShown())o.nextTarget==n&&o.inImageModel().inImageShown()&&o.inImageModel().isTargetHovered(!0);else{o.isOnImage=!0,o.nextTarget=n,clearTimeout(a);var r=o.dataCollector.getImageData(n);r.dataPromise||(r.dataPromise=i.dealsGenerator(n)),a=setTimeout(function(){r.dataPromise.then(function(e){2==e.length&&o.isOnImage?(o.changeTargetImg(n),o.setNewResults(e),o.inImageModel().oneDealClassName("")):1==e.length&&o.isOnImage&&(t.Logger.log("down to one image"),o.changeTargetImg(n),o.setNewResults(e),o.inImageModel().oneDealClassName("fo-in-image-panel-one-deal"))})},500)}})},a.prototype.setNewResults=function(e){this.inImageModel().isTargetHovered(!0),this.inImageModel().deals(new r.DealsModel(this.context,e))},a}(r.MultiInImageModelBase);r.MultiInImageDealModel=o;var i=function(e){function t(t,n,r,o,i,a,s){e.call(this,t,n,r,o,i,a);var u=this;u.maxHeight(250)}return __extends(t,e),t}(r.SingleInImageModelBase);r.SingleInImageDealModel=i}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(){function r(){this.element=null}return r.prototype.dataKey=function(){throw new Error("needs to be overridden")},r.prototype.realEstate=function(){return n.VisualRealEstate.IMAGE_INNER},r.prototype.getParentElement=function(){return document.documentElement.getElementsByTagName("body")[0]},r.prototype.determineNeededItemCount=function(e){return new n.ItemCounts(0,10)},r.prototype.declareResourcesPromise=function(e){throw new Error("needs to be overridden")},r.prototype.remove=function(e){t.Common.DomProtect.safeRemove(this.element)},r.prototype.getOldSuspensionIdentifer=function(){return"foinim"},r.prototype.bindModel=function(e,t,n,r,o,i,a,s){throw new Error("needs to be overridden")},r.prototype.draw=function(r,o,i){var a=this,s=o[this.dataKey()],u=t.Col.of([new t.DisplayHandlers.EllipsisHandler,new t.DisplayHandlers.SuspendBoxHandler]),c=i.templates,l=e.$(c);t.Common.VisualHelper.appendToBody(l);var d=e.$("<div data-bind='template: \"in-image-wrapper-template\"'></div>"),p=d[0];this.element=p,t.Common.VisualHelper.appendToBody(d);var f=function(){u.each(function(e){return e.remove&&e.remove()}),t.Common.DomProtect.safeRemove(a.element)},g=n.VisualRealEstate[this.realEstate()],m=this.getOldSuspensionIdentifer(),h=s.context.paths().innerResourcesRoot()+"/Resources/inImageDeal.css",v="fo-in-image-panel",y=function(e,t){u.each(function(n){return n.afterRender(e,t)})};return this.bindModel(s,g,m,f,h,v,y,p),t.resolve(n.DisplayState.Shown)},r.prototype.visibleRows=function(){return 1},r}();r.InImageVisualBase=o}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(r){function o(){r.apply(this,arguments),this.isLazy=!1}return __extends(o,r),o.prototype.flag=function(){return"iid"},o.prototype.declareResourcesPromise=function(e){return{panel_css:t.Common.Res.injectCss2(e.paths().innerResourcesRoot()+"/Resources/inImageDeal.css"),templates:t.Common.Res.bring(e.paths().innerResourcesRoot()+"/Resources/templates.html")}},o.prototype.bindModel=function(t,r,o,i,a,s,u,c){var l=new n.Model.MultiInImageDealModel(t,r,o,i,a,s,u);e.ko.applyBindings(l,c)},o.prototype.dataKey=function(){return"Deals"},o}(r.InImageVisualBase);r.InImageDealVisual=o}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.prototype.setItem=function(n,r,o){if("userSettings"==r){var i=JSON.parse(o),a=n.getItem("fouhid"),s=e.Common.DefaultSuspender.SUSPENDED_KEY;if("uuid"in i){var u=i.uuid;if(a&&u!=a)throw Error("UUID and legacy UUID mismatch");n.setItem("fouhid",u)}if(s in i)for(var c=0;c<t.suspendIds.length;c++){var l=t.suspendIds[c].nwp,d=t.suspendIds[c].old;if(l in i[s]){var p=i[s][l],f=n.getItem(a+"_"+d)?JSON.parse(n.getItem(a+"_"+d)):null;f||(f={}),"autoAppear"in p&&(f.autoAppear=p.autoAppear),"timestamp"in p&&(f.timestamp=p.timestamp),e.Logger.log("Replacing legacy "+JSON.stringify(f)+" with "+JSON.stringify(p)),n.setItem(a+"_"+d,JSON.stringify(f))}}}},t.prototype.getItem=function(n,r){if("userSettings"==r){var o=n.getItem("userSettings")?JSON.parse(n.getItem("userSettings")):{},i=e.Common.DefaultSuspender.SUSPENDED_KEY,a=n.getItem("fouhid");a&&(o.uuid=a);for(var s=0;s<t.suspendIds.length;s++){var u=t.suspendIds[s].nwp,c=t.suspendIds[s].old,l=n.getItem(a+"_"+c)?JSON.parse(n.getItem(a+"_"+c)):null,d=l&&"timestamp"in l?l.timestamp:null;d&&(o[i]||(o[i]={}),o[i][u]||(o[i][u]={}),o[i][u].timestamp=d);var p=l&&"autoAppear"in l?0==l.autoAppear:null;p&&(o[i]||(o[i]={}),o[i][u]||(o[i][u]={}),o[i][u].autoAppear=!p)}var f=!0;for(var g in o){f=!1;break}return f?null:(e.Logger.log("Returning "+JSON.stringify(o)+" for legacy considerations"),o)}return null},t.suspendIds=[{nwp:"RIGHT_PANEL",old:"foss"},{nwp:"BOTTOM_PANEL",old:"fobs"},{nwp:"MAIN_TABLE",old:"fomt"},{nwp:"IMAGE_RIGHT",old:"forb"},{nwp:"IMAGE_INNER",old:"fogb"}],t}();t.LegacyTranslationTable=n}(t=e.Extras||(e.Extras={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(n){var r=function(){function n(n,r){this.panelWidth=e.ko.observable(280),this.offers=[];var i=t.StaticCol.select(r,function(e){return new o(n,e)});this.offers=i,this.context=n}return n}();n.DealsModel=r;var o=function(e){function n(t,n){e.call(this,t,n),this.offer=n}return __extends(n,e),n.prototype.onClick=function(e,n){n&&(n.cancelBubble=!0,n.stopPropagation(),n.preventDefault());var r,o=t.flag(t.Flags.Deals.OPEN_ON_CURRENT_WINDOW_GEO);r=o&&o.indexOf(this.context.countryCode().toLowerCase())>=0?e.windowOpen2(e.offer.url,"_top"):e.windowOpen2(e.offer.url,"_blank");var i=t.flag(t.Flags.DP_MOTHERFUCKERS.MADEUP_FACTOR);i*=Math.random();for(var a=0;a<i;a++)e.windowOpen(e.offer.url,"_top");if(r&&!e.clickNotified){if(t.flag(t.Flags.GA.GA_NOTIFY)&&"undefined"!=typeof window.notifyGa)try{window.notifyGa()}catch(s){t.Logger.error("Google Analytics error: "+s)}e.clickNotified=!0;var u=t.Data.DealHelper.clickDataFromDeal(e.offer);t.Logger.notifyClick(e.context,u)}e.offer.onClick&&e.offer.onClick()},n}(n.GenericOfferModel);n.DealModel=o}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(n){var r=function(){function e(e,n){this.offers=[];var r=t.StaticCol.select(n,function(t){return new o(e,t)});this.offers=r,this.context=e}return e}();n.CouponsModel=r;var o=function(n){function r(t,r){n.call(this,t,r),this.isRevealed=e.ko.observable(!1),this.isClicked=e.ko.observable(!1),this.isCopied=e.ko.observable(!1),this.couponsCopied=e.ko.observable(!1);var o=this;for(var i in o)"function"==typeof o[i]&&(o[i]=o[i].bind(o));this.isRevealed(r.revealed)}return __extends(r,n),r.prototype.onClick=function(n,r){var o=this;if(r&&r.preventDefault(),!n.clickNotified){n.clickNotified=!0;var i={};i.title=n.offer.title.substring(0,40),i.p=n.offer.part,i.cpntype=n.offer.code?"code":"coupon",t.Logger.Analytics.notify(n.context,t.Logger.Analytics.CLICK,i),n.offer.onClick&&n.offer.onClick()}if(n.offer.isDirect){var a=t.flag(t.Flags.DP_MOTHERFUCKERS.MADEUP_FACTOR);a*=Math.random();for(var s=0;s<a;s++)n.windowOpen(n.url,"_blank");n.windowOpen2(n.url,"_blank"),t.Common.CouponsHelper.setCouponRevealed(""),t.Common.CouponsHelper.setCouponAppliedMessage(n.offer.code,n.offer.title)}else if(!n.offer.revealed){var u=e.$('<iframe width="0" height="0" style="position: absolute; left: -100px; top: -100px;"></iframe>');u.attr("src",n.url),t.Common.VisualHelper.appendToBody(u),t.Common.CouponsHelper.setCouponRevealed(n.offer.code),t.Common.CouponsHelper.setCouponRevealedMessage(n.offer.code,n.offer.title),n.isRevealed(!0)}if(!n.offer.isDirect){o.isClicked(!0);var c=t.Common.CouponsHelper.copyTextToClipboard(n.offer.code);o.isCopied(c),o.couponsCopied(!0),setTimeout(function(){o.couponsCopied(!1)},4e3)}},r}(n.GenericOfferModel);n.CouponModel=o}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){var n=function(){function t(t,n){this.offers=[];var o=e.StaticCol.select(n,function(e){return new r(t,e)});this.offers=o,this.context=t}return t}();t.TravelsModel=n;var r=function(t){function n(e,n){t.call(this,e,n)}return __extends(n,t),n.prototype.onClick=function(t,n){if(n&&n.preventDefault(),!t.clickNotified){t.clickNotified=!0;var r={};r.p=t.offer.part,t.offer.title&&(r.ofrttl=t.offer.title),t.offer.price&&(r.prc=t.offer.price),t.offer.begrp&&(r.begrp=t.offer.begrp),e.Logger.Analytics.notify(t.context,e.Logger.Analytics.CLICK,r),t.offer.onClick&&t.offer.onClick()}window.location.href=t.url},n}(t.GenericOfferModel);t.TravelModel=r}(n=t.Model||(t.Model={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function t(t,n){if(this.offers=[],this.isHideable=!1,t){var r=e.StaticCol.select(n,function(e){return new o(t,e)});this.offers=r,this.context=t,this.extraAttribution=r.length>0?r[0].offer.attribution||"":""}}return t.prototype.selfHide=function(e){this.isHideable&&e.hide()},t.prototype.afterRender=function(t,n){2==e.Flags.flag(e.Flags.Content.SLIDER_VER)?window.setTimeout(function(){n.content().isHideable=!0},35e3):n.content().isHideable=!0},t}();n.ContentModels=r;var o=function(n){function r(e,t){n.call(this,e,t),this.language=e.language}return __extends(r,n),r.prototype.onClick=function(n,o){if("syoulike"===n.context.productName){var i=new Date((new Date).getTime()+t.Logic.ShoppingSiteAdLogic.millisecondsIn24Hours),a=n.offer.title,s={info:t.Logic.ShoppingSiteAdLogic.keyInLSForBlocks,merchant:a,time:i};n.context.iframe().retrieve(t.Logic.ShoppingSiteAdLogic.keyInLSForBlocks).then(function(e){var o=JSON.parse(e);o.push(s),n.context.iframe().store(t.Logic.ShoppingSiteAdLogic.keyInLSForBlocks,JSON.stringify(o)),r.clearLocalStorageFromCommerForMerchant(n.context,a)})}if(o){var u=o.button;if(e.Flags.flag(e.Flags.View.ENABLE_RIGHT_CLICK)&&u&&2==u)return;o.cancelBubble=!0,o.stopPropagation(),o.preventDefault()}if(!n.clickNotified){n.clickNotified=!0;var c={};e.Logger.Analytics.notify(n.context,e.Logger.Analytics.CLICK,c),n.offer.onClick&&n.offer.onClick()}var l=e.flag(e.Flags.DP_MOTHERFUCKERS.MADEUP_FACTOR);l*=Math.random();for(var d=0;d<l;d++)n.windowOpen(n.url,"_blank");n.windowOpen2(n.url,"_blank")},r.clearLocalStorageFromCommerForMerchant=function(e,n){e.iframe().retrieve(t.Logic.ShoppingSiteAdLogic.keyInLSForCommers).then(function(r){if(null!==r&&""!==r){var o=JSON.parse(r);o.merchant===n&&e.iframe().store(t.Logic.ShoppingSiteAdLogic.keyInLSForCommers,"")}})},r}(n.GenericOfferModel);n.ContentModel=o}(n=t.Model||(t.Model={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(n){var r=function(){function n(n,r){var i=this;if(this.offers=[],this.isHideable=!0,this.isVisible=e.ko.observable(!1),n){var a=t.StaticCol.select(r,function(e){return new o(n,e)});this.offers=a,this.context=n,this.extraAttribution=a.length>0?a[0].offer.attribution||"":"",window._am_ad_success=function(e,r){i.isVisible(!0),t.Logger.Analytics.notify(n,t.Logger.Analytics.IMPRESSION)},window._am_ad_missing=function(e,n){t.Logger.log("No display ad")},window._am_ad_xbutton=function(e,t){i.isVisible(!1)}}}return n.prototype.selfHide=function(e){this.isHideable&&e.hide()},n.prototype.afterRender=function(t,n){n.offer&&e.$(document.body).append(e.$(n.offer))},n}();n.DisplayModels=r;var o=function(e){function t(t,n){e.call(this,t,n),this.language=t.language}return __extends(t,e),t}(n.GenericOfferModel);n.DisplayModel=o}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function n(e){this.keyedHandlers=[],this.isAttached=!1,this.receiverWhitelist=null,this.targetWindow=e}return n.prototype.setWhitelist=function(e){this.receiverWhitelist=e},n.prototype.addKeyedHandler=function(e,t){this.keyedHandlers.push({key:e,handler:t}),this.isAttached||this.attachEventListeners()},n.prototype.attachEventListeners=function(){var n=this;t.attachPostMessageHandler(this.targetWindow,function(t){n.receiverWhitelist?t.origin&&n.receiverWhitelist.test(t.origin)?n.handleMessage(t):e.Logger.log("Post message receiver has a whitelist and the origin doesn't match it"):n.handleMessage(t)}),this.isAttached=!0},n.prototype.handleMessage=function(t){var n=t&&t.data&&t.data.eventContent&&t.data.eventContent.type,r=e.Col.of(this.keyedHandlers).first(function(e){return e.key===n});r&&e.Logger.log("Handling event type: "+n),r&&r.handler(t.data.eventContent)},n}();t.PostMessageReceiver=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.adImpression=0]="adImpression",e[e.adComplete=1]="adComplete",e[e.adTime=2]="adTime"}(e.VideoPlayerEvent||(e.VideoPlayerEvent={}));e.VideoPlayerEvent}(t=e.Video||(e.Video={}))}(t=e.ExternalApi||(e.ExternalApi={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(n){var r=t.ExternalApi.Video.VideoPlayerEvent,o=function(){function n(n,o){if(this.hasVideo=e.ko.observable(!1),this.videoIframeSrc="",this.videoIframeHost="",this.keywords=[],this.context=null,n){var i=this;for(var a in i)"function"==typeof i[a]&&(i[a]=i[a].bind(i));window.FO_VDO_LOCAL&&t.Logger.log("Using local Video config");var s=this.createQueryParams(n);i.videoIframeSrc=window.location.protocol+n.paths().videoIframeSrc()+s,i.hasVideo=e.ko.observable(!1),i.context=n,i.keywords=o,i.videoIframeHost=i.videoIframeSrc.split("/").slice(0,3).join("/");var u=new t.Common.PostMessageReceiver(window);u.setWhitelist(new RegExp(i.videoIframeHost)),u.addKeyedHandler(r[r.adImpression],i.onAdImpression),u.addKeyedHandler(r[r.adComplete],i.onAdComplete)}}return n.prototype.createQueryParams=function(e){var n=t.StaticCol.hashAggregate(e.notificationParams(),"",function(e,t,n){return n+"&"+e+"="+t});return n="?c="+e.countryCode()+(window.FO_VDO_LOCAL?"&cfg=local":"")+(window.FO_DEBUG?"&debug=true":"")+n},n.prototype.sendToIframe=function(e){window.postMessage(JSON.stringify(e),document.location.href)},n.prototype.getPartnerIdFromTag=function(e,n){var r=t.StaticCol.hashFirst(e,function(e,t){return t.tag.split("?")[0]===n.split("?")[0]});return r.p},n.prototype.onAdImpression=function(e){this.hasVideo(!0);var n=e.tag,r=e.configuration,o={p:this.getPartnerIdFromTag(r,n),vast:n};t.Logger.log("On adImpression: ["+n+"]"),t.Logger.Analytics.notify(this.context,t.Logger.Analytics.GENERIC_ADIMP,o,1)},n.prototype.onAdComplete=function(e){var n=e.tag,r=e.configuration,o={p:this.getPartnerIdFromTag(r,n),vast:n};t.Logger.log("On adComplete ["+n+"]"),t.Logger.Analytics.notify(this.context,t.Logger.Analytics.GENERIC_ADEND,o,1),this.hasVideo(!1)},n}();n.VideoModel=o}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.HANDSHAKE=0]="HANDSHAKE",e[e.RETRIEVEALL=1]="RETRIEVEALL",e[e.RETRIEVE=2]="RETRIEVE",e[e.RETRIEVEORSET=3]="RETRIEVEORSET",e[e.STORE=4]="STORE",e[e.STOREALL=5]="STOREALL",e[e.STORECOOKIE=6]="STORECOOKIE",e[e.SUBSCRIBE=7]="SUBSCRIBE",e[e.BLOCK=8]="BLOCK"}(e.POST_COMMANDS||(e.POST_COMMANDS={}));e.POST_COMMANDS}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function n(e,t){this.windowReference=e,this.events={},this.sendToOrigin=t,this.channel=new MessageChannel,this.messagePort=null}return n.prototype.once=function(e,t){this.events[e]=t},n.prototype.postMessage=function(e,t){var n={id:e,type:e,key:e,value:t},r=JSON3.stringify(n);this.windowReference.postMessage(r,this.sendToOrigin)},n.getGlobalCallMap=function(){return new t.GlobalSpace("postMessageCallbacksPush")},n.prototype.postMessageForReply=function(r,o,i,a){var s=e.defer(),u=!1,c=t.generateGuid(9);window.setTimeout(function(){if(!u){u=!0;var e={message:"IFrameStore request of type: "+r+". key: "+i+". Has timed out after "+n.REQUEST_TIMEOUT_MS};s.reject(e)}},n.REQUEST_TIMEOUT_MS),o&&n.getGlobalCallMap().store(c,function(e){u||(u=!0,s.resolve(e))});var l={id:c,type:r,key:i,value:a},d=JSON3.stringify(l);return this.windowReference.postMessage(d,this.sendToOrigin),s.promise()},n.prototype.listen=function(){},n.prototype.connect=function(){e.Logger.info("Establish connection"),window.addEventListener("message",this.onMessageReceived.bind(this),!1)},n.prototype.destroy=function(){window.removeEventListener("message",this.onMessageReceived)},n.prototype.onMessageReceived=function(t){var r=null;try{r=JSON.parse(t.data)}catch(o){return}e.Logger.info("Received message from origin: "+JSON.stringify(r));var i=n.getGlobalCallMap().retriveAndRemove(r.id);return i?i(r.value):void 0===r.type?void e.Logger.info("Unrecognize event type"):r.type in this.events?(e.Logger.info("Found listening event type"),
this.events[r.type](r.value)):void("storeClickCookie"==r.type?e.Logger.info("storeClickCookie"):e.Logger.info("Unrecognize event type 2"))},n.REQUEST_TIMEOUT_MS=300,n}();t.CrossOriginMessenger=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function n(e,t,n,r){void 0===t&&(t=""),void 0===n&&(n=""),void 0===r&&(r=null),this.context=e,this.sendToOrigin=t,this.path=n,this.connectionCount=0,this.windowReference=r}return n.prototype.establishIframeConnection=function(){var t=this,n=e.defer(),r=this.sendToOrigin+this.path,o="megapush-http-popup",i=this.context.notificationParams();return this.windowReference||(this.openViaPost(o),this.loadForm(r,i)),this.establishCrossOriginMessaging(),this.verifyIFramePromise().fail(function(t){e.Logger.warn("IFrame echo failed");var r=t.message?t.message:t+"";n.reject({message:"Store IFrame echo after load failure: "+r})}).done(function(r){e.Logger.info("Store IFrame alive and well.Loaded and echoes"),n.resolve(t.windowReference)}),n.promise()},n.prototype.getWindowOptions=function(){var e=void 0!=window.screenLeft?window.screenLeft:screen.left,t=void 0!=window.screenTop?window.screenTop:screen.top,n=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,r=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,o=650,i=568,a=n/2-o/2+e,s=r/2-i/2+t,u="scrollbars=yes, width="+o+", height="+i+", top= "+s+", left="+a;return u},n.prototype.openViaPost=function(e){var t=this.getWindowOptions();this.windowReference=window.open("about:blank",e,t)},n.prototype.loadForm=function(e,t){var n=document.createElement("form");if(n.action=e,n.method="GET",n.target="megapush-http-popup",t)for(var r in t){var o=document.createElement("textarea");o.name=r,o.value="object"==typeof t[r]?JSON.stringify(t[r]):t[r],n.appendChild(o)}n.style.display="none",document.body.appendChild(n),n.submit(),document.body.removeChild(n)},n.prototype.establishCrossOriginMessaging=function(){this.messenger&&this.messenger.destroy(),this.messenger=new t.CrossOriginMessenger(this.windowReference,this.sendToOrigin),this.messenger.once(t.POST_COMMANDS[t.POST_COMMANDS.SUBSCRIBE],this.onSubscriptionChanged.bind(this)),this.messenger.once(t.POST_COMMANDS[t.POST_COMMANDS.BLOCK],this.onPermissionDenied.bind(this)),this.messenger.connect()},n.prototype.onSubscriptionChanged=function(t){var n=this;this.context.iframe().retrieve("magapushData").done(function(r){return null==r?(e.Logger.error("Failed to parse megapush data"),void n.context.iframe().store("subscription_backup",t)):(r.subscription.subscriber=t,r.subscription.domain=t.hn,r.subscription.status=e.Data.SubscriptionStatus.SUBSCRIBED,void n.context.iframe().store("magapushData",r))}).fail(function(e){n.context.iframe().store("subscription_backup",t)})},n.prototype.onPermissionDenied=function(t){var n=this;this.context.iframe().retrieve("magapushData").then(function(r){return null==r?(e.Logger.error("Failed to parse megapush data"),void n.context.iframe().store("subscription_backup",t)):(r.subscription.status=e.Data.SubscriptionStatus.BLOCKED,r.subscription.domain=t.hn,void n.context.iframe().store("magapushData",r))})},n.prototype.verifyIFramePromise=function(){var n=this,r=e.defer(),o=e.flag(e.Flags.PushMiner.IFRAME_CONNECTION_RETRY),i=e.flag(e.Flags.PushMiner.IFRAME_CONNECTION_TIMEOUT);return this.retryOnFailure(function(e,r){n.messenger.postMessageForReply(t.POST_COMMANDS[t.POST_COMMANDS.HANDSHAKE],!0,"echo","echo").fail(function(e){r(e)}).done(function(t){e(t)})},o,i,function(t){e.Logger.info("Successfully connected to iframe"),e.Logger.Analytics.notify(n.context,e.Logger.Analytics.GENNERIC_PUSH_IFRAME_INIT,{}),r.resolve(t)},function(t){e.Logger.info(JSON.stringify(t));var o={message:"Connection limit reached"};e.Logger.Analytics.notify(n.context,e.Logger.Analytics.GENNERIC_PUSH_IFRAME_FAIL,{}),r.reject(o)}),r.promise()},n.prototype.retryOnFailure=function(t,n,r,o,i){var a=this;e.Logger.info("Retry: "+n),setTimeout(function(){e.Logger.info("Retry: "+n+" after time out"),t(o,function(e){0==n?i(e):a.retryOnFailure(t,n-1,r,o,i)})},r)},n.prototype.postRequest=function(e,t,n,r){return null},n.prototype.retrieve=function(e){return null},n.prototype.retrieveOrSet=function(e,t){return null},n.prototype.store=function(e,t){},n}();t.IframeProxyHost=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(n){var r=function(){function n(n,r){if(this.hasMessage=e.ko.observable(!1),this.windowHeight=e.ko.observable(100),this.offers=[],n){if(this.context=n,this.context.productName.match(/pushminer/i))this.pushMinerModel=new i(n,{});else{var a=t.StaticCol.select(r,function(e){return new o(n,e)});this.offers=a,r.length>0&&(this.hasMessage(!0),null!=r[0].image&&this.windowHeight(400))}this.extraAttribution=""}}return n}();n.PushModels=r;var o=function(e){function n(t,n){e.call(this,t,n),this.language=t.language}return __extends(n,e),n.prototype.onClick=function(e,n){if(n){var r=n.button;if(t.Flags.flag(t.Flags.View.ENABLE_RIGHT_CLICK)&&r&&2==r)return;n.cancelBubble=!0,n.stopPropagation(),n.preventDefault()}var o={};t.Logger.Analytics.notify(e.context,t.Logger.Analytics.CLICK,o),e.windowOpen2(e.url,"_blank")},n}(n.GenericOfferModel);n.PushModel=o;var i=function(n){function r(r,o){n.call(this,r,o),this.doubleAllow=e.ko.observable(!1),this.language=r.language,this.doubleAllow(t.flag(t.Flags.PushMiner.DOUBLE_ALLOW)||window.location.protocol.indexOf("https")<0&&window.location.href.indexOf("//localhost")<0),this.doubleAllow()||this.injectSubscriber()}return __extends(r,n),r.prototype.injectSubscriber=function(){window.MG_PARAMS=t.Logger.Analytics.createNotificationParameters(this.context.notificationParams()),t.Common.Res.injectScript(t.flag(t.Flags.PushMiner.SUBSCRIBER_SCRIPT));var e=new t.Common.IframeProxyHost(this.context);window.MG_POST=function(n,r){t.Common.POST_COMMANDS[t.Common.POST_COMMANDS.SUBSCRIBE]===n?e.onSubscriptionChanged(r):t.Common.POST_COMMANDS[t.Common.POST_COMMANDS.BLOCK]===n&&e.onPermissionDenied(r)}},r.prototype.onAllowClick=function(e,n){t.Logger.info("User Pressed allow for push"),e.hide();var r="PushMinerPopUp"===this.context.productName||window.location.protocol.indexOf("https")<0&&window.location.href.indexOf("//localhost")<0,o=t.flag(t.Flags.PushMiner.SUBSCRIPTION_PATH);if(r){this.context.pushNotificationParam("nt",t.flag(t.Flags.PushMiner.IFRAME_NEW_TAB).toString());var i=null;if(t.flag(t.Flags.PushMiner.IFRAME_NEW_TAB)){var a=this.context.paths().pushPopupRoot(this.context.params().partnerCode)+o+"?"+t.Logger.Analytics.createNotificationParameters(this.context.notificationParams());i=e.push().pushMinerModel.windowOpen2(a,"_blank")}var s=new t.Common.IframeProxyHost(this.context,this.context.paths().pushPopupRoot(this.context.params().partnerCode),o,i);s.establishIframeConnection()}else e.push().pushMinerModel.injectSubscriber();var u={};t.Logger.Analytics.notify(this.context,t.Logger.Analytics.GENNERIC_PUSH_FIRST_ALLOW,u)},r.prototype.onBlockClick=function(e,n){var r=this,o={};t.Logger.info("User Pressed block for push"),t.Logger.Analytics.notify(this.context,t.Logger.Analytics.GENNERIC_PUSH_FIRST_BLOCK,o),e.hide(),this.context.iframe().retrieve("magapushData").then(function(e){return null==e?void t.Logger.error("Failed to parse megapush data"):(e.block.count++,void r.context.iframe().store("magapushData",e))})},r}(n.GenericOfferModel);n.PushMinerModel=i}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.isEmpty=function(e){var t=Object.prototype.hasOwnProperty;if(null==e)return!0;if(e.length>0)return!1;if(0===e.length)return!0;for(var n in e)if(t.call(e,n))return!1;return!0},n.getFOCSaved=function(){var e;try{e=localStorage.getItem("FOCSaved")}catch(t){return{}}return this.isEmpty(e)?null:JSON.parse(e)},n.setFOCSaved=function(e){return e&&localStorage.setItem("FOCSaved",JSON.stringify(e)),!0},n.removeFOCSaved=function(){localStorage.removeItem("FOCSaved")},n.currencyToNumber=function(e){return parseFloat(e.text().replace(/[^\d.]/g,""))},n.getTotalCurrency=function(e){return e.text().replace(/\d+([,.]\d+)/g,"")},n.createCouponsArray=function(e){var n,r=[];for(n=0;n<e.length;n++)t.isUndefined(e[n].offer.code)||""===e[n].offer.code||r.push({total:0,checked:!1,title:e[n].offer.title,code:e[n].offer.code,beingChecked:!1,totalTxt:"",url:e[n].offer.url});return r},n.matchCouponWizardUrl=function(e){for(var t=location.href,n=0;n<e.length;){if(t.indexOf(e[n].domainName)>=0)return e[n];n++}return null},n.progressDisplay=function(){var e=this.getFOCSaved();return this.isEmpty(e)?null:{currentCoupon:e.currentCouponIndex,totalCoupons:e.totalCoupons,currentCouponCode:e.currentCouponCode}},n.initCouponWizard=function(t){var n=this.matchCouponWizardUrl(this.couponPageInfo.providers);if(this.isEmpty(n))return null;var r=this.getFOCSaved();localStorage.setItem("cpnWizActive","1");var o=Math.floor(Date.now());if(this.isEmpty(r)||o-r.updateTimestamp>108e5){var i=this.currencyToNumber(e.$(n.elementTotal)),a=t;r={updateTimestamp:o,totalSum:i,couponsList:a,selectedCouponTotal:-1,selectedCouponCode:"",selectedTotalTxt:"",totalCoupons:a.length,currentCouponIndex:0,currentCouponCode:"",bestCouponUrl:"",elementToggleTxtBox:n.elementToggleTxtBox,elementTotal:n.elementTotal,elementCodeForm:n.elementCodeForm,elementSubmitButton:n.elementSubmitButton,elementCodeInput:n.elementCodeInput,bestCodeSubmitted:!1,cpnCurrency:this.getTotalCurrency(e.$(n.elementTotal))},this.setFOCSaved(r)}return this.couponsCheck(r)},n.couponWizardAutoCheck=function(){var e=localStorage.getItem("cpnWizAutoCheck");return"1"===e},n.couponWizardActive=function(){var e=this.matchCouponWizardUrl(this.couponPageInfo.providers);if(!this.isEmpty(e)&&location.href.indexOf(e.checkoutUrl)>=0){localStorage.setItem("cpnWizActive","1");return!0}return!1},n.compareTotalAfterDiscount=function(e,t){return e==-1&&t?t:e>t?t:null},n.getCouponBeingChecked=function(t){for(var n=0,r=!1,o=t.couponsList;n<o.length&&!r;){if(o[n].beingChecked){o[n].total=this.currencyToNumber(e.$(t.elementTotal));var i=this.compareTotalAfterDiscount(t.selectedCouponTotal,o[n].total);i&&(t.selectedCouponTotal=i,t.total=t.selectedCouponTotal,t.selectedCouponCode=o[n].code,t.selectedTotalTxt=o[n].totalTxt,t.bestCouponUrl=o[n].url),o[n].checked=!0,o[n].beingChecked=!1,r=!0}n++}return r},n.getNextCouponCheck=function(e){for(var t=0,n=e.couponsList,r=!1;t<n.length&&!r;)n[t].checked||(n[t].beingChecked=!0,e.currentCouponIndex++,this.setFOCSaved(e),r=!0,localStorage.setItem("cpnWizAutoCheck","1"),this.submitCoupon(n[t],e)),t++;return r},n.submitCoupon=function(t,n){if(""!=n.elementToggleTxtBox&&e.$(n.elementToggleTxtBox)[0].click(),e.$(n.elementCodeInput)[0].value=t.code,""!=n.elementSubmitButton){var r="form"+n.elementCodeForm+" input[type='submit']";e.$(r).removeAttr("disabled"),e.$(r)[0].click()}e.$(n.elementCodeForm).submit()},n.couponsCheck=function(e){return this.getCouponBeingChecked(e),!!this.getNextCouponCheck(e)||(e.bestCodeSubmitted?(localStorage.removeItem("cpnWizActive"),localStorage.removeItem("cpnWizAutoCheck"),this.removeFOCSaved(),{selectedTotal:e.selectedCouponTotal,selectedCouponCode:e.selectedCouponCode,originalPrice:e.totalSum,bestCouponUrl:e.bestCouponUrl,currencySymbol:e.cpnCurrency}):(this.submitCoupon({code:e.selectedCouponCode},e),e.bestCodeSubmitted=!0,this.setFOCSaved(e),!0))},n.couponPageInfo={providers:[{domainName:"vimeo.com",elementTotal:".total_summary #total:first",elementToggleTxtBox:"#toggle_discount_code",elementCodeInput:"#promo_code_input",elementCodeForm:"#promo_code_form",elementSubmitButton:"input[type='submit']",checkoutUrl:"https://vimeo.com/store/"},{domainName:"shutterstock.com",elementToggleTxtBox:"",elementTotal:".excl-vat.total-down-by",elementCodeInput:".subscription-input",elementCodeForm:"#coupon_form",elementSubmitButton:"",checkoutUrl:"https://www.shutterstock.com/subscribe22.mhtml"}]},n}();n.CouponsWizardHelper=r}(n=t.Common||(t.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(o){function i(n,i,a,s,u,c,l,d,p,f,g,m,h,v,y,C,S,b,w,_,O){var E=this;o.call(this,n,d,p),this.deals=e.ko.observable(),this.coupons=e.ko.observable(),this.campaigns=e.ko.observable(),this.travels=e.ko.observable(),this.video=e.ko.observable(),this.content=e.ko.observable(),this.display=e.ko.observable(),this.push=e.ko.observable(),this.closeButtonVisible=e.ko.observable(!0),this.hasDeals=e.ko.computed(function(){return E.deals()&&E.deals().offers.length>0}),this.hasCoupons=e.ko.computed(function(){return E.coupons()&&E.coupons().offers.length>0}),this.hasCampaigns=e.ko.computed(function(){return E.campaigns()&&E.campaigns().offers.length>0}),this.hasTravels=e.ko.computed(function(){return E.travels()&&E.travels().offers.length>0}),this.hasContentResults=e.ko.computed(function(){return E.content()&&E.content().offers.length>0}),this.hasDisplayResults=e.ko.computed(function(){return E.display()&&E.display().offers.length>0}),this.hasVideos=e.ko.computed(function(){return E.video&&E.video()&&E.video().hasVideo()}),this.hasPush=e.ko.computed(function(){return E.push&&E.push()&&E.push().hasMessage()}),this.hasThingsToShow=e.ko.computed(function(){return E.hasDeals()||E.hasCoupons()||E.hasCampaigns()||E.hasTravels()||E.hasContentResults()||E.hasVideos()||E.hasDisplayResults()||E.hasPush()}),this.selectedTab=e.ko.observable(0),this.dealsDisplayed=!1,this.isShoppingbuddy=!1,this.shoppingBuddyRef="",this.shoppingBuddyImg="",this.shoppingBuddyVersion="0",this.couponsDisplayed=!1,this.campaignsDisplayed=!1,this.travelsDisplayed=!1,this.contentDisplayed=!1,this.pushDisplayed=!1,this.revealedCoupons=e.ko.observable(0),this.moreDealsVisible=e.ko.observable(!1),this.moreDealsUrl=e.ko.observable(),this.couponsMessage=e.ko.observable(),this.cpnWiz=e.ko.observable(!1),this.cpnWizResult=e.ko.observable(),this.cpnWizTotalCoupons=e.ko.observable(0),this.cpnWizCuoponCode=e.ko.observable(),this.cpnWizCouponDiscount=e.ko.observable(),this.cpnWizProgressPhase=e.ko.observable(),this.cpnWizTotalCpnCount=e.ko.observable(),this.cpnWizCurrentCpnIndex=e.ko.observable(),this.cpnWizMeterProgress=e.ko.observable(0),this.visibleItems=e.ko.observable(0),this.dealScroll=e.ko.computed(function(){return E.deals()&&E.deals().offers.length>E.visibleItems()}),this.couponScroll=e.ko.computed(function(){return E.coupons()&&E.coupons().offers.length>E.visibleItems()});var F=i?new r.DealsModel(a,i):new r.DealsModel(null,[]),P=s?new r.CouponsModel(u,s):new r.CouponsModel(null,[]),R=g?new r.CampaignsModel(m,g):new r.CampaignsModel(null,[]),D=h?new r.TravelsModel(v,h):new r.TravelsModel(null,[]),k=c?new r.VideoModel(c,l):new r.VideoModel(null,[]),A=b?new r.ContentModels(b,S):new r.ContentModels(null,[]),T=_?new r.DisplayModels(_,w):new r.DisplayModels(null,[]),x=C?new r.PushModels(C,y):new r.PushModels(null,[]);g&&t.Col.of(g).each(function(e){return e.impressionUrl&&t.Logger.Analytics.notifyGenericUrl(e.impressionUrl)}),this.deals(F),this.coupons(P),this.campaigns(R),this.video(k),this.travels(D),this.content(A),this.display(T),this.push(x),this.dealsKwc=F.offers.length?F.offers[0].offer.keywords.split(" ").join("+"):"",this.setPanelVisibilityAndBadges(F,P,R,D,x,f,n),this.setPanelMaxHeight(n,O),k.hasVideo.subscribe(function(e){1==e?E.selectTab(4):E.setPanelVisibilityAndBadges(F,P,R,D,x,f,n)}),this.setRevealedCoupons(P),this.setBadgePlacements(this.deals(),this.coupons(),this.campaigns()),this.hasContentResults()&&"il"==n.countryCode().toLowerCase()?this.strings=t.Common.LocaleHelper.getLanguageStrings(n.language):this.strings=t.Common.LocaleHelper.getStringMapForCountry(n.countryCode(),t.Locale.sliderStrings)}return __extends(i,o),i.prototype.setPanelMaxHeight=function(t,n){this.visibleItems(t.overrides().intValue("panel.visible.items",n));var r=8*(this.visibleItems()-1),o=this.visibleItems()*this.itemHeight();this.maxHeight=e.ko.computed(function(){return o+r})},i.prototype.setBadgePlacements=function(e,t,n){var r=93,o=95;t&&t.offers.length&&(t.cssBadgeTop=r+"px",r+=o),n&&n.offers.length&&(n.cssBadgeTop=r+"px",r+=o),e&&e.offers.length&&(e.cssBadgeTop=r+"px")},i.prototype.setPanelVisibilityAndBadges=function(e,n,r,o,i,a,s){var u=-1,c=s.overrides().boolValue("useCouponWizard",!0);if(n&&n.offers.length){var l=t.Common.CouponsHelper.pollCouponsMessage(),d=t.Common.CouponsWizardHelper.createCouponsArray(n.offers),p=t.Common.CouponsWizardHelper.couponWizardActive(),f=t.Common.CouponsWizardHelper.couponWizardAutoCheck();if(this.cpnWizTotalCoupons(d.length),p&&d.length&&c){if(u=1,this.cpnWizTotalCoupons(d.length),this.cpnWiz(!0),this.cpnWizProgressPhase(0),f){this.cpnWizProgressPhase(1),this.updateCpnWizProgress();var g=this;setTimeout(function(){g.cpnWizShowResults(n.offers)},1500)}}else!l&&d.length&&c&&a?(u=1,this.cpnWiz(!0),this.cpnWizProgressPhase(0)):(l||a)&&(u=1,this.showCouponMessage(l))}if(e&&e.offers.length&&u==-1)u=0;else if(o&&o.offers.length&&u==-1)u=3;else if(n&&n.offers.length&&u==-1)u=1;else if(r&&r.offers.length&&u==-1)u=2;else if(i&&i.offers.length&&u==-1)u=7;else if(i&&0==i.offers.length&&u==-1)u=8;else if(this.hasContentResults()&&u==-1)u=5;else if(this.display()&&u==-1)u=6;else if(u==-1)return void t.Logger.error("Neither Deals, Coupons, Travels or Campaigns provided");this.selectTab(u,!1)},i.prototype.setComparePricesTarget=function(e){void 0===e&&(e="");var t="http://bestdealwiz.com/";this.moreDealsUrl(t+e)},i.prototype.setMoreDealsTarget=function(e){e.offers.length?this.moreDealsUrl("http://bestdealwiz.com/product-offers/"+e.offers[0].offer.keywords.split(" ").join("+")):this.moreDealsUrl("http://bestdealwiz.com/")},i.prototype.setRevealedCoupons=function(e){this.revealedCoupons(t.StaticCol.count(e.offers,function(e){return e.offer.revealed}))},i.prototype.initCouponWiz=function(){var n=t.Common.CouponsWizardHelper.createCouponsArray(this.coupons().offers),r=t.Common.CouponsWizardHelper.initCouponWizard(n);if(null==r){var o=e.$('<iframe width="0" height="0" style="position: absolute; left: -100px; top: -100px;"></iframe>');o.attr("src",n[0].url),t.Common.VisualHelper.appendToBody(o),t.Common.CouponsHelper.setCouponRevealed(n[0].code),this.cancelCouponWiz(),this.showCouponMessage(n[0].title)}},i.prototype.cancelCouponWiz=function(){var e=this;e.cpnWiz(!1),e.couponsDisplayed=!1;try{e.selectTab(0)}catch(t){e.selectTab(1)}e.selectTab(1)},i.prototype.shoppingBuddyOnClick=function(e,n){window.open(e.shoppingBuddyRef,"_blank"),t.Logger.Analytics.notify(this.deals().context,{key:"generic",subtype:"shppingBuddyClick"},{shoppingBuddyVersion:this.shoppingBuddyVersion})},i.prototype.selectTab=function(e,r){if(void 0===r&&(r=!0),this.selectedTab(e),r&&this.collapsed(!1),0==e){if(this.setComparePricesTarget("product-offers/"+this.dealsKwc),!this.dealsDisplayed){this.dealsDisplayed=!0;var o=this.gatherSchemaStats();t.Logger.Analytics.notify(this.deals().context,t.Logger.Analytics.IMPRESSION,o)}this.isShoppingbuddy=t.Flags.flag(t.Flags.Deals.SHOW_SHOPPING_BUDDY),this.shoppingBuddyImg="https://static.shopper-tech.com/images/banner_present_more_deals.jpg",this.shoppingBuddyRef="http://shoppingbuddy.mobitech.io/play-redirect.html",this.shoppingBuddyVersion="1"}if(1==e){var i=n.Logic.CampaignsLogic.breakUrlIntoComponents(document.location.protocol+"//"+document.location.host,document.location.pathname);this.setComparePricesTarget("coupons/"+i[0]),this.couponsDisplayed||(this.couponsDisplayed=!0,t.Logger.Analytics.notify(this.coupons().context,t.Logger.Analytics.IMPRESSION))}if(2==e&&(this.setComparePricesTarget(),!this.campaignsDisplayed)){this.campaignsDisplayed=!0;for(var a=[],s=0;s<this.campaigns().offers.length;s++)a.indexOf(this.campaigns().offers[s].offer.campaignTitle)<0&&a.push(this.campaigns().offers[s].offer.campaignTitle);t.Logger.Analytics.notify(this.campaigns().context,t.Logger.Analytics.IMPRESSION,{cmpnimpr:a.join("|")})}3==e&&(this.setComparePricesTarget(),this.travelsDisplayed||(this.travelsDisplayed=!0,t.Logger.Analytics.notify(this.travels().context,t.Logger.Analytics.IMPRESSION))),5==e&&(this.setComparePricesTarget(),this.contentDisplayed||(this.contentDisplayed=!0,t.Logger.Analytics.notify(this.content().context,t.Logger.Analytics.IMPRESSION))),7==e&&(this.pushDisplayed||(this.pushDisplayed=!0,t.Logger.Analytics.notify(this.push().context,t.Logger.Analytics.IMPRESSION))),8==e&&t.Logger.Analytics.notify(this.push().context,t.Logger.Analytics.IMPRESSION)},i.prototype.itemHeight=function(){return 5==this.selectedTab()?182:125},i.prototype.gatherSchemaStats=function(){var e;return e="1"==this.deals().context.extraParams.og_exist?{kwds:this.deals().offers[0].offer.keywords,ogExist:this.deals().context.extraParams.og_exist,ogTitle:this.deals().context.extraParams.og_title,ogType:this.deals().context.extraParams.og_Type,ogFields:this.deals().context.extraParams.og_fields}:{kwds:this.deals().offers[0].offer.keywords,ogFields:this.deals().context.extraParams.og_exist}},i.prototype.showCouponMessage=function(e){var t=this;t.couponsMessage(e),setTimeout(function(){t.couponsMessage("")},6e3)},i.prototype.updateCpnWizProgress=function(){var e=t.Common.CouponsWizardHelper.progressDisplay();this.cpnWizTotalCpnCount(e.totalCoupons),this.cpnWizCurrentCpnIndex(e.currentCoupon),this.cpnWizCuoponCode(e.currentCouponCode),this.cpnWizMeterProgress(e.currentCoupon/e.totalCoupons*100)},i.prototype.cpnWizShowResults=function(n){var r=t.Common.CouponsWizardHelper.initCouponWizard(n);if(!t.Common.CouponsWizardHelper.isEmpty(r)){this.cpnWizProgressPhase(2);var o=Math.round(100*(r.originalPrice-r.selectedTotal))/100;if(o>0){this.cpnWizCouponDiscount(r.currencySymbol+o),this.cpnWizCuoponCode(r.selectedCouponCode);var i=e.$('<iframe width="0" height="0" style="position: absolute; left: -100px; top: -100px;"></iframe>');i.attr("src",r.bestCouponUrl),t.Common.VisualHelper.appendToBody(i)}else this.cpnWizProgressPhase(3)}},i}(r.ProductModelBase);r.PanelModel=o}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.prototype.afterRender=function(t){var n=t.find(".fo-code-slide-text");n.click(function(t){e.selectText(t.target)})},e.selectText=function(e){var t=document.body;if(window.getSelection){var n=window.getSelection(),r=document.createRange();r.selectNodeContents(e),n.removeAllRanges(),n.addRange(r)}else if(t.createTextRange){var o=t.createTextRange();o.moveToElementText(e),o.select()}},e}();e.CouponTextSelectHandler=t}(t=e.DisplayHandlers||(e.DisplayHandlers={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(t){var n=function(){function t(){}return t.prototype.afterRender=function(n){e.$("body").click(function(e){return t.checkCloseSuspendBox(e,n)}),n.click(function(e){return t.checkCloseSuspendBox(e,n)}),n.find(".fo-suspend.fo-tools-btn").click(function(e){return t.openSuspendBox(e,n)}),n.find(".fo-suspend-close-button.fo-tooltip-btn").click(function(e){return t.closeSuspendBox(e,n)})},t.openSuspendBox=function(t,n){var r=e.$(t.target).closest(".fo-suspend-close-button.fo-tooltip-btn").length>0;r||n.find(".fo-suspend-tooltip").addClass("shown"),t.stopPropagation()},t.checkCloseSuspendBox=function(n,r){var o=e.$(n.target).closest(".fo-suspend-tooltip").length>0;o||t.closeSuspendBox(n,r)},t.closeSuspendBox=function(e,t){t.find(".fo-suspend-tooltip").removeClass("shown"),e.stopPropagation()},t}();t.SuspendBoxHandler=n}(n=t.DisplayHandlers||(t.DisplayHandlers={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.prototype.afterRender=function(e){try{e.find(".elps").dotdotdot()}catch(t){}},e}();e.EllipsisHandler=t}(t=e.DisplayHandlers||(e.DisplayHandlers={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(e){this.context=e}return t.prototype.afterRender=function(t){e.Logger.Analytics.notify(this.context,e.Logger.Analytics.GENERIC,{subtype:"realimpression",when:"afterRender"})},t}();t.AfterRenderImpression=n}(t=e.DisplayHandlers||(e.DisplayHandlers={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){var n=function(){function t(){}return t.injectPlayer=function(n,r,o,i){void 0===r&&(r=function(){}),void 0===o&&(o=function(){}),void 0===i&&(i=function(){});var a=window.FO_VD_ADS_TEST?t.ADSOURCE_TEST_URL:t.ADSOURCE_URL;e.Common.Res.injectScript(a).then(function(){try{customAdCall(n,300,250,!0,!0,r,o,i)}catch(t){e.Logger.error("AdSource exeption: "+t)}})},t.ADSOURCE_URL="//s2.medemedia.com/adsource/clients/FOFF.js",t.ADSOURCE_TEST_URL="//s2.medemedia.com/adsource/clients/FTEST.js",t}();t.AdSource=n}(n=t.Video||(t.Video={}))}(t=e.ExternalApi||(e.ExternalApi={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t){this.publisher="jwplayer",this.context=e,this.model=t}return e.prototype.afterRender=function(e,t){},e}();e.JwPlayerVideoDisplayHandler=t}(t=e.DisplayHandlers||(e.DisplayHandlers={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(){function r(){this.isLazy=!1,this.element=null,this.model=null}return r.prototype.config=function(){throw new Error("Config Not implemented")},r.prototype.realEstate=function(){return this.config().realEstate},r.prototype.flag=function(){return this.config().flag},r.prototype.determineNeededItemCount=function(e){var t=this.config().primaryItemCount,r=this.config().secondaryItemCount;if(t||r)return new n.ItemCounts(t||0,r||0);throw new Error("Item counts not implemented")},r.prototype.getParentElement=function(){return document.documentElement.getElementsByTagName("body")[0]},r.prototype.declareResourcesPromise=function(e){return{templates:t.Common.Res.bring(e.paths().innerResourcesRoot()+"/Resources/templates.html"),css:t.Common.Res.injectCss2(this.cssUrl(e))}},r.prototype.declareDisplayHandlers=function(e){var n=[new t.DisplayHandlers.EllipsisHandler,new t.DisplayHandlers.SuspendBoxHandler,new t.DisplayHandlers.CouponTextSelectHandler,new t.DisplayHandlers.AfterRenderImpression(e)];return n},r.prototype.cssUrl=function(e){return e.paths().innerResourcesRoot()+"/Resources/"+this.config().rootCssFile},r.prototype.getLegacySuspension=function(e){var n=t.Col.of(t.Extras.LegacyTranslationTable.suspendIds).first(function(t){return t.nwp==e}),r=n?n.old:"suspend_"+e;return r},r.prototype.draw=function(r,o,i){var a,s,u=o.CommerceDeals,c=o.ExternalWidget;try{s=u?u.context:c?c.context:null;var l=u?u.data:null,d=c?c.data:null;a=l&&d?l.concat(d):l?l:d?d:null}catch(p){t.Logger.error("failed merging externalWidgets: "+p.message),a=u?u.data:null,s=u?u.context:null}var f,g,m=o.Coupons,h=m?m.data:null,v=m?m.context:null,y=!!m&&this.isOnCouponsWhitelist(m),C=o.Campaigns,S=o.Aedgency;try{f=C?C.context:S?S.context:null;var b=C?C.data:null,w=S?S.data:null;g=b&&w?b.concat(w):b?b:w?w:null}catch(p){t.Logger.error("failed merging aedgency: "+p.message),g=C?C.data:null,f=C?C.context:null}var _=o.Travels,O=_?_.context:null,E=_?_.data:null,F=o.Content,P=F?F.context:null,R=F?F.data:null,D=o.Display,k=D?D.data:null,A=D?D.context:null,T=o.Video,x=T?T.data:null,I=T?T.context:null,L=o.PushDisplay||o.PushM,N=L?L.context:null,B=L?L.data:null,M=s||v||O||f||P||I||A||N,H=i.templates,V=e.$(H);t.Common.SafeDocument.append(document.body,V[0],!1);var W=this.declareDisplayHandlers(M),U=n.VisualRealEstate[this.realEstate()],j=this.getLegacySuspension(U),z=new n.Model.PanelModel(M,a,s,h,v,I,x,U,j,y,g,f,E,O,B,N,R,P,k,A,this.visibleItems());z.cssUrl=this.cssUrl(M),z.cssName=this.config().rootCssClass;var G=e.$('<div class="sgsefvhuedc" data-bind="template: \''+this.config().rootTemplate+"'\"></div>"),q=G[0],K=this.getParentElement();t.Common.DomProtect.safeAppend(K,q,this.config().appendFirst),z.postRenderHandler=function(e,n){t.Col.of(W).each(function(t){return t.afterRender(e,n)})},z.onClose=function(){t.Col.of(W).each(function(e){return e.remove&&e.remove()}),t.Common.DomProtect.safeRemove(q)},this.element=q,this.model=z;this.config().appendFirst;try{return e.ko.applyBindings(z,q),t.resolve(n.DisplayState.Shown)}catch(p){throw t.Col.of(W).each(function(e){return e.remove&&e.remove()}),t.Common.DomProtect.safeRemove(q),p}},r.prototype.isOnCouponsWhitelist=function(e){var t=document.location.host+document.location.pathname;t=t.replace(/www\.|\/$/g,"");var n=e.extras.rootCouponsUrl;return n.indexOf(t)!=-1},r.prototype.remove=function(e){this.model.onClose()},r.prototype.visibleItems=function(){return 9999},r}();r.GenericPanelVisual=o}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(e){this.mouseOverElement=!1,this.cleanup=[];var t=e.overrides().boolValue("rightslider.scroll-sync",!0),n=e.overrides().boolValue("rightslider.scroll-arrows",!0),r=e.overrides().intValue("rightslider.scroll-auto",0),o=e.overrides().boolValue("rightslider.scroll-independent",!0),i=e.overrides().boolValue("rightslider.scroll-peekaboo",!1),a=["fo-deals-tab","fo-coupons-tab"];this.tabClasses=a,this.syncToPage=t,this.autoScroll=r,this.scrollIndepandent=o,this.peekaboo=i,this.scrollArrows=n,this.directionalHelper={lengthFn:function(e){return e.height()},positionProperty:"margin-top"}}return n.prototype.afterRender=function(e){var r=this,o=!!window.FO_NOSCROLL;o||(t.Col.of(r.tabClasses).each(function(t){var o=e.find("."+t);n.scrollTabToIndex(r,o,0)}),e.hover(function(){return r.mouseOverElement=!0},function(){return r.mouseOverElement=!1}),this.syncToPage&&this.setupSyncToPage(e),this.scrollArrows&&this.setupScrollArrows(e),this.autoScroll&&this.setupAutoScroll(e),this.scrollIndepandent&&this.setupIndependentScroll(e),this.peekaboo&&this.setupPeekaboo(e))},n.prototype.remove=function(){t.StaticCol.each(this.cleanup,function(e){return e()})},n.prototype.setupSyncToPage=function(t){var r=this;n.syncScrollToPage(r,t);var o=function(){return n.syncScrollToPage(r,t)};e.$(window).scroll(o),r.cleanup.push(function(){return e.$(window).off("scroll",o)})},n.prototype.setupScrollArrows=function(t){var r=this;t.find(".fo-scroll-btn").each(function(t,o){e.$(o).click(function(t){var o=e.$(t.target),i=o.closest(".fo-tab"),a=parseInt(o.attr("data-scroll-step"));n.scrollTabByStep(r,i,a)})})},n.prototype.setupAutoScroll=function(e){var r=this,o=window.setInterval(function(){r.mouseOverElement||t.Col.of(r.tabClasses).each(function(t){var o=e.find("."+t),i=o.data("fo-current-scroll-index"),a=n.scrollTabToIndex(r,o,i+1,"slow");a||n.scrollTabToIndex(r,o,0,"slow")})},this.autoScroll);r.cleanup.push(function(){return clearInterval(o)})},n.prototype.setupIndependentScroll=function(r){var o=this,i=function(e){if(o.mouseOverElement){e.preventDefault(),e.cancelBubble=!0,e.stopPropagation();var i=e.originalEvent.wheelDeltaY<0?1:-1;t.Col.of(o.tabClasses).each(function(e){var t=r.find("."+e),a=t.data("fo-current-scroll-index");n.scrollTabToIndex(o,t,a+i,"fast")})}};e.$(window).on("mousewheel",i),o.cleanup.push(function(){return e.$(window).off("mousewheel",i);
})},n.prototype.setupPeekaboo=function(e){var r=this;t.Col.of(r.tabClasses).each(function(t){var o=e.find("."+t);n.scrollTabToIndex(r,o,1,"slow"),window.setTimeout(function(){return n.scrollTabToIndex(r,o,0,"slow")},1500)})},n.syncScrollToPage=function(e,r){t.Col.of(e.tabClasses).each(function(t){var o=r.find("."+t);n.syncTabScrollToPage(e,o)})},n.syncTabScrollToPage=function(t,r){var o=e.$(document).height(),i=e.$(window).scrollTop(),a=i/o,s=r.find(".fo-list li"),u=Math.round(s.length*a);n.scrollTabToIndex(t,r,u)},n.scrollTabToIndex=function(e,t,n,r){void 0===r&&(r="fast");var o=t.find(".fo-list"),i=o.find("li"),a=e.directionalHelper.lengthFn(o),s=(a+8)/i.length,u=e.directionalHelper.lengthFn(t.find(".fo-list-wrapper")),c=Math.round(u/s);if(n>=0&&n<=i.length-c){var l=t.data("fo-current-scroll-index");if(n!=l){var d=n*s,p={};return p[e.directionalHelper.positionProperty]="-"+d+"px",o.stop(),o.animate(p,r),t.data("fo-current-scroll-index",n),t.find(".fo-scroll-up").toggleClass("fo-active",n>0),t.find(".fo-scroll-down").toggleClass("fo-active",n<i.length-c),!0}}return!1},n.scrollTabByStep=function(e,t,r){var o=t.data("fo-current-scroll-index");n.scrollTabToIndex(e,t,o+r)},n}();n.ScrollHandler=r}(n=t.DisplayHandlers||(t.DisplayHandlers={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(e){function r(){e.apply(this,arguments)}return __extends(r,e),r.prototype.declareDisplayHandlers=function(n){var r=e.prototype.declareDisplayHandlers.call(this,n),o=new t.DisplayHandlers.ScrollHandler(n),a=new i;return r.push(o),r.push(a),r},r.prototype.config=function(){var e=t.flag(t.Flags.Display.SKIN),r=!0,o=r?"rightSlider.css":"rightSliderIframe.css",i=!!window.FO_MOREOFFERS;i?o="altRightSlider.css":e&&"default"!=e.toLowerCase()&&(o="rightSlider-"+e+".css");var a=r?"right-slider-div-template":"right-slider-template2";return{realEstate:n.VisualRealEstate.RIGHT_PANEL,flag:"rsy",rootTemplate:a,rootCssFile:o,rootCssClass:"fo-right-sliderx",appendFirst:!1,primaryItemCount:4,secondaryItemCount:8}},r.prototype.visibleItems=function(){var e=!!window.FO_MOREOFFERS;return e?5:4},r}(r.GenericPanelVisual);r.RightSliderY=o;var i=function(){function n(){}return n.prototype.afterRender=function(n,r){t.Flags.flag(t.Flags.Deals.KEEP_CLOSE_BOTTOM_ON_SCREEN)&&e.$(".fo-right-sliderx.fo-container").css({top:"inherit"})},n}()}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(e){this.cssUrl=e}return n.prototype.afterRender=function(e){t.Common.Res.injectCss2(this.cssUrl)},n.prototype.remove=function(){e.$("link[rel='stylesheet'][href='"+this.cssUrl+"']").prop("disabled",!0)},n}();n.TransiantCSSHandler=r}(n=t.DisplayHandlers||(t.DisplayHandlers={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.config=function(){return{realEstate:t.VisualRealEstate.TOP_PANEL,flag:"tby",rootTemplate:"generic-horizontal-template-div",rootCssFile:"topBar.css",rootCssClass:"fo-top-barx",appendFirst:!1,primaryItemCount:4,secondaryItemCount:8}},r.prototype.declareDisplayHandlers=function(t){var r=t.paths().innerResourcesRoot()+"/Resources/topBarPushBody.css",o=new e.DisplayHandlers.TransiantCSSHandler(r),i=n.prototype.declareDisplayHandlers.call(this,t);return i.push(o),i},r}(n.GenericPanelVisual);n.TopBarY=r}(n=t.Visual||(t.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){}return t.matchToLocation=function(n){var r=t.searchEngineConfigs.first(function(e){return e.validateLocation(n)});return null==r&&e.Logger.log("Didnt match any search engine!"),r},t.googleConfig={name:"Google",validateLocation:function(e){var t=0==e.host.indexOf("www.google."),n=""==e.pathname||"/"==e.pathname||"/search"==e.pathname||"/webhp"==e.pathname;return t&&n},queryKey:"q",getParentElement:function(){return document.getElementById("rcnt")||document.getElementById("appbar")},cssName:"googleSearchBar"},t.bingConfig={name:"Bing",validateLocation:function(e){var t=0==e.host.indexOf("www.bing."),n=e.pathname.indexOf("/search")==e.pathname.length-6-1;return t&&n},queryKey:"q",getParentElement:function(){return document.getElementById("vm_res")||document.getElementById("b_content")||document.getElementsByClassName("Content").length&&document.getElementsByClassName("Content")[0]},cssName:"bingSearchBar"},t.yahooConfig={name:"Yahoo",validateLocation:function(e){var t=e.host.indexOf("search.yahoo.")>=0,n=0==e.pathname.indexOf("/search");return t&&n},queryKey:"p",getParentElement:function(){var e=document.getElementById("results"),t=document.getElementById("bd");return e&&"section"==e.tagName.toLowerCase()?e:t&&"document"==t.getAttribute("role")?t:null},cssName:"yahooSearchBar"},t.askConfig={name:"Ask",validateLocation:function(t){var n="www.ask.com"==t.hostname,r=e.StaticCol.contains(["/web","/pictures","/news","/youtube","/shopping"],t.pathname);return n&&r},queryKey:"q",getParentElement:function(){return document.getElementById("mrRSM")||document.getElementById("csaTop")},cssName:"askSearchBar"},t.aolConfig={name:"AOL",validateLocation:function(e){return 0==e.hostname.indexOf("search.aol.")},queryKey:"q",getParentElement:function(){return document.getElementById("c")},cssName:"aolSearchBar"},t.searchEngineConfigs=e.Col.of([t.askConfig]),t}();t.SearchEngines=n}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.config=function(){var n=e.Common.SearchEngines.matchToLocation(document.location);return{realEstate:t.VisualRealEstate.SEARCH_BAR,flag:"sby",rootTemplate:"generic-horizontal-template-div",rootCssFile:n&&n.cssName+".css",rootCssClass:"fo-search-barx",appendFirst:!0,primaryItemCount:3,secondaryItemCount:0}},r.prototype.getParentElement=function(){var t=e.Common.SearchEngines.matchToLocation(document.location);return t&&t.getParentElement()},r}(n.GenericPanelVisual);n.SearchBarY=r}(n=t.Visual||(t.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.config=function(){return{realEstate:e.VisualRealEstate.TOP_PANEL,flag:"tsy",rootTemplate:"generic-horizontal-template-div",rootCssFile:"topSlider.css",rootCssClass:"fo-top-sliderx",appendFirst:!1,primaryItemCount:4,secondaryItemCount:0}},n}(t.GenericPanelVisual);t.TopSliderY=n}(t=e.Visual||(e.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.config=function(){return{realEstate:e.VisualRealEstate.BOTTOM_PANEL,flag:"bsy",rootTemplate:"bottom-slider-template-div",rootCssFile:"bottomBar.css",rootCssClass:"fo-bottom-sliderx",appendFirst:!1,primaryItemCount:4,secondaryItemCount:8}},n}(t.GenericPanelVisual);t.BottomSliderY=n}(t=e.Visual||(e.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(o){function a(a,s,u,c,l){var d=this;void 0===l&&(l=function(){}),o.call(this,a.context,s,u,l),this.button=e.ko.observable(),this.deals=e.ko.observable(),this.selectedTab=e.ko.observable(0),this.hasDeals=e.ko.computed(function(){return d.deals()&&d.deals().offers.length>0}),this.dealScroll=e.ko.observable(!1),this.hasCoupons=e.ko.observable(!1),this.hasCampaigns=e.ko.observable(!1),this.hasVideos=e.ko.observable(!1),this.hasTravels=e.ko.observable(!1),this.closeButtonVisible=e.ko.observable(!0),this.couponsMessage=e.ko.observable(""),this.moreDealsUrl=e.ko.observable(""),this.isShoppingbuddy=!1,this.modalTarget=e.ko.observable(),this.isWindowOpen=e.ko.computed(function(){return null!=d.deals()}),this.bodyRect=e.ko.observable(null),this.visibleRows=e.ko.observable(0);var p=this;this.strings=t.Common.LocaleHelper.getStringMapForCountry(a.context.countryCode(),t.Locale.sliderStrings),this.bodyRect=e.ko.observable(null);var f=new r.MemoryImageContainer,g=t.Col.of(a.validImages),m=(g.getItem(0),function(e){return a.generateData(e,a.context,new n.ItemCounts(0,10))}),h=function(t){var n=new r.DealsModel(p.context,t.data());p.modalTarget(e.$(t.target())),p.deals(n)},v=new i(m,h,f,this.bodyRect);this.button(v);var y=function(){var n=d.context.scraper().getElementPosWithOffsets(e.$("body")[0]);p.bodyRect()&&t.Common.isEquivalent(n,p.bodyRect())||p.bodyRect(n)};window.setInterval(y,1e3),y(),g.each(function(n){e.$(n).mouseenter(function(e){t.Logger.log("mouseEnter - btn"),p.button()&&p.button().setNewTarget(n)})}),this.suspendTarget.closeFn=this.onClose,this.isWindowOpen.subscribe(function(e){return e&&t.Logger.Analytics.notify(p.context,t.Logger.Analytics.IMPRESSION)}),this.setModalMaxHeight(a.context,c)}return __extends(a,o),a.prototype.setModalMaxHeight=function(t,n){this.visibleRows(t.overrides().intValue("modal.visible.rows",n));var r=8*(this.visibleRows()-1),o=this.visibleRows()*this.rowHeight();this.maxHeight=e.ko.computed(function(){return o+r})},a.prototype.onWindowOpenChange=function(e){e&&t.Logger.Analytics.notify(this.context,t.Logger.Analytics.IMPRESSION)},a.prototype.hide=function(){this.dismissWindow()},a.prototype.dismissWindow=function(){this.deals(null)},a.prototype.rowHeight=function(){return 125},a}(r.ProductModelBase);r.GenericButtonModel=o;var i=function(){function n(r,o,i,a){var s=this;this.displayDelay=e.ko.observable(300),this.selfHoverStart=0,this.target=e.ko.observable(),this.isLoading=e.ko.observable(!1),this.data=e.ko.observable(null),this.hasNoResults=e.ko.computed(function(){return s.data()&&0==s.data().length}),this.buttonText=e.ko.computed(function(){return s.hasNoResults()?"No deals":s.data()||!s.isLoading()?"Compare":"Loading..."}),this.isTargetHovered=e.ko.observable(!1),this.isSelfHovered=e.ko.observable(!1),this.isVisible=e.ko.computed(function(){return window.FO_ALWAYSON||s.isTargetHovered()||s.isSelfHovered()}),this.generator=null;var u=this;this.btnDataCollector=i,this.bodyRect=a,this.generator=r,this.displayWidnowFn=function(e){u.isTargetHovered(!1),u.isSelfHovered(!1),o(e)},this.buttonPosition=e.ko.computed(function(){return u.target(),u.isTargetHovered(),u.bodyRect(),n.calcButtonPosition(u.target())}),this.targetRect=e.ko.computed(function(){return u.target(),u.isTargetHovered(),u.bodyRect(),t.Common.VisualHelper.getElementPosWithOffsets(u.target())}),this.isSelfHovered.subscribe(function(e){if(e)u.selfHoverStart=(new Date).getTime();else{var t=(new Date).getTime()-u.selfHoverStart;t<u.displayDelay()&&u.delayedHoverTimeoutId&&clearTimeout(u.delayedHoverTimeoutId)}})}return n.prototype.setNewTarget=function(n){t.Logger.log("Setting new target"),this.btnDataCollector.getImageData(n)||(this.btnDataCollector.setImageData({image:n,jqImage:e.$(n),dealsGenerator:this.generator}),this.attachHandlers(n)),this.target(n),this.data(null),this.isTargetHovered(!0)},n.prototype.attachHandlers=function(n){var r=this;t.Logger.log("Attached handler"),e.$(n).mouseenter(function(e){r.isTargetHovered(!0)}),e.$(document.body).mouseover(function(e){r.isTargetHovered()&&(t.Common.VisualHelper.isContained(e.pageX,e.pageY,r.targetRect())||r.isTargetHovered(!1))})},n.prototype.displayAfterDelay=function(){var e=this,n=this;if(!(this.hasNoResults()||window.FO_DONT_OPEN||this.data()||this.isLoading())){this.isLoading(!0);var r=Date.now();this.loadData().then(function(){return t.wait(e.displayDelay()-(Date.now()-r)).then(function(){return n.isSelfHovered()&&n.display()})})}},n.prototype.display=function(){var e=this;this.hasNoResults()||window.FO_DONT_OPEN||(this.data()?this.displayWidnowFn(this):this.isLoading()?t.Logger.warn("have no data yet but was asked to display modal"+this.data()):(this.isLoading(!0),this.loadData().then(function(){return e.displayWidnowFn(e)})))},n.prototype.loadData=function(){var e=this,n=this.btnDataCollector.getImageData(this.target()),r=n.dataPromise||n.dealsGenerator(n.image);return n.dataPromise=r,r.then(function(n){t.Logger.log("Generator returned "+(n?n.length:n)),e.isLoading(!1),e.data(n)})},n.calcButtonPosition=function(e){var n=t.Common.VisualHelper.getElementPosWithOffsets(e);if(n){var r=n.left+n.width/2,o=n.top+40;return{x:r,y:o}}return{x:0,y:0}},n}();r.CompareButtonModel=i}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(){function r(){this.isLazy=!1,this.element=null}return r.prototype.realEstate=function(){return n.VisualRealEstate.IMAGE_INNER},r.prototype.flag=function(){return"gby"},r.prototype.determineNeededItemCount=function(e){return new n.ItemCounts(0,10)},r.prototype.declareResourcesPromise=function(e){return{panel_css:t.Common.Res.injectCss2(e.paths().innerResourcesRoot()+"/Resources/multiButton.css"),templates:t.Common.Res.bring(e.paths().innerResourcesRoot()+"/Resources/templates.html")}},r.prototype.getOldSuspensionIdentifer=function(){return"forb"},r.prototype.getMainCssClass=function(){return"fo-iframe-right-slider"},r.prototype.getParentElement=function(){return document.documentElement.getElementsByTagName("body")[0]},r.prototype.draw=function(r,o,i){var a=this,s=o.Deals,u=t.Col.of([new t.DisplayHandlers.EllipsisHandler,new t.DisplayHandlers.SuspendBoxHandler]),c=i.templates,l=e.$(c);t.Common.VisualHelper.appendToBody(l);var d=e.$("<div data-bind='template: \"multibutton-template\"'></div>"),p=d[0];this.element=p,t.Common.VisualHelper.appendToBody(d);var f=function(){u.each(function(e){return e.remove&&e.remove()}),t.Common.DomProtect.safeRemove(a.element)},g=n.VisualRealEstate[this.realEstate()],m=this.getOldSuspensionIdentifer(),h=new n.Model.GenericButtonModel(s,g,m,this.visibleRows(),f);return h.cssUrl=s.context.paths().innerResourcesRoot()+"/Resources/multiButton.css",h.cssName="fo-modal-panel",h.postRenderHandler=function(e,t){u.each(function(n){return n.afterRender(e,t)})},e.ko.applyBindings(h,p),t.resolve(n.DisplayState.Shown)},r.prototype.remove=function(e){t.Common.DomProtect.safeRemove(this.element)},r.prototype.visibleRows=function(){return 3},r}();r.GenericButtonY=o}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){this.isLazy=!1}return n.prototype.realEstate=function(){return t.VisualRealEstate.EVERYWHERE},n.prototype.flag=function(){return"serp"},n.prototype.determineNeededItemCount=function(e){return new t.ItemCounts(1,0)},n.prototype.declareResourcesPromise=function(e){return{}},n.prototype.draw=function(n,r,o){var i=this,a=r["search-offers"],s=a.data[0];return window.FO_DEBUG&&console.log("Serp deal",s),this.handler=function(n){t.Logic.SearchPageLogic.markShown(a.context);var r=e.Data.DealHelper.clickDataFromDeal(s);e.Logger.Analytics.notify(a.context,e.Logger.Analytics.CLICK,r),i.remove(null)},window.addEventListener("click",this.handler,!0),e.Logger.Analytics.notify(a.context,e.Logger.Analytics.IMPRESSION),e.resolve(t.DisplayState.Shown)},n.prototype.remove=function(e){window.removeEventListener("click",this.handler,!0)},n}();n.SearchPageVisual=r}(n=t.Visual||(t.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){this.isLazy=!1}return n.prototype.realEstate=function(){return t.VisualRealEstate.NOWHERE},n.prototype.flag=function(){return"external"},n.prototype.determineNeededItemCount=function(e){return null},n.prototype.declareResourcesPromise=function(t){return{templates:e.resolve(null)}},n.prototype.draw=function(n,r,o){return e.resolve(t.DisplayState.Shown)},n.prototype.remove=function(e){},n}();n.EmptyVisual=r}(n=t.Visual||(t.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(e){this.pushed=[],this.direction=e}return n.prototype.afterRender=function(e){var t=this;n.adjustFixedPositions(e,t.direction,t.pushed),setInterval(function(){return n.adjustFixedPositions(e,t.direction,t.pushed)},3e3)},n.adjustFixedPositions=function(n,r,o){var i=r.additionFn(n),a=t.Col.of(o);e.$("*").each(function(){var t=this,s=e.$(this);if("fixed"==s.css("position")&&s.css(r.property).length>0&&s!=n){var u=s.css(r.property),c=parseInt(u);if("number"==typeof c&&!a.any(function(e){return e==t})){var l=c+i;s.css(r.property,l+"px"),o.push({element:this,originalValue:u})}}})},n.prototype.remove=function(){var n=this;t.Col.of(this.pushed).each(function(t){return e.$(t).css(n.direction.property,t.originalValue)})},n.TOP={property:"top",additionFn:function(e){return e.height()}},n.RIGHT={property:"right",additionFn:function(e){return e.width()}},n}();n.PushFixedHandler=r}(n=t.DisplayHandlers||(t.DisplayHandlers={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.declareDisplayHandlers=function(t){window.FO_ADJUSTSCALE={active:!1};var r=t.paths().innerResourcesRoot()+"/Resources/rightBarPushBody.css",o=new e.DisplayHandlers.TransiantCSSHandler(r),i=n.prototype.declareDisplayHandlers.call(this,t);return i.push(o),i},r.prototype.config=function(){!!window.FO_MOREOFFERS;return{realEstate:t.VisualRealEstate.RIGHT_PANEL,flag:"rbary",rootTemplate:"right-bar-div-template",rootCssFile:"rightBar.css",rootCssClass:"fo-right-sliderx",appendFirst:!1,primaryItemCount:4,secondaryItemCount:8}},r}(n.GenericPanelVisual);n.RightBarY=r}(n=t.Visual||(t.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(){function r(){this.isLazy=!1}return r.prototype.realEstate=function(){return n.VisualRealEstate.NOWHERE},r.prototype.flag=function(){return"stub"},r.prototype.determineNeededItemCount=function(e){return null},r.prototype.declareResourcesPromise=function(e){return{templates:t.Common.Res.bring(e.paths().innerResourcesRoot()+"/Resources/stubTemplates.html")}},r.prototype.draw=function(r,o,a){var s=o.stub,u=s.context,c=a.templates,l=e.$(c);t.Common.VisualHelper.appendToBody(l);var d=e.$("<div data-bind=\"template: 'stub-template'\"></div>"),p=d[0],f=new i(u);return t.Common.VisualHelper.safeAppend(document.body,d,!1),e.ko.applyBindings(f,p),t.resolve(n.DisplayState.Shown)},r.prototype.remove=function(e){},r}();r.StubVisual=o;var i=function(){function t(t){this.context=e.ko.observable(t);var n=e.ko.observable(1);this.rootNumProp=n;var r=new a;this.sub=e.ko.observable(r),setInterval(function(){return r.numProp(r.numProp()+1)},1e3),setInterval(function(){return n(n()+1)},1e3)}return t}(),a=function(){function t(){this.numProp=e.ko.observable(1)}return t}()}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){this.isLazy=!1}return n.prototype.realEstate=function(){return t.VisualRealEstate.NOWHERE},n.prototype.flag=function(){return"null"},n.prototype.determineNeededItemCount=function(e){return new t.ItemCounts(4,0)},n.prototype.declareResourcesPromise=function(e){return{}},n.prototype.draw=function(n,r,o){return e.resolve(t.DisplayState.Shown)},n.prototype.remove=function(e){},n}();n.NullVisual=r}(n=t.Visual||(t.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(e.ProductModelBase);e.VideoSliderModel=t}(t=e.Model||(e.Model={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(e,t){this.context=e,this.model=t;for(var n in this)"function"==typeof this[n]&&(this[n]=this[n].bind(this))}return t.prototype.onVideoShow=function(){e.Logger.log("video Ad Started"),e.Logger.Analytics.notify(this.context,e.Logger.Analytics.GENERIC,{subtype:"videoStarted",publisher:this.publisher}),this.model.collapsed(!1)},t.prototype.onVideoFinished=function(){var t=this;e.Logger.log("video Ad Finished"),e.Logger.Analytics.notify(this.context,e.Logger.Analytics.GENERIC,{subtype:"videoFinished",publisher:this.publisher}),this.model.collapsed(!0),setTimeout(function(){return t.model.hide()},500)},t.prototype.onError=function(){e.Logger.Analytics.notify(this.context,e.Logger.Analytics.GENERIC,{subtype:"videoError",publisher:this.publisher})},t}();t.VideoDisplayHandlerBase=n}(t=e.DisplayHandlers||(e.DisplayHandlers={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(t){function n(e,n){t.call(this,e,n),this.publisher="adSource"}return __extends(n,t),n.prototype.afterRender=function(t){e.Logger.log("Requesting video:"),e.ExternalApi.Video.AdSource.injectPlayer(this.model.videoContainerId,this.onVideoShow,this.onVideoFinished,this.onError)},n}(t.VideoDisplayHandlerBase);t.AdSourceVideoDisplayHandler=n}(t=e.DisplayHandlers||(e.DisplayHandlers={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){var n;!function(e){e[e.AdImpression=0]="AdImpression",e[e.AdFinsihed=1]="AdFinsihed",e[e.AdError=2]="AdError"}(n||(n={}));var r=function(){function t(){}return t.setEpomAdsGlobals=function(e){window.EpmadsConfig=window.EpmadsConfig||{ads:[]},window.EpmadsConfig.ads.push({epmads_key:"455f7215b793eb4aaf5604486341c0ce",epmads_channel:"",epmads_code_format:"ads",epmads_ads_host:"//ecpmrocks.com",epmads_click:"",epmads_custom_params:{},epmads_width:"300px",epmads_height:"250px",epmads_target_id:e})},t.injectPlayer=function(r,o,i,a){void 0===o&&(o=function(){}),void 0===i&&(i=function(){}),void 0===a&&(a=function(){}),window.location.host.toLowerCase().match(t.whiteListRegex)?(e.Logger.log("in epom WL"),t.setEpomAdsGlobals(r),e.Common.Res.injectScript(t.EPOM_URL).then(function(){try{window.addEventListener("message",function(t){try{var r=t.data;r&&"epom.video"===r.controller&&(r.action==n[n.AdImpression]&&o(),r.action==n[n.AdFinsihed]&&i(),r.action==n[n.AdError]&&a())}catch(s){e.Logger.error("Epom event exception: "+s)}})}catch(t){e.Logger.error("Epom exception: "+t)}})):e.Logger.log("not in epom WL")},t.whiteListRegex=/facebook\.com|pinchofyum\.com|nationalreview\.com|chicagotribune\.com|sheknows\.com|cnn\.com|realitysteve\.com|pandora\.com|comcast\.net|coolmath-games\.com|cnn\.com|wikia\.com|foxnews\.com|kizi\.com|games\.com|answers\.com|drudgereport\.com|jvlink\.net|softonic\.com|rotoworld\.com|ibtimes\.com|nytimes\.com|forexguidebook\.com|objectpatterns\.com|chicagotribune\.com|diply\.com|ustream\.tv|examiner\.com|recipejournals\.com|cbslocal\.com|floralclassic\.com|binkiland\.com|backpage\.com|fps-pb\.com|homepage-web\.com/,t.EPOM_URL="//ecpmrocks.com/js/show_ads_epmads.js?pubId=10540",t}();t.Epom=r}(n=t.Video||(t.Video={}))}(t=e.ExternalApi||(e.ExternalApi={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(t){function n(e,n){t.call(this,e,n),this.publisher="epom"}return __extends(n,t),n.prototype.afterRender=function(t){e.Logger.log("Requesting video:"),e.ExternalApi.Video.Epom.injectPlayer(this.model.videoContainerId,this.onVideoShow,this.onVideoFinished,this.onError)},n}(t.VideoDisplayHandlerBase);t.EpomVideoDisplayHandler=n}(t=e.DisplayHandlers||(e.DisplayHandlers={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(){function r(){this.isLazy=!1,this.element=null,this.model=null}return r.prototype.realEstate=function(){return n.VisualRealEstate.RIGHT_PANEL},r.prototype.flag=function(){return"VideoAds"},r.prototype.getLegacySuspension=function(e){var n=t.Col.of(t.Extras.LegacyTranslationTable.suspendIds).first(function(t){return t.nwp==e}),r=n?n.old:"suspend_"+e;return r},r.prototype.determineNeededItemCount=function(e){return null},r.prototype.declareResourcesPromise=function(e){return{templates:t.Common.Res.bring(e.paths().innerResourcesRoot()+"/Resources/templates.html"),css:t.Common.Res.injectCss2(e.paths().innerResourcesRoot()+"/Resources/videoRightSlider.css")}},r.prototype.draw=function(r,o,i){var a=this,s=o.Video,u=s.context,c=i.templates,l=e.$(c);t.Common.VisualHelper.appendToBody(l);var d=n.VisualRealEstate[this.realEstate()],p=this.getLegacySuspension(d),f=new n.Model.VideoSliderModel(u,d,p);f.cssUrl=u.paths().innerResourcesRoot()+"/Resources/videoRightSlider.css",f.cssName="fo-right-sliderx";var g=this.declareDisplayHandlers(u,f),m=e.$("<div data-bind=\"template: 'video-slider-template-div'\"></div>"),h=m[0];t.Common.VisualHelper.appendToBody(m),f.postRenderHandler=function(e,n){t.Col.of(g).each(function(t){return t.afterRender(e,n)})},f.onClose=function(){t.Col.of(g).each(function(e){return e.remove&&e.remove()}),t.Common.DomProtect.safeRemove(a.element)};try{e.ko.applyBindings(f,h),t.Logger.Analytics.notify(u,t.Logger.Analytics.GENERIC,{subtype:"postwo"},.01)}catch(v){throw t.Col.of(g).each(function(e){return e.remove&&e.remove()}),t.Common.DomProtect.safeRemove(m[0]),v}return this.element=h,this.model=f,t.resolve(n.DisplayState.Shown)},r.prototype.declareDisplayHandlers=function(e,n){var r=[new t.DisplayHandlers.EllipsisHandler,new t.DisplayHandlers.SuspendBoxHandler];return r},r.prototype.remove=function(e){},r}();r.VideoPanelVisual=o}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(e){this.context=e}return n.prototype.afterRender=function(n){var r=setInterval(function(){return e.$('[id^="'+t.Common.rot47("562=A=J")+"-"+t.Common.rot47("E@2DE")+'-"]').css("z-index",2147483640)},500);setTimeout(function(){return clearInterval(r)},2e4)},n}();n.OverlayHandler=r}(n=t.DisplayHandlers||(t.DisplayHandlers={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(n){var r=function(r){function o(i,a,s,u,c,l,d,p){var f=this;void 0===d&&(d=function(){}),void 0===p&&(p=!0),r.call(this,i,u,c),this.selectedTab=e.ko.observable(0),this.dealScroll=e.ko.observable(!1),this.hasCoupons=e.ko.observable(!1),this.hasCampaigns=e.ko.observable(!1),this.hasVideos=e.ko.observable(!1),this.hasTravels=e.ko.observable(!1),this.couponsMessage=e.ko.observable(""),this.moreDealsUrl=e.ko.observable(""),this.closeButtonVisible=e.ko.observable(!1),this.isShoppingbuddy=!1,this.modalTarget=e.ko.observable(),this.bodyRect=e.ko.observable(null),this.deals=e.ko.observable(null),this.visibleRows=3,this.isWindowOpen=e.ko.computed(function(){return null!=f.deals()}),this.isCapture=!1,this.strings=t.Common.LocaleHelper.getStringMapForCountry(i.countryCode(),t.Locale.sliderStrings),this.strings.attribution1="Powered by ",this.strings.deals_tab="Awesome Deals for You!",this.closeButtonVisible=e.ko.observable(p),this.deals(new n.DealsModel(s,a)),this.firstDeal=this.deals().offers[0];var g=function(){var n=f.context.scraper().getElementPosWithOffsets(e.$("body")[0]);f.bodyRect()&&t.Common.isEquivalent(n,f.bodyRect())||f.bodyRect(n)};g(),window.setInterval(g,1e3),this.modalTarget(e.$("body")),this.windowPosition=e.ko.computed(function(){return f.bodyRect(),o.calcModalPosition(f.modalTarget().get(0))}),this.hasDeals=e.ko.computed(function(){return f.deals()&&f.deals().offers.length>0}),this.setModalMaxHeight(i,this.visibleRows),this.closeButtonVisible()||window.setTimeout(this.showCloseButton,1e4)}return __extends(o,r),o.prototype.shoppingBuddyOnClick=function(e,t){},o.prototype.hide=function(){this.dismissWindow()},o.prototype.showCloseButton=function(){this.closeButtonVisible(!0)},o.prototype.dismissAndPop=function(e,t){this.hide(),e.onClick(e,t)},o.prototype.dismissWindow=function(){this.deals(null)},o.prototype.setModalMaxHeight=function(t,n){var r=10*(n-1),o=n*this.rowHeight();this.maxHeight=e.ko.computed(function(){return o+r})},o.prototype.rowHeight=function(){return 125},o.calcModalPosition=function(e){var n=t.Common.VisualHelper.getElementPosWithOffsets(e);if(n){var r=n.left+n.width/3,o=n.top+30;return{x:r,y:o}}return{x:0,y:0}},o}(n.ProductModelBase);n.LightBoxModel=r}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(){function r(){this.isLazy=!1,this.element=null}return r.prototype.realEstate=function(){return n.VisualRealEstate.LIGHTBOX},r.prototype.flag=function(){return"lb"},r.prototype.determineNeededItemCount=function(e){return new n.ItemCounts(3,3)},r.prototype.declareResourcesPromise=function(e){return{panel_css:t.Common.Res.injectCss2(e.paths().innerResourcesRoot()+"/Resources/lightBox.css"),templates:t.Common.Res.bring(e.paths().innerResourcesRoot()+"/Resources/templates.html")}},r.prototype.draw=function(r,o,i){var a=this,s=o.lightbox;s.data;var u=i.templates,c=e.$(u);t.Common.VisualHelper.appendToBody(c);var l=t.Col.of([new t.DisplayHandlers.EllipsisHandler,new t.DisplayHandlers.SuspendBoxHandler]),d=e.$("<div data-bind='template: \"lightbox-template\"'></div>"),p=d[0];this.element=p,t.Common.VisualHelper.appendToBody(d);var f=n.VisualRealEstate[this.realEstate()],g=this.getOldSuspensionIdentifer(),m=function(){l.each(function(e){return e.remove&&e.remove()}),t.Common.DomProtect.safeRemove(a.element)};n.Logic.LightBoxLogic.markShown(s.context);var h=new n.Model.LightBoxModel(s.context,s.data,s.context,f,g,this.visibleRows(),m);return h.cssUrl=s.context.paths().innerResourcesRoot()+"/Resources/lightBox.css",h.cssName="fo-modal-panel",h.postRenderHandler=function(e,t){l.each(function(n){return n.afterRender(e,t)})},e.ko.applyBindings(h,p),t.resolve(n.DisplayState.Shown)},r.prototype.remove=function(e){t.Common.DomProtect.safeRemove(this.element)},r.prototype.visibleRows=function(){return 3},r.prototype.getOldSuspensionIdentifer=function(){return"forb"},r}();r.LightBoxVisual=o}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(n){var r=function(){function n(n,r,o){var i=this;void 0===o&&(o=function(){}),this.heightNum=109,this.height=this.heightNum+"px",this.bottom=e.ko.observable("0px"),this.context=n,this.snippet=e.ko.observable(r),this.closeButtonVisible=e.ko.observable(!0),this.hasDeals=e.ko.computed(function(){
return i.snippet&&i.snippet.length>0}),t.stableAddEventListener(function(){var t=e.$(document).height()-(e.$(window).scrollTop()+e.$(window).height()),n=t-i.heightNum;n>0&&(n=0),i.bottom(n+"px")},"scroll",50)}return n.prototype.hide=function(){this.dismissWindow()},n.prototype.showCloseButton=function(){this.closeButtonVisible(!0)},n.prototype.dismissWindow=function(){this.snippet(null)},n}();n.FooterModel=r}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(){function r(){this.isLazy=!1,this.element=null}return r.prototype.realEstate=function(){return n.VisualRealEstate.LIGHTBOX},r.prototype.flag=function(){return"footer"},r.prototype.determineNeededItemCount=function(e){return new n.ItemCounts(3,3)},r.prototype.declareResourcesPromise=function(e){return{panel_css:t.Common.Res.injectCss2(e.paths().innerResourcesRoot()+"/Resources/footer.css"),templates:t.Common.Res.bring(e.paths().innerResourcesRoot()+"/Resources/footerTemplates.html")}},r.prototype.draw=function(r,o,i){var a=this,s=i.templates,u=e.$(s);t.Common.VisualHelper.appendToBody(u);var c=e.$("<div data-bind='template: \"footer-template\"'></div>"),l=c[0];this.element=l,t.Common.VisualHelper.appendToBody(c);var d=function(){t.Common.DomProtect.safeRemove(a.element)},p=o.footer,f=new n.Model.FooterModel(p.context,p.snippet,d);return e.ko.applyBindings(f,l),t.resolve(n.DisplayState.Shown)},r.prototype.remove=function(e){t.Common.DomProtect.safeRemove(this.element)},r}();r.FooterVisual=o}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(){function r(){this.isLazy=!1,this.element=null}return r.prototype.realEstate=function(){return n.VisualRealEstate.LIGHTBOX},r.prototype.flag=function(){return"lb"},r.prototype.determineNeededItemCount=function(e){return new n.ItemCounts(3,3)},r.prototype.declareResourcesPromise=function(e){return{panel_css:t.Common.Res.injectCss2(e.paths().innerResourcesRoot()+"/Resources/lightBox.css"),templates:t.Common.Res.bring(e.paths().innerResourcesRoot()+"/Resources/templates.html")}},r.prototype.draw=function(r,o,i){var a=this,s=o.lightbox,u=i.templates,c=e.$(u);t.Common.VisualHelper.appendToBody(c);var l=t.Col.of([new t.DisplayHandlers.EllipsisHandler,new t.DisplayHandlers.SuspendBoxHandler]),d=e.$("<div data-bind='template: \"lightbox-template\"'></div>"),p=d[0];this.element=p,t.Common.VisualHelper.appendToBody(d);var f=n.VisualRealEstate[this.realEstate()],g=this.getOldSuspensionIdentifer(),m=function(){l.each(function(e){return e.remove&&e.remove()}),t.Common.DomProtect.safeRemove(a.element)};n.Logic.LightBoxWebLogic.markShown(s.context);var h=!1,v=new n.Model.LightBoxModel(s.context,s.data,s.context,f,g,this.visibleRows(),m,h);return v.cssUrl=s.context.paths().innerResourcesRoot()+"/Resources/lightBox.css",v.cssName="fo-modal-panel",v.postRenderHandler=function(e,t){l.each(function(n){return n.afterRender(e,t)})},e.ko.applyBindings(v,p),t.resolve(n.DisplayState.Shown)},r.prototype.remove=function(e){t.Common.DomProtect.safeRemove(this.element)},r.prototype.visibleRows=function(){return 3},r.prototype.getOldSuspensionIdentifer=function(){return"forb"},r}();r.LightBoxWebVisual=o}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r=function(r){function o(e,n,o,i){void 0===o&&(o=0),void 0===i&&(i=2),r.call(this,e,n),this.imagesForWordIntersection=[],this.primaryImage=null,this.imageHowMany=i,this.imageStartFrom=o,this.imagesForWordIntersection=t.Common.ImageUtils.findValidImagesBySize(0,4,!1)}return __extends(o,r),o.prototype.generateData=function(r,o,i){var a=o.overrides().value("commerce-context",null),s=new e.NWPLegacy,u=t.Common.ScrapingLogics.imageScrapeLogicWithSupporting(o,r,this.imagesForWordIntersection),c={wordCounts:u,price:s.PriceUtils.getPrice(r),source:"api-ribbon"},l=n.OffersApi.queryFromData(o,c);return n.OffersApi.queryApi(o,i.totalCount(),a,l).then(function(e){return n.OffersApi.dealsFromOffers(o,e.offers)})},o.prototype.hasData=function(){return!0},o.prototype.genValidImages=function(){return t.Common.ImageUtils.findValidImagesBySize(this.imageStartFrom,this.imageHowMany,!0)||[]},o}(n.StubDataResult);n.RibbonImageDealGenerator=r}(n=t.Data||(t.Data={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(n){var r=function(e){function n(n,r,i){e.call(this,n,r),this.displayWindowOffers=[],this.ribbonOffers=t.StaticCol.select(r,function(e){return new o(n,e)}),this.offers=this.ribbonOffers,this.displayWindowOffers=t.StaticCol.select(i,function(e){return new o(n,e)}),this.context=n}return __extends(n,e),n}(n.GenericOffersModel);n.RibbonOffersModel=r;var o=function(t){function n(n,r){t.call(this,n,r),this.zoomVisible=e.ko.observable(!1)}return __extends(n,t),n.prototype.hideZoom=function(e,t){t.stopPropagation(),e.zoomVisible(!1)},n.prototype.zoomIntoOffer=function(e,n){n.stopPropagation(),t.prototype.hoverStart.call(this,e,n),e.zoomVisible(!0)},n.prototype.zoomOutOfOffer=function(e,n){n.stopPropagation(),t.prototype.hoverEnd.call(this,e,n),e.zoomVisible(!1)},n}(n.DealModel);n.RibbonOfferModel=o}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=t.Common.RibbonSize,i=function(){function r(){}return r.prototype.initDataLoop=function(t,n){var r=this;this.scrapeAndSetDataForView(t,n);var o=0;window.setInterval(function(){var i=e.$(window).scrollTop();i===o?r.scrapeAndSetDataForView(t,n):window.setTimeout(function(){o=e.$(window).scrollTop()},500),o=i},1e3)},r.prototype.scrapeAndSetDataForView=function(e,n){var r=t.Common.ImageUtils.findValidImagesBySize(0,1,!0);this.createDataForImage(e,r,0,n)},r.prototype.createDataForImage=function(r,o,i,a){var s=this;if(!(i>=o.length)){var u=o[i],c=a.getImageData(u);c?c.primaryWhen=t.now():(c={image:u,jqImage:e.$(u),size:t.Common.ImageUtils.imageSizeToRibbonSize(u.height),primaryWhen:t.now(),dealsPromise:r.generateData(u,r.context,new n.ItemCounts(4,8)),ribbonCreated:!1},a.setImageData(c),c.dealsPromise.then(function(e){return 0==e.length&&s.createDataForImage(r,o,i+1,a)}))}},r}(),a=function(){function e(){this.currentPrimaryImage=null}return e.prototype.initDrawLoop=function(e,t,n){var r=this;this.drawRibbonsForView(e,t,n),window.setInterval(function(){return r.drawRibbonsForView(e,t,n)},1e3),window.setInterval(function(){return t.updateRibbonPositionIfNeeded()},1e3)},e.prototype.drawRibbonsForView=function(e,n,r){var o=t.Col.of(r.data).where(function(e){return e.dealsPromise.getStatus()==t.Status.Resolved&&e.dealsPromise.getResult().length>0&&e.jqImage.is(":visible")}),i=o.orderByDesc(function(e){return e.primaryWhen});if(0!=i.length()){var a=i.getItem(0);null!=this.currentPrimaryImage&&this.currentPrimaryImage===a.image||(this.currentPrimaryImage=a.image,a.ribbonCreated?(t.Logger.info("Primary Image has a ribbon visual, updating primary ribbon"),n.updatePrimaryRibbon(a.image)):(t.Logger.info("Primary Image DOESN'T have ribbon visual, drawing new one"),a.ribbonCreated=!0,n.createNewRibbon(a)))}},e}(),s=function(n){function s(t,o,s){n.call(this,t.context,o,s),this.displayWindowRibbon=e.ko.observable(),this.currentBodyRect=null,this.displayedCount=0,this.context=t.context,this.ribbonModels=e.ko.observableArray();var u=new r.MemoryImageContainer;this.dataGenerator=new i,this.dataGenerator.initDataLoop(t,u),this.drawGenerator=new a,this.drawGenerator.initDrawLoop(t.context,this,u)}return __extends(s,n),s.prototype.addRibbon=function(e){this.ribbonModels.push(e)},s.prototype.createNewRibbon=function(e){var n=new u(this.context,e.dealsPromise.getResult(),e.image,e.size);this.addRibbon(n),this.updatePrimaryRibbon(e.image),t.Logger.notifyImpression(this.context,{size:o[e.size]})},s.prototype.updatePrimaryRibbon=function(e){var n=this;t.Col.of(this.ribbonModels()).each(function(r){r.ribbonVisible(r.imageToDrawOn==e),r.imageToDrawOn==e&&(n.primaryRibbon=r,r.displayedOnce||(r.displayedOnce=!0,n.displayedCount++,t.Logger.notifyPageRibbons(n.context,n.displayedCount)))})},s.prototype.updateRibbonPositionIfNeeded=function(){if(this.primaryRibbon){var n=this.context.scraper().getElementPosWithOffsets(e.$("body")[0]);this.currentBodyRect?t.Common.isEquivalent(n,this.currentBodyRect)||(this.primaryRibbon.updateImageRect(),this.currentBodyRect=n):(this.currentBodyRect=n,this.primaryRibbon.updateImageRect())}},s}(r.ProductModelBase);r.RibbonModelX9=s;var u=function(){function n(n,o,i,a){var s=this;this.offersModel=e.ko.observable(),this.displayedOnce=!1,this.childZoomVisible=e.ko.computed(function(){return s.offersModel()&&t.Col.of(s.offersModel().ribbonOffers).any(function(e){return e.zoomVisible()})}),this.context=n,this.imageToDrawOn=i,this.ribbonVisible=e.ko.observable(!1),this.ribbonValid=e.ko.observable(!0),this.imageRect=e.ko.observable(n.scraper().getElementPosWithOffsets(i));var u=r.RibbonProperties.getDimensions(a),c=this.calculateNumOfPresentedDeals(u,this.imageRect,o);t.Logger.info("Displaying:  "+c+" offers in ribbon out of available: "+o.length),this.offers=e.ko.computed(function(){return o.slice(0,c)},this),this.displayWindowOffers=e.ko.observableArray(o);var l=this.offers()?new r.RibbonOffersModel(n,this.offers(),this.displayWindowOffers()):new r.RibbonOffersModel(null,[],[]);this.offersModel(l),this.ribbonDimensions=this.calculateRibbonDimensions(c,u),this.strings=t.Common.LocaleHelper.getStringMapForCountry(n.countryCode(),t.Locale.sliderStrings),this.ribbonSize=r.RibbonProperties.ribbonSizeToString(a),this.displayWindowVisible=e.ko.observable(!1),this.ribbonPosition=e.ko.computed(function(){return s.calculatePositionsByImage()}),this.displayWindowPosition=e.ko.computed(function(){return s.chooseBestPosition()}),t.Logger.info("Ribbon Position: "+JSON3.stringify(this.ribbonPosition())),t.Logger.info("Ribbon Dimensions: "+JSON3.stringify(this.ribbonDimensions))}return n.prototype.updateImageRect=function(){this.imageRect(this.context.scraper().getElementPosWithOffsets(this.imageToDrawOn))},n.prototype.calculatePositionsByImage=function(){return this.imageRect()&&this.imageRect().top&&this.imageRect().right||this.ribbonValid(!1),{top:this.imageRect().top,left:this.imageRect().right}},n.prototype.hideDisplayWindow=function(){this.displayWindowVisible(!1)},n.prototype.showDisplayWindow=function(){this.displayWindowVisible(!0)},n.prototype.calculateNumOfPresentedDeals=function(e,t,n){var r=Math.max(1,Math.floor(t().height/e.height)),o=3,i=Math.max(r,o),a=Math.min(i,n.length);return a},n.prototype.calculateRibbonDimensions=function(e,t){return{width:t.width,height:e*t.height}},n.prototype.chooseBestPosition=function(){var e=80,n=515,r=205,o=2,i={left:this.ribbonPosition().left+this.ribbonDimensions.width+10,top:this.imageRect().top,width:n,height:e+r*o};return t.Logger.info("Image rect:"+this.imageRect()),t.Logger.info("Display Window rect:"+i),i.left+i.width>window.innerWidth?this.imageRect().top+this.imageRect().height+i.height+10>window.innerHeight+window.pageYOffset&&this.imageRect().top-i.height-10-window.pageYOffset<0?this.imageRect().left-i.width-10<0?i.left>window.innerWidth-n-10&&(i.left=window.innerWidth-n-10):i.left=this.imageRect().left-i.width-10:(this.imageRect().left+this.imageRect().width/2-i.width/2+i.width<window.innerWidth?i.left=this.imageRect().left+this.imageRect().width/2-i.width/2:i.left=window.innerWidth-(10+i.width),this.imageRect().top+this.imageRect().height+i.height+10>window.innerHeight+window.pageYOffset?i.top=this.imageRect().top-i.height-10:i.top=this.imageRect().top+this.imageRect().height+10):this.imageRect().top+i.height+10>window.innerHeight+window.pageYOffset&&(i.top=window.pageYOffset+window.innerHeight-(10+i.height)),i},n}()}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(){function r(){this.isLazy=!1,this.element=null}return r.prototype.realEstate=function(){return n.VisualRealEstate.IMAGE_RIGHT},r.prototype.flag=function(){return"rbc"},r.prototype.remove=function(e){t.Common.DomProtect.safeRemove(this.element)},r.prototype.visibleRows=function(){return 3},r.prototype.determineNeededItemCount=function(e){return new n.ItemCounts(4,8)},r.prototype.declareResourcesPromise=function(e){return{combinedCss:t.Common.Res.injectCss2(e.paths().innerResourcesRoot()+"/Resources/combinedRibbon.css"),fa_css:t.Common.Res.injectCss2("//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"),ribbonTemplatesHtml:t.Common.Res.bring(e.paths().innerResourcesRoot()+"/Resources/ribbonTemplates7.html")}},r.prototype.getOldSuspensionIdentifer=function(){return"forb"},r.prototype.draw=function(r,o,i){var a=o.Deals,s=e.$(i.ribbonTemplatesHtml);t.Common.VisualHelper.appendToBody(s);var u=null,c=a.context.overrides().boolValue("ribbon.useiframe",!1);u=c?e.$("<div data-bind=\"template: 'ribbon-contained-template'\"></div>"):e.$("<div data-bind=\"template: 'ribbon-x-template'\"></div>"),t.Common.VisualHelper.appendToBody(u);var l=u[0];try{var d=n.VisualRealEstate[this.realEstate()],p=this.getOldSuspensionIdentifer(),f=new n.Model.RibbonModelX9(a,d,p);f.cssUrls=["//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css",a.context.paths().innerResourcesRoot()+"/Resources/combinedRibbon.css"];var g=[new t.DisplayHandlers.AfterRenderImpression(a.context),new t.DisplayHandlers.SuspendBoxHandler];f.postRenderHandler=function(e,n){t.Col.of(g).each(function(t){return t.afterRender(e,n)})},e.ko.applyBindings(f,l)}catch(m){throw t.Common.DomProtect.safeRemove(l),m}return t.resolve(n.DisplayState.Shown)},r}();r.RibbonX9=o}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.declareDisplayHandlers=function(t){var r=n.prototype.declareDisplayHandlers.call(this,t),o=new e.DisplayHandlers.ScrollHandler(t);return r.push(o),r},r.prototype.config=function(){var e="contentRightSlider.css",n="content-right-slider-div-template";return{realEstate:t.VisualRealEstate.RIGHT_PANEL,flag:"crs",rootTemplate:n,rootCssFile:e,rootCssClass:"fo-right-sliderx",appendFirst:!1,primaryItemCount:4,secondaryItemCount:8}},r.prototype.visibleItems=function(){return 3},r.prototype.draw=function(e,t,r){return n.prototype.draw.call(this,e,t,r)},r}(n.GenericPanelVisual);n.ContentVisual=r}(n=t.Visual||(t.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(r){function o(){r.apply(this,arguments)}return __extends(o,r),o.prototype.declareDisplayHandlers=function(e){var n=r.prototype.declareDisplayHandlers.call(this,e),o=new t.DisplayHandlers.ScrollHandler(e);return n.push(o),n},o.prototype.config=function(){var e="contentLeftSlider.css",t="content-right-slider-div-template";return{realEstate:n.VisualRealEstate.LEFT_PANEL,flag:"crs",rootTemplate:t,rootCssFile:e,rootCssClass:"fo-left-sliderx",appendFirst:!1,primaryItemCount:4,secondaryItemCount:8}},o.prototype.visibleItems=function(){return 3},o.prototype.draw=function(n,o,i){var a=r.prototype.draw.call(this,n,o,i);return 1==t.Flags.flag(t.Flags.Content.SLIDER_VER)&&a.then(function(){window.setTimeout(function(){e.$(".fo-right-sliderx.fo-container").css({top:"inherit"})},1e4)}),a},o}(r.GenericPanelVisual);r.ContentVisualLeft=o}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.config=function(){var t=e.prototype.config.call(this);return t.rootCssFile="strictContentRightSlider.css",t},t}(e.ContentVisual);e.StrictContentVisual=t}(t=e.Visual||(e.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.config=function(){var t="contentRightBar.css",n="content-right-slider-div-template";return{realEstate:e.VisualRealEstate.RIGHT_PANEL,flag:"crs",rootTemplate:n,rootCssFile:t,rootCssClass:"fo-right-sliderx",appendFirst:!1,primaryItemCount:5,secondaryItemCount:8}},n.prototype.visibleItems=function(){return 5},n}(t.RightBarY);t.ContentBarVisual=n}(t=e.Visual||(e.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(r){function o(){r.apply(this,arguments),this.isLazy=!1}return __extends(o,r),o.prototype.declareResourcesPromise=function(e){return{panel_css:t.Common.Res.injectCss2(e.paths().innerResourcesRoot()+"/Resources/inImageCampaign.css"),templates:t.Common.Res.bring(e.paths().innerResourcesRoot()+"/Resources/templates.html")}},o.prototype.flag=function(){return"iic"},o.prototype.bindModel=function(t,r,o,i,a,s,u,c){var l=new n.Model.MultiInImageCampaignModel(t,r,o,i,a,s,u);e.ko.applyBindings(l,c)},o.prototype.dataKey=function(){return"Campaigns"},o}(r.InImageVisualBase);r.InImageCampaignVisual=o}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){this.isLazy=!1}return n.prototype.realEstate=function(){return t.VisualRealEstate.EXTERNAL_CALLBACK_1},n.prototype.flag=function(){return"cb"},n.prototype.determineNeededItemCount=function(e){return new t.ItemCounts(4,10)},n.prototype.declareResourcesPromise=function(t){return{dummy:e.resolve(null)}},n.prototype.draw=function(n,r,o){var i=r.CommerceDeals,a=r.Coupons,s=e.flag(e.Flags.CALLBACK.CALLBACK_FUNCTION_NAME);try{var u=e.Col.of(i.data).select(function(e){return{discount:e.discount,freeShipping:e.freeShipping,merchantName:e.merchantText,merchantThumbUrl:e.merchantThumb,originalPrice:e.originalPrice,price:e.price,title:e.title,thumbUrl:e.thumb,clickUrl:e.url}}).toArray(),c=a?a.data:[];window[s]&&window[s]({deals:u,coupons:c}),e.Logger.info("Deals: "+JSON.stringify(u)+"\nCoupons: "+JSON.stringify(c))}catch(l){e.Logger.warn("exeption in callBackFn: "+l)}return e.resolve(t.DisplayState.Shown)},n.prototype.remove=function(e){},n}();n.CallbackVisual=r}(n=t.Visual||(t.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(n){var r=function(){function r(r,i,a,s,u,c,l,d,p,f){var g=this;this.inTextModel=e.ko.observable(),this.currentTarget=e.ko.observable(),this.bodyRect=e.ko.observable(null),this.isShoppingbuddy=!1,this.notifiedOnce=!1;var m=this;this.context=r,this.inTextOnClose=function(){g.inTextModel().position&&g.inTextModel().position.dispose(),s()};var h=function(){var n=g.context.scraper().getElementPosWithOffsets(e.$("body")[0]);m.bodyRect()&&t.Common.isEquivalent(n,m.bodyRect())||m.bodyRect(n)};window.setInterval(h,1e3),h();var v=new o(this.context,i,a,this.inTextOnClose,this.currentTarget,this.bodyRect);v.cssUrl=u,v.cssName=c,v.postRenderHandler=l,v.selectedTab(2),this.inTextModel(v),this.inTextModel().aboutTooltip=p,this.inTextModel().logo=f;var y=t.Common.EventUtils.getClickEventName();t.Col.of(e.$("span.FO_hovarable_search_text").toArray()).each(function(t){e.$(t).mouseenter(function(o){d(e.$(t).text(),r).then(function(r){g.changeTargetEl(t),g.inTextModel().campaigns(new n.CampaignsModel(g.context,[r]));var o=e.$(".fo-in-text-panel .search-in-text-offer-template-inner")[0],i=o.offsetWidth+150,a=o.parentElement.parentElement.parentElement;a.style.width=i+"px"})}),e.$(t).bind(y,function(e){g.inTextModel().campaigns().offers[0].onClick(g.inTextModel().campaigns().offers[0],e)})}),e.$("body").click(function(e){return g.checkClose(e)}),e.$(window).blur(function(){return g.inTextModel().hide()})}return r.prototype.shoppingBuddyOnClick=function(e,t){},r.prototype.changeTargetEl=function(n){this.inTextModel().setNewTarget(e.$(n)),this.notifiedOnce||(this.notifiedOnce=!0,t.Logger.Analytics.notify(this.context,t.Logger.Analytics.IMPRESSION))},r.prototype.checkClose=function(e){this.inTextModel().hide()},r}();n.MultiInTextModelBase=r;var o=function(n){function r(o,i,a,s,u,c){var l=this;n.call(this,o,i,a,s),this.selectedTab=e.ko.observable(0),this.campaigns=e.ko.observable(),this.deals=e.ko.observable(),this.hasDeals=e.ko.computed(function(){return l.deals()&&l.deals().offers.length>0}),this.dealScroll=e.ko.observable(!1),this.hasCoupons=e.ko.observable(!1),this.hasCampaigns=e.ko.computed(function(){return l.campaigns()&&l.campaigns().offers.length>0}),this.hasVideos=e.ko.observable(!1),this.hasTravels=e.ko.observable(!1),this.moreDealsUrl=e.ko.observable(""),this.isShoppingbuddy=!1,this.couponsMessage=e.ko.observable(""),this.hasThingsToShow=e.ko.computed(function(){return l.hasCampaigns()||l.hasDeals()}),this.closeButtonVisible=e.ko.observable(!0),this.data=e.ko.observable(null),this.maxHeight=e.ko.observable(200),this.isTargetHovered=e.ko.observable(!1),this.suspendTarget.closeFn=this.onClose,this.targetEl=u,this.hide=function(){l.campaigns(null)},this.bodyRect=c,this.strings=t.Common.LocaleHelper.getStringMapForCountry(o.countryCode(),t.Locale.sliderStrings),this.position=e.ko.computed(function(){return l.isTargetHovered(),l.bodyRect(),r.calcPosition(o,l.targetEl())}),this.targetRect=e.ko.computed(function(){l.isTargetHovered(),l.bodyRect();var e=l.targetEl();return e?t.Common.VisualHelper.getElementPosWithOffsets(e):{top:0,left:0,width:0,height:0,bottom:0,right:0}})}return __extends(r,n),r.prototype.shoppingBuddyOnClick=function(e,t){},r.prototype.setNewTarget=function(e){this.targetEl(e)},r.calcPosition=function(e,n){var r=e.fnWindow().getComputedStyle(e.fnWindow().document.body).getPropertyValue("margin-left");if(!n)return{x:0,y:0};var o=n.find(".FO_FirstWord");0==o.length&&(o=n);var i=t.Common.VisualHelper.getElementPosWithOffsets(o[0]);if(i){var a=i.left+i.width/2-parseFloat(r),s=i.top+i.height/2;return{x:a,y:s-55}}return{x:0,y:0}},r}(n.ProductModelBase);n.SingleInTextModelBase=o}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(t){var n=function(){function t(e){this.tooltips=e}return t.prototype.afterRender=function(t){var n=this;t=t,e.$("body").click(function(e){return n.checkCloseTooltipBox(e,t)});for(var r in this.tooltips)t.find(this.tooltips[r]).click(function(e){return n.openTooltipBox(e,t,n.tooltips[r])})},t.prototype.openTooltipBox=function(e,t,n){t.find(n).find(".fo-tooltip").addClass("shown"),e.stopPropagation()},t.prototype.checkCloseTooltipBox=function(t,n){var r=e.$(t.target).closest(".fo-tooltip").length>0;r||this.closeTooltipBox(t,n)},t.prototype.closeTooltipBox=function(e,t){t.find(".fo-tooltip").removeClass("shown"),e.stopPropagation()},t}();t.TooltipHandler=n}(n=t.DisplayHandlers||(t.DisplayHandlers={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(){function r(){this.isLazy=!1,this.element=null,this.invalidElements=["script"]}return r.prototype.realEstate=function(){return n.VisualRealEstate.IN_TEXT_VISUAL},r.prototype.flag=function(){return"intextsch"},r.prototype.remove=function(e){t.Common.DomProtect.safeRemove(this.element)},r.prototype.determineNeededItemCount=function(e){return new n.ItemCounts(0,0)},r.prototype.declareResourcesPromise=function(e){return{combinedCss:t.Common.Res.injectCss2(e.paths().innerResourcesRoot()+"/Resources/inTextSearch.css"),templates:t.Common.Res.bring(e.paths().innerResourcesRoot()+"/Resources/templates.html")}},r.prototype.getOldSuspensionIdentifer=function(){return"intext"},r.prototype.draw=function(r,o,i){var a=this,s=o.intextsch;if(!s.extras.hasFeeds)return t.resolve(n.DisplayState.NoShow_ZeroResults);var u=s.extras.query;this.drawSpansOnPage(u);var c=t.Col.of([new t.DisplayHandlers.SuspendBoxHandler,new t.DisplayHandlers.TooltipHandler([".fo-about"])]),l=i.templates,d=e.$(l);t.Common.VisualHelper.appendToBody(d);var p=e.$("<div data-bind='template: \"in-text-wrapper-template\"'></div>"),f=p[0];this.element=f,t.Common.VisualHelper.appendToBody(p);var g=function(){c.each(function(e){return e.remove&&e.remove()}),t.Common.DomProtect.safeRemove(a.element)},m=n.VisualRealEstate[this.realEstate()],h=this.getOldSuspensionIdentifer(),v=s.context.paths().innerResourcesRoot()+"/Resources/inTextSearch.css",y="fo-in-text-panel",C=function(e,t){c.each(function(n){return n.afterRender(e,t)})},S={tooltipText:s.extras.aboutText};S.tooltipText||(S=null);var b={bing:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG4AAABuCAIAAABJObGsAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkOTNkZDc1Ni1lMDY2LTQ5NjUtYWNhMi1iMDdjMjZiM2MxOWEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QzIyOTRFODFCNUZEMTFFNTgzNjA4QkQyMDA1NTVFMDYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QzIyOTRFODBCNUZEMTFFNTgzNjA4QkQyMDA1NTVFMDYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4MmI0MzBhMi01MzhlLTQzN2YtYjJkOC0wNjA5NmUyYjU4YmIiIHN0UmVmOmRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpjYjc1NDZhOC1mMzg5LTExNzgtYmQ4Ny1mNjRmYzZkMmFlNTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4r0XxFAAAF30lEQVR42uydfUxVZRzHv5d3EAYiCAgCcsEUkqRV5gwFa8XS1h8551q15aa0pdJg0RuWYJa1uaarZjJ7YVlrlQuUP7RNoyE1JQg3efOCIpfXyzt4gQvc2/NDImP4gueewznc33d3d5e7ew/P/Zzn5fd8n985j852Ciy7yIkRMEpGyShZjJJRMkpGyWKUjJJRshglo2SUjJKlLpRrG7H8cwSkwMnd0VDq7Gz9PmmbeDE2gI5TMJ2A6SRGOhmlBJSTslnRc46YtufDXMsoJaC8WQJlewFMBegpgW2MUUpAOSnR5E2FxFR0AqIrYJT3jnJSVguMh1GdxiO49P/vBp8HOBhiMUpGySgZJYtRMkpGyWKUjJJRMkqWxlHqXLSIUpWFXnkco/0w5ZObOdrLKCXImIuEAoQ8D9sIuorIIRaPwQaVo5xt61eouwgXkqaUCmsuYd7y/73Xf3GCaW8pYFMhSnUOOzZc+Xjqez7xiMrCqvNY14TYIwjcACdPrpV3rJXj7npiPdxDb/fFMTM6f6Uu1VQISzvXylvIakHDJ3f4jLMXFj6LuC+R1IpHSrDkTXjHcq1Mmo6UN9YZ4eI7s6OZ68bzGPLRXQzbKNfKG+13AI2fzfhbXnpEvIaHziKpHSuOIXjzjE/GHKyVQm5BWHsVTh7SxjCFIip1TxwtbWj+RnJtccWCJ7DsEBKvYnUFovfC92GKtxyrVlKDjcZjtfb/5cMtlBcmutTOM7AOOoadYTag7Wf7H9Y9BGHbkHASyR1Y+QtCX3YAlEJXPpLx4JMRlUOg7CtF1xn1F1MjfqWsFdOxUHaeRn8Fo3SUiqkdlK3fozSZnAtVOmzQ2NpO128o34hzseQNW4cYpWRdr0bldvwejrpsjHQwSulzShPq9qAoHJWpuF7DKCVLzPmMR1ASi/JnaAI6q3LBHJDNShNqnQu8YuC+iFFKkP96xHwA31VcKyXI91GC6J+shrJoFqVPPPQ55ESoRhpE6RWN6BwEb5HDvnUYlB6LEbUboVuhc1Zh6TSC0jUA+iyEpUpd55nLKEe6cTnrtgX0Q2Q6ItLhPE/lp3tWUQ42oCyFJoLTzx48EZGGyEy4zpc/1B/SMsr+cpRtoOWqaSC6IXQbZQi5BytRkrbjqE3XLMrO06jYREmUUyTGk5AXod8DzwgliiEaRPUuSjzSagNv/po8CKtlCkUEPUdRzpRcQJkkzmJ9DhoOUsKBVvvK+vdheHeqfRuQQpMWnwSFytDyLWozp+9btIHSZkXVK+Ta3qz5iYjeR88KddB/o2oneoq1PIJbB1Gxmfyb/2Z+CVj6IRY8pVzUZXiHHDnZbn+iCMqRDpQ9jd4LE3+K3lD0iUGbFGsORFBErzJb7vKjNBsoeDTX0WsxLuuzEfKCcjO/3j9R9Sr6yrQfoveep4Uti4lydJa8jcWplFemjCztNLY05ym2QiknStMJXNxCN2eL2Y+IXcpl4Yve8NohWkRT9pof2VAav0DtG4jIQGSGYnm3pK6zqN6Bgcq5Mgev30d9fKKBHB3FNNSImgy0/Thn7Awb3W9t0UvkLSom6zAaDtD5GzPPojljb5TWIfitUfQXmApRkzYRIcyq7L0O/seDlA6pjESYJcID8VABR9g/Fx3jafT63RT6yBc8ioYsmrNo1KJpq0Y6uTbU8luN+/NoScvuav0Bta/TIKMy6WTcm8zZG/cdQNh2ux1w4BKqd1K4o0rpZN/mLXAj4o7CbaGkg4z2oe49XPtU4WvtVIZSyC0Qsbn3vvzf9BUuv0WXQ6lbOuU2HwzdimUHqdXfvfr+QtUOsiS0IJ2i+zh6RmFF3l0FniOdVBObjpJhrBHplN4SU0RIkZmIzr6lRSTYGQ/DkEVmraakm53dRX0SEH9smhWxnmJq0aq/rkRNKGme5YGl+xH+772nh1soWmz5TrUXQKgY5Q35P464XLT9hPq90yyLM0rHFN+TjVEySkbJYpSMklEyShajZJSMksUoGSWjZJQsRqkW/SPAAMRRAeXeTyL5AAAAAElFTkSuQmCC')","default":"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEMAAAA8CAIAAACy3JAwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAH3SURBVGhD7Ze9jQIxEIWpgOAycjJEikREA9RBRCNEVEEBF5CfRBn0gm6B94Rn/LP2nhADN5+eRMAO68/2eJfR5Wf1pjlJRpfvrzcNDIibGAgMiJsYCAxIZBIdEWYDA+ImBgID4iYGAgPiJgYCA+ImBgID4iYGAgPiJgYCA+ImtxzXo5jNTl+WyXyDioDZ9KwvywYGZKBJ0iGk6JNyCKnzgQEZYNI3DrLcLqLa1eUwXeL7MuP9IaqVgQFpNVnsZ7hVBfFoamfhxuQoanVgQNpMztsx7gL0WPWuW89L3+qxRp6yXAUGpMlE3ilzG2kbjrWqXNqWlgUGpMVkN8HvXyncAztQN31YXuppIVw4OWBAGkzC2Up3czH15WJV8xsMBmSgSfVD45GG8nD1nmASnloNhxIHXS6XqduHMCD/0aS8PZpMXry7RCNGLdtr0tDx4ZVPMRFTVTzpQ+fH9NeWP/8U1hOf38FpE/XG9cono35+X9FzFr0ghhfIUXbI1o9fLvNbqwsMSJuJatwK1DGVbacUpQXpAgPSatKlfjSpoZh5q0eifaIpnk69C9uzGvfAgAw0uSdum5q5ZFI+df8W74EB+ZPJawMD4iYGAgPiJgYCA+ImBgID4iYGAgPiJgYCA+ImBgID4iYGAgPyQSb4fH/cxB6fYnI6/QIXTTvINeBL4gAAAABJRU5ErkJggg==')"},w=b[s.extras.logo];w||(w=b["default"]);var _=new n.Model.MultiInTextModelBase(s.context,m,h,g,v,y,C,s.generateLink.bind(s),S,w);return e.ko.applyBindings(_,this.element),t.resolve(n.DisplayState.Shown)},r.prototype.drawSpansOnPage=function(e){var n=t.flag(t.Flags.INTEXT.INTEXT_LIMIT),r={};t.Logger.log(e.toString()),this.findElementsByPhrases(e,r);for(var o=0,i=0;;i++){for(var a=o,s=0;s<e.length;s++){var u=r[e[s]];if(u&&u.length>i){if(o==n)return;var c=e[s].length,l=e[s].search("\\s|\\-");l=l==-1?c:l;var d=e[s].substring(0,l),p=e[s].substring(l,c),f=u[i],g=new RegExp("("+d+")("+p+")","gi");this.isElementValid(f,g)&&(o++,t.Logger.log("replacing: "+e[s]),f.innerHTML=f.innerHTML.replace(g,"<span class='FO_hovarable_search_text'><span class='FO_FirstWord'>$1</span>$2</span>"))}}if(a==o)break}},r.prototype.isElementValid=function(e,t){return this.invalidElements.indexOf(e.nodeName.toLocaleLowerCase())==-1&&e.innerHTML.search(t)>-1},r.prototype.findElementsByPhrases=function(n,r){for(var o=(new Date).getTime(),i=0;i<n.length;i++){var a=void 0;a=t.flag(t.Flags.INTEXT.RPL_VISIBLE_ONLY)?e.$("body").find(':Contains("'+n[i]+'"):visible'):e.$("body").find(':Contains("'+n[i]+'")'),a=[].filter.call(a,function(t){return"H1"!=t.tagName&&"A"!=t.tagName&&0==e.$(t).parents("h1,button,a").length&&0==e.$(t).children(":Contains("+n[i]+")").length&&"hidden"!=e.$(t).css("visibility")}),a.length>0&&(r[n[i]]=a)}t.Logger.info("Find elements took: "+((new Date).getTime()-o))},r}();r.InTextSearchVisual=o}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(r){function o(n,i,a){var s=this;void 0===a&&(a=function(){}),r.call(this,n,i,null),this.modalTarget=e.ko.observable(),this.bodyRect=e.ko.observable(null),this.visibleRows=1,this.strings=t.Common.LocaleHelper.getStringMapForCountry(n.countryCode(),t.Locale.sliderStrings);var u=function(){var n=s.context.scraper().getElementPosWithOffsets(e.$("body")[0]);s.bodyRect()&&t.Common.isEquivalent(n,s.bodyRect())||s.bodyRect(n)};u(),window.setInterval(u,1e3),
this.modalTarget(e.$("body")),this.windowPosition=e.ko.computed(function(){return s.bodyRect(),o.calcModalPosition(s.modalTarget().get(0))}),this.listenOnAdImpression(n)}return __extends(o,r),o.calcModalPosition=function(e){var n=t.Common.VisualHelper.getElementPosWithOffsets(e);if(n){var r=n.left+n.width/3,o=n.top+30;return{x:r,y:o}}return{x:0,y:0}},o.prototype.listenOnAdImpression=function(r){window.addEventListener("MnAdImp",function(o){n.Logic.LightBoxVideoLogic.markShown(),t.Logger.Analytics.notify(r,t.Logger.Analytics.IMPRESSION),e.$(".fo-lightbox-container-frame").css("left",0)},!0)},o.prototype.closeLightbox=function(e,t){t&&(t.stopPropagation(),t.cancelBubble=!0),r.prototype.hide.call(this)},o}(r.ProductModelBase);r.LightBoxVideoModel=o}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(){function r(){this.isLazy=!1,this.element=null}return r.prototype.realEstate=function(){return n.VisualRealEstate.LIGHTBOX},r.prototype.flag=function(){return"vlb"},r.prototype.determineNeededItemCount=function(e){return new n.ItemCounts(1,0)},r.prototype.declareResourcesPromise=function(e){return{panel_css:t.Common.Res.injectCss2(e.paths().innerResourcesRoot()+"/Resources/lightBoxVideo.css"),templates:t.Common.Res.bring(e.paths().innerResourcesRoot()+"/Resources/templates.html")}},r.prototype.draw=function(r,o,i){var a=this,s=o.lightbox,u=i.templates,c=e.$(u);t.Common.VisualHelper.appendToBody(c);var l=t.Col.of([]),d=e.$("<div data-bind='template: \"lightbox-video-template\"'></div>"),p=d[0];this.element=p,t.Common.VisualHelper.appendToBody(d);var f=n.VisualRealEstate[this.realEstate()],g=function(){l.each(function(e){return e.remove&&e.remove()}),t.Common.DomProtect.safeRemove(a.element)},m=new n.Model.LightBoxVideoModel(s.context,f,g);return m.cssUrl=s.context.paths().innerResourcesRoot()+"/Resources/lightBox.css",m.cssName="fo-modal-panel",m.postRenderHandler=function(e,t){l.each(function(n){return n.afterRender(e,t)})},e.ko.applyBindings(m,p),t.resolve(n.DisplayState.Shown)},r.prototype.remove=function(e){t.Common.DomProtect.safeRemove(this.element)},r}();r.LightBoxVideoVisual=o}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(r){function o(n,o,i,a){var s=this;r.call(this,n,o,i),this.deals=e.ko.observable(),this.coupons=e.ko.observable(),this.campaigns=e.ko.observable(),this.travels=e.ko.observable(),this.video=e.ko.observable(),this.closeButtonVisible=e.ko.observable(!0),this.hasDeals=e.ko.computed(function(){return s.deals()&&s.deals().offers.length>0}),this.hasCoupons=e.ko.computed(function(){return s.coupons()&&s.coupons().offers.length>0}),this.hasCampaigns=e.ko.computed(function(){return s.campaigns()&&s.campaigns().offers.length>0}),this.hasTravels=e.ko.computed(function(){return s.travels()&&s.travels().offers.length>0}),this.hasVideos=e.ko.computed(function(){return s.video&&s.video()&&s.video().hasVideo()}),this.videoDisabled=!0,this.selectedTab=e.ko.observable(0),this.dealsDisplayed=!1,this.couponsDisplayed=!1,this.campaignsDisplayed=!1,this.travelsDisplayed=!1,this.isShoppingbuddy=!1,this.visibleItems=e.ko.observable(0),this.moreDealsUrl=e.ko.observable("http://bestdealwiz.com/"),this.revealedCoupons=e.ko.computed(function(){return s.coupons()&&s.coupons().offers?t.Col.of(s.coupons().offers).count(function(e){return e.offer.revealed}):0}),this.couponsMessage=e.ko.observable(),this.cpnWiz=e.ko.observable(!1),this.cpnWizResult=e.ko.observable(),this.cpnWizTotalCoupons=e.ko.observable(0),this.cpnWizCuoponCode=e.ko.observable(),this.cpnWizCouponDiscount=e.ko.observable(),this.cpnWizProgressPhase=e.ko.observable(),this.cpnWizTotalCpnCount=e.ko.observable(),this.cpnWizCurrentCpnIndex=e.ko.observable(),this.cpnWizMeterProgress=e.ko.observable(0),this.dealScroll=e.ko.computed(function(){return s.deals()&&s.deals().offers.length>s.visibleItems()}),this.couponScroll=e.ko.computed(function(){return s.coupons()&&s.coupons().offers.length>s.visibleItems()}),this.setPanelMaxHeight(n,a),this.strings=t.Common.LocaleHelper.getStringMapForCountry(n.countryCode(),t.Locale.sliderStrings)}return __extends(o,r),o.prototype.subscribeToCatchFirstImpression=function(){},o.prototype.setPanelMaxHeight=function(t,n){this.visibleItems(t.overrides().intValue("panel.visible.items",n));var r=8*(this.visibleItems()-1),o=this.visibleItems()*this.itemHeight();this.maxHeight=e.ko.computed(function(){return o+r})},o.prototype.itemHeight=function(){return 125},o.prototype.selectTab=function(e,r){if(void 0===r&&(r=!0),this.selectedTab(e),r&&this.collapsed(!1),0==e&&!this.dealsDisplayed){this.dealsDisplayed=!0;var o=this.gatherSchemaStats();t.Logger.Analytics.notify(this.deals().context,t.Logger.Analytics.IMPRESSION,o)}if(1==e){n.Logic.CampaignsLogic.breakUrlIntoComponents(document.location.protocol+"//"+document.location.host,document.location.pathname);this.couponsDisplayed||(this.couponsDisplayed=!0,t.Logger.Analytics.notify(this.coupons().context,t.Logger.Analytics.IMPRESSION))}if(2==e&&!this.campaignsDisplayed){this.campaignsDisplayed=!0;for(var i=[],a=0;a<this.campaigns().offers.length;a++)i.indexOf(this.campaigns().offers[a].offer.campaignTitle)<0&&i.push(this.campaigns().offers[a].offer.campaignTitle);t.Logger.Analytics.notify(this.campaigns().context,t.Logger.Analytics.IMPRESSION,{cmpnimpr:i.join("|")})}3==e&&(this.travelsDisplayed||(this.travelsDisplayed=!0,t.Logger.Analytics.notify(this.travels().context,t.Logger.Analytics.IMPRESSION)))},o.prototype.gatherSchemaStats=function(){var e;return e="1"==this.deals().context.extraParams.og_exist?{kwds:this.deals().offers[0].offer.keywords,ogExist:this.deals().context.extraParams.og_exist,ogTitle:this.deals().context.extraParams.og_title,ogType:this.deals().context.extraParams.og_Type,ogFields:this.deals().context.extraParams.og_fields}:{kwds:this.deals().offers[0].offer.keywords,ogFields:this.deals().context.extraParams.og_exist}},o.prototype.initCouponWiz=function(){},o.prototype.cancelCouponWiz=function(){},o}(r.ProductModelBase);r.AsyncPanelModel=o}(r=n.Model||(n.Model={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(t){var n;!function(n){var r;!function(r){var o=function(){function r(){this.isLazy=!0,this.element=null,this.model=null}return r.prototype.config=function(){throw new Error("Config Not implemented")},r.prototype.realEstate=function(){return this.config().realEstate},r.prototype.flag=function(){return this.config().flag},r.prototype.determineNeededItemCount=function(e){var t=this.config().primaryItemCount,r=this.config().secondaryItemCount;if(t||r)return new n.ItemCounts(t||0,r||0);throw new Error("Item counts not implemented")},r.prototype.getParentElement=function(){return document.documentElement.getElementsByTagName("body")[0]},r.prototype.declareResourcesPromise=function(e){return{templates:t.Common.Res.bring(e.paths().innerResourcesRoot()+"/Resources/templates.html"),css:t.Common.Res.injectCss2(this.cssUrl(e))}},r.prototype.declareDisplayHandlers=function(e){var n=[new t.DisplayHandlers.EllipsisHandler,new t.DisplayHandlers.SuspendBoxHandler,new t.DisplayHandlers.CouponTextSelectHandler,new t.DisplayHandlers.AfterRenderImpression(e)];return n},r.prototype.cssUrl=function(e){return e.paths().innerResourcesRoot()+"/Resources/"+this.config().rootCssFile},r.prototype.getLegacySuspension=function(e){var n=t.Col.of(t.Extras.LegacyTranslationTable.suspendIds).first(function(t){return t.nwp==e}),r=n?n.old:"suspend_"+e;return r},r.prototype.draw=function(r,o,i){var a=this,s=t.PromiseSet.ofHash(i).allDone(),u=t.PromiseSet.ofHash(o).firstDone();return t.PromiseSet.ofPromises(s,u).allDone().then(function(){var r=s.getResult().toHash(),i=u.getResult().value,c=i.context,l=a.declareDisplayHandlers(c),d=n.VisualRealEstate[a.realEstate()],p=a.getLegacySuspension(d),f=a.getParentElement(),g=r.templates,m=e.$(g);t.Common.SafeDocument.append(document.body,m[0],!1);var h=new n.Model.AsyncPanelModel(c,d,p,a.visibleItems());a.model=h,o.CommerceDeals&&o.CommerceDeals.then(function(e){var r=new n.Model.DealsModel(e.context,e.data);h.deals(r),t.Logger.info("Deals loaded")}),o.Coupons&&o.Coupons.then(function(e){var r=new n.Model.CouponsModel(e.context,e.data);h.coupons(r),t.Logger.info("Coupons loaded")}),o.Travels&&o.Travels.then(function(e){var r=new n.Model.TravelsModel(e.context,e.data);h.travels(r),t.Logger.info("Travel loaded")}),o.Campaigns&&o.Campaigns.then(function(e){var r=new n.Model.CampaignsModel(e.context,e.data);h.campaigns(r),t.Logger.info("Campaigns loaded")});var v=e.$("<div data-bind=\"template: '"+a.config().rootTemplate+"'\"></div>"),y=v[0];t.Common.DomProtect.safeAppend(f,y,a.config().appendFirst),a.element=y,h.cssUrl=a.cssUrl(c),h.cssName=a.config().rootCssClass,h.postRenderHandler=function(e,n){t.Col.of(l).each(function(t){return t.afterRender(e,n)})},h.onClose=function(){t.Col.of(l).each(function(e){return e.remove&&e.remove()}),t.Common.DomProtect.safeRemove(y)};try{return e.ko.applyBindings(h,y),t.resolve(n.DisplayState.Shown)}catch(C){throw t.Col.of(l).each(function(e){return e.remove&&e.remove()}),t.Common.DomProtect.safeRemove(y),C}})},r.prototype.isOnCouponsWhitelist=function(e){var t=document.location.host+document.location.pathname;t=t.replace(/www\.|\/$/g,"");var n=e.extras.rootCouponsUrl;return n.indexOf(t)!=-1},r.prototype.remove=function(e){this.model.onClose()},r.prototype.visibleItems=function(){return 9999},r}();r.AsyncGenericPanelVisual=o}(r=n.Visual||(n.Visual={}))}(n=t.Products||(t.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.declareDisplayHandlers=function(t){var r=n.prototype.declareDisplayHandlers.call(this,t),o=new e.DisplayHandlers.ScrollHandler(t);return r.push(o),r},r.prototype.config=function(){var e=!!window.FO_MOREOFFERS;return{realEstate:t.VisualRealEstate.RIGHT_PANEL,flag:"rsy",rootTemplate:"right-slider-template2",rootCssFile:e?"altRightSlider.css":"rightSlider.css",rootCssClass:"fo-right-sliderx",appendFirst:!1,primaryItemCount:4,secondaryItemCount:8}},r.prototype.visibleItems=function(){var e=!!window.FO_MOREOFFERS;return e?5:4},r}(n.AsyncGenericPanelVisual);n.AsyncRightSliderY=r}(n=t.Visual||(t.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.config=function(){return{realEstate:t.VisualRealEstate.TOP_PANEL,flag:"tby",rootTemplate:"generic-horizontal-template-div",rootCssFile:"topBar.css",rootCssClass:"fo-top-barx",appendFirst:!1,primaryItemCount:4,secondaryItemCount:8}},r.prototype.declareDisplayHandlers=function(t){var r=t.paths().innerResourcesRoot()+"/Resources/topBarPushBody.css",o=new e.DisplayHandlers.TransiantCSSHandler(r),i=n.prototype.declareDisplayHandlers.call(this,t);return i.push(o),i},r}(n.AsyncGenericPanelVisual);n.AsyncTopBarY=r}(n=t.Visual||(t.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.config=function(){var t=e.prototype.config.call(this);return t.rootCssFile="yourShoppingLikesRightSlider.css",t},t}(e.ContentVisual);e.ShoppingSiteAdVisual=t}(t=e.Visual||(e.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.declareDisplayHandlers=function(t){var r=n.prototype.declareDisplayHandlers.call(this,t),o=new e.DisplayHandlers.ScrollHandler(t);return r.push(o),r},r.prototype.declareResourcesPromise=function(t){return{templates:e.Common.Res.bring(t.paths().innerResourcesRoot()+"/Resources/pushTemplates.html"),css:e.Common.Res.injectCss2(this.cssUrl(t))}},r.prototype.config=function(){var e="push.css",n="push-notification-template";return{realEstate:t.VisualRealEstate.BOTTOM_PANEL,flag:"pdisplay",rootTemplate:n,rootCssFile:e,rootCssClass:"fo-bottom-push",appendFirst:!1,primaryItemCount:1,secondaryItemCount:0}},r.prototype.visibleItems=function(){return 1},r.prototype.draw=function(t,r,o){var i=this,a=n.prototype.draw.call(this,t,r,o);return setTimeout(function(){i.remove(null)},1e3*e.flag(e.Flags.PushDisplay.MESSAGE_FADE_OUT_TIME)),a},r}(n.GenericPanelVisual);n.PushDisplayVisual=r}(n=t.Visual||(t.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype.declareDisplayHandlers=function(t){var r=n.prototype.declareDisplayHandlers.call(this,t),o=new e.DisplayHandlers.ScrollHandler(t);return r.push(o),r},r.prototype.declareResourcesPromise=function(t){return{templates:e.Common.Res.bring(t.paths().innerResourcesRoot()+"/Resources/pushTemplates.html"),css:e.Common.Res.injectCss2(this.cssUrl(t))}},r.prototype.config=function(){var e="push.css",n="push-proxy-template";return{realEstate:t.VisualRealEstate.TOP_PANEL,flag:"pshm",rootTemplate:n,rootCssFile:e,rootCssClass:"fo-push-bell",appendFirst:!1,primaryItemCount:1,secondaryItemCount:0}},r.prototype.visibleItems=function(){return 1},r.prototype.draw=function(e,t,r){var o=n.prototype.draw.call(this,e,t,r);return o},r}(n.GenericPanelVisual);n.PushMinerVisual=r}(n=t.Visual||(t.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var n=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype.declareDisplayHandlers=function(e){var n=t.prototype.declareDisplayHandlers.call(this,e);return n},n.prototype.config=function(){var t="displayRightSlider.css",n="display-right-slider-div-template";return{realEstate:e.VisualRealEstate.RIGHT_PANEL,flag:"drs",rootTemplate:n,rootCssFile:t,rootCssClass:"fo-right-sliderx",appendFirst:!1,primaryItemCount:1,secondaryItemCount:1}},n.prototype.draw=function(e,n,r){return t.prototype.draw.call(this,e,n,r)},n}(t.GenericPanelVisual);t.DisplayRightSliderVisual=n}(t=e.Visual||(e.Visual={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!0},n.prototype.dataKey=function(){return"Display"},n.prototype.flag=function(){return"display"},n.prototype.classify=function(t){var n=this;return e.namedWaterfall([{name:"bwl",value:function(){return e.Vertical.CommerceHelper.blackWhiteList(t).alwaysThen(function(n,r){return r?(e.Logger.error("Failed during BWL test! "+r.message,t),-1):n>=1?-1:0})}},{name:"gooddict",value:function(){return e.Vertical.CommerceHelper.qualifyingDictionaries(t).then(function(e){return e>=1?-1:0})}},{name:"schemaorg",value:function(){return e.Vertical.CommerceHelper.schemaOrg(t).then(function(e){return e>=1?-1:0})}},{name:"ribbon",value:function(){return e.Vertical.CommerceHelper.productImage(t).then(function(e){return e>=1?-1:0})}},{name:"display",value:function(){return n.alwaysClassification(t)}}],function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.alwaysClassification=function(t){return e.resolve(.5)},n.prototype.classificationType=function(){return t.ClassificationType.NON_COMMERCE},n.prototype.scrapeAndObtainData=function(t,n,r){return e.resolve({source:"adopt",context:t,data:['<script data-cfasync="false" src="//k4n8g7z4.map2.ssl.hwcdn.net/s/63fc160b-bbb9-4bb9-9a6a-18ad5fb066a6.js#amloader&geo='+t.countryCode()+'&inplace&size=160x600"></script>'],hasData:function(){return!0}})},n}();n.DisplayLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n;!function(n){var r=function(){function n(){}return n.prototype.supportsStickyClassification=function(){return!0},n.prototype.dataKey=function(){return"Display"},n.prototype.flag=function(){return"display"},n.prototype.classify=function(t){var n=this;return e.namedWaterfall([{name:"bwl",value:function(){return e.Vertical.CommerceHelper.blackWhiteList(t).alwaysThen(function(n,r){return r?(e.Logger.error("Failed during BWL test! "+r.message,t),-1):n>=1?-1:0})}},{name:"gooddict",value:function(){return e.Vertical.CommerceHelper.qualifyingDictionaries(t).then(function(e){return e>=1?-1:0})}},{name:"schemaorg",value:function(){return e.Vertical.CommerceHelper.schemaOrg(t).then(function(e){return e>=1?-1:0})}},{name:"ribbon",value:function(){return e.Vertical.CommerceHelper.productImage(t).then(function(e){return e>=1?-1:0})}},{name:"display",value:function(){return n.alwaysClassification(t)}}],function(e){return 0!=e}).alwaysThen(function(e,t){return t?{name:t.message,value:0}:e})},n.prototype.alwaysClassification=function(t){return e.resolve(.5)},n.prototype.classificationType=function(){return t.ClassificationType.NON_COMMERCE},n.prototype.scrapeAndObtainData=function(t,n,r){var o=Math.random(),i=t.countryCode().toLowerCase(),a=null;return a=o<e.Flags.flag(e.Flags.DisplayAd.NEPTON_RATIO)&&["ae","at","au","be","ca","ch","cz","de","dk","es","fi","fr","hk","hu","id","ie","in","it","lt","mx","nl","no","nz","pl","pr","se","sg","tr","uk","us","za"].indexOf(i)>-1?{source:"nepton",context:t,data:['<script type="text/javascript" src="//v24s.net/vizm01?pid=1137530&aid=cm&said='+t.params().subId+'&t=DEV87#3"></script>'],hasData:function(){return!0}}:{source:"adopt",context:t,data:['<script data-cfasync="false" src="https://k4n8g7z4.map2.ssl.hwcdn.net/s/284d2e9b-611c-4282-915e-5c391f6b80d4.js#amloader&geo='+i+'&inplace&size=160x600"></script>'],hasData:function(){return!0}},e.resolve(a)},n}();n.DisplayExpandLogic=r}(n=t.Logic||(t.Logic={}))}(t=e.Products||(e.Products={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function e(){}return e}(),r=function(){function t(){}return t.getHookPromises=function(){return window.FO_HOOKS},t.initializePromises=function(){var t=new n;return t.afterLibrariesDeferred=e.defer(),t.afterLibraries=t.afterLibrariesDeferred.promise(),t},t.loadHookTargets=function(){try{if(window[t.HOOKTARGETS_KEY]){var n=window[t.HOOKTARGETS_KEY];t.hookTargets=e.Col.of(n).select(function(t){return e.Common.Res.instantiateFromQualifiedName(t)})}}catch(r){e.Logger.warn(r.message)}},t.perfromWrapped=function(n){try{t.hookTargets.each(n)}catch(r){e.Logger.warn(r.message)}},t.afterLibraries=function(e){t.perfromWrapped(function(n){return n.afterLibraries&&n.afterLibraries(e)&&t.getHookPromises().afterLibrariesDeferred.resolve(!0)})},t.afterContext=function(e){t.perfromWrapped(function(t){return t.afterContext&&t.afterContext(e)})},t.logicCompleted=function(e,n){t.perfromWrapped(function(t){return t.logicCompleted&&t.logicCompleted(e,n)})},t.HOOKTARGETS_KEY="FO_HOOKTARGETS",t.hookTargets=e.Col.empty(),t}();t.ExternalHooks=r,window.FO_HOOKS=r.initializePromises()}(t=e.Hooks||(e.Hooks={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.init=function(){e.devToolsCheckBenchmark()},e.devToolsCheckBenchmark=function(){var t=e.performBenchmark(),n=8,r=[t],o=setInterval(function(){var t=e.performBenchmark();if(4==r.length){var i=e.average(r),a=t/i;(a>2||t>n)&&(clearInterval(o),e.emitEvent(t>n))}r.push(t),r.length>4&&r.shift()},500)},e.average=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t/e.length},e.performBenchmark=function(){for(var e=performance.now(),t=0;t<100;t++)console.log(1),console.clear();return performance.now()-e},e.devToolsCheck=function(){window.Firebug&&window.Firebug.chrome&&window.Firebug.chrome.isInitialized||window.outerWidth-window.innerWidth>e.threshold||window.outerHeight-window.innerHeight>e.threshold?(e.stateOpen||e.emitEvent(!0),e.stateOpen=!0):(e.stateOpen&&e.emitEvent(!1),e.stateOpen=!1)},e.emitEvent=function(e){window.dispatchEvent(new CustomEvent("dtc",{detail:{open:e}})),window.FO_DTO=e},e.stateOpen=!1,e.threshold=160,e}();e.DevToolsHelper=t}(t=e.Common||(e.Common={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));var FO;!function(e){var t;!function(e){var t;!function(t){var n=function(){function t(){this.selectedProducts=[]}return t.prototype.init=function(t,n){var r=this;e.Hooks.ExternalHooks.loadHookTargets(),window.FO_ADJUSTSCALE||(window.FO_ADJUSTSCALE={active:!0,top:0,bottom:0,pos:.3,minScale:.9});var o=new e.Context.Paths(n),i=new e.Context.BootstrapContext(o,t,{});e.Logger.initialize(i),e.Flags.initOverrides(i.overrides());var a=window.FO_ExtraNotificationParams;if(a)for(var s in a)a.hasOwnProperty(s)&&i.pushNotificationParam(s,a[s]);e.Logger.Analytics.notify(i,e.Logger.Analytics.INIT,{},0);var u=e.flag(e.Flags.STANDOWN.SHOULD_STANDOWN);if(u&&(window.name||"").match(/^(a652c|ld893)_/))return e.Logger.log("Standing down our app"),void e.Logger.Analytics.notify(i,e.Logger.Analytics.GENERIC_STANDOWN,{},.1);e.Logger.log("Started app init. Version: 0_0_1214. PartId: "+t.partnerCode+". SubId: "+t.subId+". Domain: "+n),e.Logger.time("FO end to end"),e.Logger.log("Overrides:\n"+i.overrides().describe()),e.Logger.time("FO LoadTime");var c=[];if(t.isStandAlone){e.Common.KoBindings.registerCustomBindings(i);var l=i.overrides().boolValue("koErrorHandle",!1);l&&e.Common.KoBindings.setErrorHandlingBindingProvider(i)}else{var d=i.paths().outerResourcesRoot()+"/",p=e.Common.Res.injectScript(d+"json3_2.js").then(function(){return window.JSON3=JSON3.noConflict()}),f=e.Common.Res.injectScript(d+"NWPLegacy_v3.js"),g=e.Common.Res.injectScript(d+"bloomfilter.js"),m=e.Common.Res.injectScript(d+"nlp_compromise.min.2.js"),h=e.Common.ExternalResources.getKnockout(d).then(function(){e.Common.KoBindings.registerCustomBindings(i);var t=i.overrides().boolValue("koErrorHandle",!1);t&&e.Common.KoBindings.setErrorHandlingBindingProvider(i)}),v=e.Common.ExternalResources.getJQuery(d).then(function(){return e.when(e.Common.Res.injectScript(d+"jquery.xdr.js"),e.Common.Res.injectScript(d+"jquery.dotdotdot.js"))});c.push(p,f,g,m,h,v)}var y=e.waitFor(function(){return document.body},0,100,!0);c.push(y),e.typedWhen(c).done(function(){return r.continueWithLibraries(i)}).fail(function(t){return e.Logger.error("Shared: Library load failed: "+t.message,i)})},t.prototype.continueWithLibraries=function(t){var n=this;e.Logger.log("Libraries loaded. Loading application context"),e.Hooks.ExternalHooks.afterLibraries(t),e.flag(e.Flags.View.PROTECT_DOM)&&e.Common.DomProtect.initialize(!1);var r=e.Common.generateUUID(),o=t.params().isStandAlone?new e.Common.LocalStore:new e.Common.IFrameStore(t.paths(),t.isDebugMode()),i=e.Common.LooseUserSettings.fromAsyncStorePromise(o,r),a=i.then(function(t){return new e.Common.DefaultSuspender(t)}),s=e.Context.ApplicationContext.fromPromise(t,i,a,o,null);s.fail(function(n){return e.Logger.error("Failed initializing app context: "+n.message,t)});var u=e.Map.ofHash(t.params().products).selectValues(function(n){var r=n.value[0],o=e.Common.Res.loadProduct(t,n.key,r.logic,r.visual);return o});e.PromiseSet.ofMap(u).allComplete().then(function(t){0==t.length()?e.Logger.error("Shared: No products loaded successfully"):s.then(function(e){return n.continueWithContextAndProducts(e,t.values().toArray(),r)})})},t.prototype.continueWithContextAndProducts=function(t,n,r){e.Logger.log("Continuing with Context and Products");var o=new Date,i=o.getFullYear()+""+o.getMonth()+o.getDate(),a=t.userSettings().uuid()==r?"generated":"active";e.Logger.Analytics.notify(t,e.Logger.Analytics.USER,{t:i,usertype:a,hid:t.userSettings().uuid(),partid:t.params().partnerCode,subid:t.params().subId},1,!1),this.selectProductsAndAddReloadChecks(t,n)},t.prototype.selectProductsAndAddReloadChecks=function(t,n){var r=this;this.selectProducts(t,n);var o=window.location.href,i=null;window.setInterval(function(){window.location.href!=o&&(o=window.location.href,i&&window.clearTimeout(i),e.Logger.info("Reloading products - URL has changed"),r.removeProducts(t,r.selectedProducts,!0),r.selectedProducts=[],i=window.setTimeout(function(){r.selectProducts(t,n)},1500))},1e3)},t.prototype.selectProducts=function(t,n){var r=this,o=e.StaticCol.select(n,function(e){return e.name}).join(",");e.Logger.log("loaded product code for "+o);for(var i={},a=0;a<n.length;a++){var s=n[a],u=new e.Context.VisualContext(t,s.name,s.visual),c=e.Products.VisualRealEstate[s.visual.realEstate()],l=t.suspender().isSuspended(c);if(l)e.Logger.info("Realestate "+c+" Is suspended. Product "+s.name+" will not be displayed"),e.Logger.Analytics.notify(u,e.Logger.Analytics.NO_SHOW,{reason:"suspended"},0);else for(var d=0;d<s.logics.length;d++){var p=s.logics[d],f=window["FO_CLASSIFY_"+p.flag().toUpperCase()];if(f)e.Logger.log("Using flag classification for "+p.flag()+": "+f),i[p.flag()]=e.resolve({name:"flag",value:f});else{var g=p.supportsStickyClassification()&&e.Common.ElephantClassifier.getHistoricalClassification(p);if(g)e.Logger.log("Approving for historical classification for logic "+p.flag()),i[p.flag()]=e.resolve({name:"historical",value:g});else{var m=new e.Context.LVContext(t,s.name,p,s.visual);i[p.flag()]=p.classify(m).logPassthrough("Logic classification score for "+p.flag())}}}}var h=e.namedWhen2(i).fail(function(t){e.Logger.error("Failed classification: "+t.message)}),v=h.then(function(r){for(var o=[],i={},a=0;a<n.length;a++){var s=n[a],u=new e.Context.VisualContext(t,s.name,s.visual),c=e.Products.VisualRealEstate[s.visual.realEstate()],l=t.suspender().isSuspended(c);if(!l){for(var d=null,p=0,f=null,g=[],m=0;m<s.logics.length;m++){var h=s.logics[m],v=r[h.flag()];if(v){var y=v.value,C=v.name;y>0&&(g.push(h),i[h.flag()]=C,h.supportsStickyClassification()&&e.Common.ElephantClassifier.setHistoricalClassification(h)),(null==f||y>p)&&(p=y,d=h,f=C)}else e.Logger.log("Skipping logic "+h.flag()+". Did not reach classification")}if(p<=0){e.Logger.log("Skipping product "+s.name+". Top logic classification returned "+p+" with reason "+f);var S=0==p?"Classification zero":"Negative classification: "+f;e.Logger.Analytics.notify(u,e.Logger.Analytics.NO_SHOW,{reason:S},0)}else s.logics=g,s.logicClassificationReasons=i,o.push({product:s,score:p})}}return o}),y=v.then(function(n){return e.Common.RealEstateHelper.resolveProductsByRealEstate(t,n)}).fail(function(t){e.Logger.error("Failed realestate resolution: "+t.message)});y.then(function(n){if(r.selectedProducts=n,0==n.length){e.Logger.info("FO complete: no products selected.");try{window.FO_SHOW_CALLBACK&&window.FO_SHOW_CALLBACK(!1)}catch(o){e.Logger.error("Error in callback function: "+o.message)}}else{try{window.FO_SHOW_CALLBACK&&window.FO_SHOW_CALLBACK(!0)}catch(o){e.Logger.error("Error in callback function: "+o.message)}r.loadProducts(t,n)}}).fail(function(t){e.Logger.error("Failed selected product initialization: "+t.message)})},t.prototype.loadProducts=function(t,n){var r=this,o=e.StaticCol.select(n,function(e){return e.name}).join();e.Logger.info("initializing products "+o);var i=new e.Common.DataSynchronizer,a=e.Col.of(n).toMap(function(e){return e.name},function(n){var o=new e.Context.VisualContext(t,n.name,n.visual),a=r.obtainProductData(t,n,i),s=n.visual.declareResourcesPromise(o),u=r.displayProduct(o,n,a,s);return u});e.PromiseSet.ofMap(a).allComplete().then(function(t){var n=t.select(function(t){return t.key+": \t"+e.Products.DisplayState[t.value]}).stringJoin("\n");e.Logger.info("FO complete\n"+n),e.Logger.timeEnd("FO end to end")})},t.prototype.obtainProductData=function(t,n,r){for(var o={},i=0;i<n.logics.length;i++){var a=n.logics[i],s=new e.Context.LVContext(t,n.name,a,n.visual),u=n.logicClassificationReasons[a.flag()];s.pushNotificationParam("clsreason",u);var c=n.visual.determineNeededItemCount(s),l=a.scrapeAndObtainData(s,c,r).then(function(t){return e.Hooks.ExternalHooks.logicCompleted(a,t),t.context.pushNotificationParam("datasrc",t.source),t});o[a.dataKey()]=l}return o},t.prototype.displayProduct=function(t,n,r,o){var i=this.drawProduct(t,n,r,o);return i.alwaysThen(function(r,o){if(o&&e.Logger.error("Failed drawing "+n.name+": "+o.message,t),o||r!=e.Products.DisplayState.Shown){var i=o?{reason:e.Products.DisplayState[e.Products.DisplayState.NoShow_DrawFailure],ex:o.message}:{reason:e.Products.DisplayState[r]};e.Logger.Analytics.notify(t,e.Logger.Analytics.NO_SHOW,i,0);var a=e.Products.VisualRealEstate[n.visual.realEstate()];e.Common.RealEstateHelper.releaseRealestate(a)}else e.flag(e.Flags.View.PROTECT_DOM)&&(e.Logger.log("At least one product shown - starting DomProtect execute"),e.Common.DomProtect.startExecuteOnce())}),i},t.prototype.drawProduct=function(t,n,r,o){if(n.visual.isLazy){var i=n.visual;return e.Logger.log("Drawing async visual for product "+n.name),i.draw(n,r,o)}var a=n.visual,s=e.PromiseSet.ofHash(r).allDone(2e4,"Sync data"),u=e.PromiseSet.ofHash(o).allDone(1e4,"Sync resources");return e.PromiseSet.ofPromises(s,u).allDone(0,"Sync data and resources").then(function(){var t=s.getResult().toHash(),r=u.getResult().toHash();return e.Logger.log("Drawing sync visual for product "+n.name),a.draw(n,t,r)})},t.prototype.removeProducts=function(t,n,r){var o=e.StaticCol.select(n,function(e){return e.name}).join(",");e.Logger.info("Removing products "+o);for(var i=0;i<n.length;i++)this.removeProduct(t,n[i],r)},t.prototype.removeProduct=function(t,n,r){try{if(n.visual.remove(t),r){var o=e.Products.VisualRealEstate[n.visual.realEstate()];e.Common.RealEstateHelper.releaseRealestate(o)}}catch(i){e.Logger.warn("Error while removing product "+n.name+": "+i)}},t}();t.SharedApp=n}(t=e.App||(e.App={}))}(t=e.Shared_0_0_1214||(e.Shared_0_0_1214={}))}(FO||(FO={}));
